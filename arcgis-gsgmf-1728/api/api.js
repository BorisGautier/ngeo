var demo=function(t){var e={};function r(n){if(e[n]){return e[n].exports}var i=e[n]={i:n,l:false,exports:{}};t[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=t;r.c=e;r.d=function(t,e,n){if(!r.o(t,e)){Object.defineProperty(t,e,{enumerable:true,get:n})}};r.r=function(t){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})};r.t=function(t,e){if(e&1)t=r(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var n=Object.create(null);r.r(n);Object.defineProperty(n,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n};r.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};r.d(e,"a",e);return e};r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};r.p="";return r(r.s=40)}([function(t,e,r){"use strict";r.d(e,"b",(function(){return a}));r.d(e,"c",(function(){return u}));r.d(e,"d",(function(){return l}));r.d(e,"e",(function(){return h}));r.d(e,"f",(function(){return c}));r.d(e,"g",(function(){return f}));r.d(e,"h",(function(){return p}));r.d(e,"i",(function(){return d}));r.d(e,"j",(function(){return v}));r.d(e,"k",(function(){return _}));r.d(e,"l",(function(){return g}));r.d(e,"m",(function(){return y}));r.d(e,"n",(function(){return E}));r.d(e,"o",(function(){return b}));r.d(e,"p",(function(){return w}));r.d(e,"q",(function(){return M}));r.d(e,"r",(function(){return C}));r.d(e,"s",(function(){return I}));r.d(e,"t",(function(){return P}));r.d(e,"u",(function(){return L}));r.d(e,"v",(function(){return A}));r.d(e,"w",(function(){return j}));r.d(e,"x",(function(){return N}));r.d(e,"y",(function(){return D}));r.d(e,"z",(function(){return G}));r.d(e,"A",(function(){return U}));r.d(e,"B",(function(){return Y}));r.d(e,"C",(function(){return W}));r.d(e,"D",(function(){return V}));r.d(e,"E",(function(){return X}));r.d(e,"G",(function(){return q}));r.d(e,"H",(function(){return Z}));r.d(e,"I",(function(){return K}));r.d(e,"F",(function(){return H}));r.d(e,"a",(function(){return J}));r.d(e,"J",(function(){return Q}));var n=r(23);var i=r(15);var o=r(7);function a(t){var e=v();for(var r=0,n=t.length;r<n;++r){M(e,t[r])}return e}function s(t,e,r){var n=Math.min.apply(null,t);var i=Math.min.apply(null,e);var o=Math.max.apply(null,t);var a=Math.max.apply(null,e);return _(n,i,o,a,r)}function u(t,e,r){if(r){r[0]=t[0]-e;r[1]=t[1]-e;r[2]=t[2]+e;r[3]=t[3]+e;return r}else{return[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}}function l(t,e){if(e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}else{return t.slice()}}function h(t,e,r){var n,i;if(e<t[0]){n=t[0]-e}else if(t[2]<e){n=e-t[2]}else{n=0}if(r<t[1]){i=t[1]-r}else if(t[3]<r){i=r-t[3]}else{i=0}return n*n+i*i}function c(t,e){return p(t,e[0],e[1])}function f(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function p(t,e,r){return t[0]<=e&&e<=t[2]&&t[1]<=r&&r<=t[3]}function d(t,e){var r=t[0];var n=t[1];var o=t[2];var a=t[3];var s=e[0];var u=e[1];var l=i["a"].UNKNOWN;if(s<r){l=l|i["a"].LEFT}else if(s>o){l=l|i["a"].RIGHT}if(u<n){l=l|i["a"].BELOW}else if(u>a){l=l|i["a"].ABOVE}if(l===i["a"].UNKNOWN){l=i["a"].INTERSECTING}return l}function v(){return[Infinity,Infinity,-Infinity,-Infinity]}function _(t,e,r,n,i){if(i){i[0]=t;i[1]=e;i[2]=r;i[3]=n;return i}else{return[t,e,r,n]}}function g(t){return _(Infinity,Infinity,-Infinity,-Infinity,t)}function y(t,e){var r=t[0];var n=t[1];return _(r,n,r,n,e)}function m(t,e){var r=g(e);return S(r,t)}function E(t,e,r,n,i){var o=g(i);return C(o,t,e,r,n)}function O(t,e){var r=g(e);return R(r,t)}function b(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function x(t,e,r){return Math.abs(t[0]-e[0])<r&&Math.abs(t[2]-e[2])<r&&Math.abs(t[1]-e[1])<r&&Math.abs(t[3]-e[3])<r}function w(t,e){if(e[0]<t[0]){t[0]=e[0]}if(e[2]>t[2]){t[2]=e[2]}if(e[1]<t[1]){t[1]=e[1]}if(e[3]>t[3]){t[3]=e[3]}return t}function M(t,e){if(e[0]<t[0]){t[0]=e[0]}if(e[0]>t[2]){t[2]=e[0]}if(e[1]<t[1]){t[1]=e[1]}if(e[1]>t[3]){t[3]=e[1]}}function S(t,e){for(var r=0,n=e.length;r<n;++r){M(t,e[r])}return t}function C(t,e,r,n,i){for(;r<n;r+=i){T(t,e[r],e[r+1])}return t}function R(t,e){for(var r=0,n=e.length;r<n;++r){S(t,e[r])}return t}function T(t,e,r){t[0]=Math.min(t[0],e);t[1]=Math.min(t[1],r);t[2]=Math.max(t[2],e);t[3]=Math.max(t[3],r)}function I(t,e){var r;r=e(L(t));if(r){return r}r=e(A(t));if(r){return r}r=e(W(t));if(r){return r}r=e(Y(t));if(r){return r}return false}function P(t){var e=0;if(!q(t)){e=V(t)*G(t)}return e}function L(t){return[t[0],t[1]]}function A(t){return[t[2],t[1]]}function j(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function N(t,e){var r;if(e===n["a"].BOTTOM_LEFT){r=L(t)}else if(e===n["a"].BOTTOM_RIGHT){r=A(t)}else if(e===n["a"].TOP_LEFT){r=Y(t)}else if(e===n["a"].TOP_RIGHT){r=W(t)}else{Object(o["a"])(false,13)}return r}function F(t,e){var r=Math.min(t[0],e[0]);var n=Math.min(t[1],e[1]);var i=Math.max(t[2],e[2]);var o=Math.max(t[3],e[3]);return(i-r)*(o-n)}function D(t,e,r,n,i){var o=e*n[0]/2;var a=e*n[1]/2;var s=Math.cos(r);var u=Math.sin(r);var l=o*s;var h=o*u;var c=a*s;var f=a*u;var p=t[0];var d=t[1];var v=p-l+f;var g=p-l-f;var y=p+l-f;var m=p+l+f;var E=d-h-c;var O=d-h+c;var b=d+h+c;var x=d+h-c;return _(Math.min(v,g,y,m),Math.min(E,O,b,x),Math.max(v,g,y,m),Math.max(E,O,b,x),i)}function G(t){return t[3]-t[1]}function k(t,e){var r=U(t,e);return P(r)}function U(t,e,r){var n=r?r:v();if(X(t,e)){if(t[0]>e[0]){n[0]=t[0]}else{n[0]=e[0]}if(t[1]>e[1]){n[1]=t[1]}else{n[1]=e[1]}if(t[2]<e[2]){n[2]=t[2]}else{n[2]=e[2]}if(t[3]<e[3]){n[3]=t[3]}else{n[3]=e[3]}}else{g(n)}return n}function B(t){return V(t)+G(t)}function z(t){return[t[2]-t[0],t[3]-t[1]]}function Y(t){return[t[0],t[3]]}function W(t){return[t[2],t[3]]}function V(t){return t[2]-t[0]}function X(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function q(t){return t[2]<t[0]||t[3]<t[1]}function Z(t,e){if(e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}else{return t}}function K(t,e){var r=(t[2]-t[0])/2*(e-1);var n=(t[3]-t[1])/2*(e-1);t[0]-=r;t[2]+=r;t[1]-=n;t[3]+=n}function H(t,e,r){var n=false;var o=d(t,e);var a=d(t,r);if(o===i["a"].INTERSECTING||a===i["a"].INTERSECTING){n=true}else{var s=t[0];var u=t[1];var l=t[2];var h=t[3];var c=e[0];var f=e[1];var p=r[0];var v=r[1];var _=(v-f)/(p-c);var g=void 0,y=void 0;if(!!(a&i["a"].ABOVE)&&!(o&i["a"].ABOVE)){g=p-(v-h)/_;n=g>=s&&g<=l}if(!n&&!!(a&i["a"].RIGHT)&&!(o&i["a"].RIGHT)){y=v-(p-l)*_;n=y>=u&&y<=h}if(!n&&!!(a&i["a"].BELOW)&&!(o&i["a"].BELOW)){g=p-(v-u)/_;n=g>=s&&g<=l}if(!n&&!!(a&i["a"].LEFT)&&!(o&i["a"].LEFT)){y=v-(p-s)*_;n=y>=u&&y<=h}}return n}function J(t,e,r,n){var i=[];if(n>1){var o=t[2]-t[0];var a=t[3]-t[1];for(var u=0;u<n;++u){i.push(t[0]+o*u/n,t[1],t[2],t[1]+a*u/n,t[2]-o*u/n,t[3],t[0],t[3]-a*u/n)}}else{i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]]}e(i,i,2);var l=[];var h=[];for(var u=0,c=i.length;u<c;u+=2){l.push(i[u]);h.push(i[u+1])}return s(l,h,r)}function Q(t,e){var r=e.getExtent();var n=j(t);if(e.canWrapX()&&(n[0]<r[0]||n[0]>=r[2])){var i=V(r);var o=Math.floor((n[0]-r[0])/i);var a=o*i;t[0]-=a;t[2]-=a}return t}},function(t,e,r){"use strict";r.d(e,"b",(function(){return n}));r.d(e,"c",(function(){return o}));r.d(e,"a",(function(){return a}));function n(){return function(){throw new Error("Unimplemented abstract method.")}()}var i=0;function o(t){return t.ol_uid||(t.ol_uid=String(++i))}var a="6.12.0"},function(t,e,r){"use strict";r.d(e,"b",(function(){return n}));r.d(e,"c",(function(){return i}));r.d(e,"f",(function(){return o}));r.d(e,"k",(function(){return a}));r.d(e,"j",(function(){return s}));r.d(e,"i",(function(){return u}));r.d(e,"l",(function(){return l}));r.d(e,"m",(function(){return h}));r.d(e,"g",(function(){return c}));r.d(e,"e",(function(){return f}));r.d(e,"h",(function(){return d}));r.d(e,"d",(function(){return v}));r.d(e,"a",(function(){return _}));function n(t,e,r){return Math.min(Math.max(t,e),r)}var i=function(){var t;if("cosh"in Math){t=Math.cosh}else{t=function(t){var e=Math.exp(t);return(e+1/e)/2}}return t}();var o=function(){var t;if("log2"in Math){t=Math.log2}else{t=function(t){return Math.log(t)*Math.LOG2E}}return t}();function a(t,e,r,n,i,o){var a=i-r;var u=o-n;if(a!==0||u!==0){var l=((t-r)*a+(e-n)*u)/(a*a+u*u);if(l>1){r=i;n=o}else if(l>0){r+=a*l;n+=u*l}}return s(t,e,r,n)}function s(t,e,r,n){var i=r-t;var o=n-e;return i*i+o*o}function u(t){var e=t.length;for(var r=0;r<e;r++){var n=r;var i=Math.abs(t[r][r]);for(var o=r+1;o<e;o++){var a=Math.abs(t[o][r]);if(a>i){i=a;n=o}}if(i===0){return null}var s=t[n];t[n]=t[r];t[r]=s;for(var u=r+1;u<e;u++){var l=-t[u][r]/t[r][r];for(var h=r;h<e+1;h++){if(r==h){t[u][h]=0}else{t[u][h]+=l*t[r][h]}}}}var c=new Array(e);for(var f=e-1;f>=0;f--){c[f]=t[f][e]/t[f][f];for(var p=f-1;p>=0;p--){t[p][e]-=t[p][f]*c[f]}}return c}function l(t){return t*180/Math.PI}function h(t){return t*Math.PI/180}function c(t,e){var r=t%e;return r*e<0?r+e:r}function f(t,e,r){return t+r*(e-t)}function p(t,e){var r=Math.pow(10,e);return Math.round(t*r)/r}function d(t,e){return Math.round(p(t,e))}function v(t,e){return Math.floor(p(t,e))}function _(t,e){return Math.ceil(p(t,e))}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r.d(e,"b",(function(){return i}));r.d(e,"c",(function(){return o}));r.d(e,"d",(function(){return a}));var n=typeof Object.assign==="function"?Object.assign:function(t,e){if(t===undefined||t===null){throw new TypeError("Cannot convert undefined or null to object")}var r=Object(t);for(var n=1,i=arguments.length;n<i;++n){var o=arguments[n];if(o!==undefined&&o!==null){for(var a in o){if(o.hasOwnProperty(a)){r[a]=o[a]}}}}return r};function i(t){for(var e in t){delete t[e]}}var o=typeof Object.values==="function"?Object.values:function(t){var e=[];for(var r in t){e.push(t[r])}return e};function a(t){var e;for(e in t){return false}return!e}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));r.d(e,"b",(function(){return o}));r.d(e,"c",(function(){return a}));var n=r(3);function i(t,e,r,n,i){if(n&&n!==t){r=r.bind(n)}if(i){var o=r;r=function(){t.removeEventListener(e,r);o.apply(this,arguments)}}var a={target:t,type:e,listener:r};t.addEventListener(e,r);return a}function o(t,e,r,n){return i(t,e,r,n,true)}function a(t){if(t&&t.target){t.target.removeEventListener(t.type,t.listener);Object(n["b"])(t)}}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r.d(e,"i",(function(){return i}));r.d(e,"f",(function(){return o}));r.d(e,"h",(function(){return a}));r.d(e,"j",(function(){return s}));r.d(e,"c",(function(){return u}));r.d(e,"d",(function(){return h}));r.d(e,"b",(function(){return c}));r.d(e,"e",(function(){return p}));r.d(e,"g",(function(){return d}));function n(t,e,r){var n,o;var a=r||i;var s=0;var u=t.length;var l=false;while(s<u){n=s+(u-s>>1);o=+a(t[n],e);if(o<0){s=n+1}else{u=n;l=!o}}return l?s:~s}function i(t,e){return t>e?1:t<e?-1:0}function o(t,e){return t.indexOf(e)>=0}function a(t,e,r){var n=t.length;if(t[0]<=e){return 0}else if(e<=t[n-1]){return n-1}else{var i=void 0;if(r>0){for(i=1;i<n;++i){if(t[i]<e){return i-1}}}else if(r<0){for(i=1;i<n;++i){if(t[i]<=e){return i}}}else{for(i=1;i<n;++i){if(t[i]==e){return i}else if(t[i]<e){if(typeof r==="function"){if(r(e,t[i-1],t[i])>0){return i-1}else{return i}}else if(t[i-1]-e<e-t[i]){return i-1}else{return i}}}}return n-1}}function s(t,e,r){while(e<r){var n=t[e];t[e]=t[r];t[r]=n;++e;--r}}function u(t,e){var r=Array.isArray(e)?e:[e];var n=r.length;for(var i=0;i<n;i++){t[t.length]=r[i]}}function l(t,e){var r=t.indexOf(e);var n=r>-1;if(n){t.splice(r,1)}return n}function h(t,e){var r=t.length>>>0;var n;for(var i=0;i<r;i++){n=t[i];if(e(n,i,t)){return n}}return null}function c(t,e){var r=t.length;if(r!==e.length){return false}for(var n=0;n<r;n++){if(t[n]!==e[n]){return false}}return true}function f(t,e){var r=t.length;var n=Array(t.length);var i;for(i=0;i<r;i++){n[i]={index:i,value:t[i]}}n.sort((function(t,r){return e(t.value,r.value)||t.index-r.index}));for(i=0;i<t.length;i++){t[i]=n[i].value}}function p(t,e){var r;var n=!t.every((function(n,i){r=i;return!e(n,i,t)}));return n?r:-1}function d(t,e,r){var n=e||i;return t.every((function(e,i){if(i===0){return true}var o=n(t[i-1],e);return!(o>0||r&&o===0)}))}},function(t,e,r){"use strict";e["a"]={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(26);function i(t,e){if(!t){throw new n["a"](e)}}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));r.d(e,"c",(function(){return o}));r.d(e,"b",(function(){return a}));r.d(e,"g",(function(){return s}));r.d(e,"e",(function(){return u}));r.d(e,"d",(function(){return l}));r.d(e,"f",(function(){return h}));var n=r(14);function i(t,e,r,i){var o;if(r&&r.length){o=r.shift()}else if(n["g"]){o=new OffscreenCanvas(t||300,e||300)}else{o=document.createElement("canvas")}if(t){o.width=t}if(e){o.height=e}return o.getContext("2d",i)}function o(t){var e=t.offsetWidth;var r=getComputedStyle(t);e+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10);return e}function a(t){var e=t.offsetHeight;var r=getComputedStyle(t);e+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10);return e}function s(t,e){var r=e.parentNode;if(r){r.replaceChild(t,e)}}function u(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function l(t){while(t.lastChild){t.removeChild(t.lastChild)}}function h(t,e){var r=t.childNodes;for(var n=0;true;++n){var i=r[n];var o=e[n];if(!i&&!o){break}if(i===o){continue}if(!i){t.appendChild(o);continue}if(!o){t.removeChild(i);--n;continue}t.insertBefore(o,i)}}},function(t,e,r){"use strict";r.d(e,"b",(function(){return i}));r.d(e,"a",(function(){return o}));r.d(e,"c",(function(){return a}));r.d(e,"d",(function(){return s}));var n=r(5);function i(){return true}function o(){return false}function a(){}function s(t){var e=false;var r;var i;var o;return function(){var a=Array.prototype.slice.call(arguments);if(!e||this!==o||!Object(n["b"])(a,i)){e=true;o=this;i=a;r=t.apply(this,arguments)}return r}}function u(t){function e(){var e;try{e=t()}catch(t){return Promise.reject(t)}if(e instanceof Promise){return e}return Promise.resolve(e)}return e()}},function(t,e,r){"use strict";e["a"]={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"}},function(t,e,r){"use strict";e["a"]={ADD:"add",REMOVE:"remove"}},function(t,e,r){"use strict";var n=r(13);var i=r(18);var o=r(25);var a=r(3);var s=r(1);var u=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var l=function(t){u(e,t);function e(e,r,n){var i=t.call(this,e)||this;i.key=r;i.oldValue=n;return i}return e}(n["a"]);var h=function(t){u(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;Object(s["c"])(r);r.values_=null;if(e!==undefined){r.setProperties(e)}return r}e.prototype.get=function(t){var e;if(this.values_&&this.values_.hasOwnProperty(t)){e=this.values_[t]}return e};e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]};e.prototype.getProperties=function(){return this.values_&&Object(a["a"])({},this.values_)||{}};e.prototype.hasProperties=function(){return!!this.values_};e.prototype.notify=function(t,e){var r;r="change:"+t;this.dispatchEvent(new l(r,t,e));r=i["a"].PROPERTYCHANGE;this.dispatchEvent(new l(r,t,e))};e.prototype.addChangeListener=function(t,e){this.addEventListener("change:"+t,e)};e.prototype.removeChangeListener=function(t,e){this.removeEventListener("change:"+t,e)};e.prototype.set=function(t,e,r){var n=this.values_||(this.values_={});if(r){n[t]=e}else{var i=n[t];n[t]=e;if(i!==e){this.notify(t,i)}}};e.prototype.setProperties=function(t,e){for(var r in t){this.set(r,t[r],e)}};e.prototype.applyProperties=function(t){if(!t.values_){return}Object(a["a"])(this.values_||(this.values_={}),t.values_)};e.prototype.unset=function(t,e){if(this.values_&&t in this.values_){var r=this.values_[t];delete this.values_[t];if(Object(a["d"])(this.values_)){this.values_=null}if(!e){this.notify(t,r)}}};return e}(o["default"]);e["a"]=h},function(t,e,r){"use strict";var n=function(){function t(t){this.propagationStopped;this.defaultPrevented;this.type=t;this.target=null}t.prototype.preventDefault=function(){this.defaultPrevented=true};t.prototype.stopPropagation=function(){this.propagationStopped=true};return t}();function i(t){t.stopPropagation()}function o(t){t.preventDefault()}e["a"]=n},function(t,e,r){"use strict";r.d(e,"b",(function(){return i}));r.d(e,"f",(function(){return a}));r.d(e,"d",(function(){return s}));r.d(e,"a",(function(){return u}));r.d(e,"g",(function(){return l}));r.d(e,"c",(function(){return h}));r.d(e,"e",(function(){return c}));var n=typeof navigator!=="undefined"&&typeof navigator.userAgent!=="undefined"?navigator.userAgent.toLowerCase():"";var i=n.indexOf("firefox")!==-1;var o=n.indexOf("safari")!==-1&&n.indexOf("chrom")==-1;var a=n.indexOf("webkit")!==-1&&n.indexOf("edge")==-1;var s=n.indexOf("macintosh")!==-1;var u=typeof devicePixelRatio!=="undefined"?devicePixelRatio:1;var l=typeof WorkerGlobalScope!=="undefined"&&typeof OffscreenCanvas!=="undefined"&&self instanceof WorkerGlobalScope;var h=typeof Image!=="undefined"&&Image.prototype.decode;var c=function(){var t=false;try{var e=Object.defineProperty({},"passive",{get:function(){t=true}});window.addEventListener("_",null,e);window.removeEventListener("_",null,e)}catch(t){}return t}()},function(t,e,r){"use strict";e["a"]={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},function(t,e,r){"use strict";var n=r(26);var i=r(12);var o=r(11);var a=r(13);var s=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var u={LENGTH:"length"};var l=function(t){s(e,t);function e(e,r,n){var i=t.call(this,e)||this;i.element=r;i.index=n;return i}return e}(a["a"]);var h=function(t){s(e,t);function e(e,r){var n=t.call(this)||this;n.on;n.once;n.un;var i=r||{};n.unique_=!!i.unique;n.array_=e?e:[];if(n.unique_){for(var o=0,a=n.array_.length;o<a;++o){n.assertUnique_(n.array_[o],o)}}n.updateLength_();return n}e.prototype.clear=function(){while(this.getLength()>0){this.pop()}};e.prototype.extend=function(t){for(var e=0,r=t.length;e<r;++e){this.push(t[e])}return this};e.prototype.forEach=function(t){var e=this.array_;for(var r=0,n=e.length;r<n;++r){t(e[r],r,e)}};e.prototype.getArray=function(){return this.array_};e.prototype.item=function(t){return this.array_[t]};e.prototype.getLength=function(){return this.get(u.LENGTH)};e.prototype.insertAt=function(t,e){if(this.unique_){this.assertUnique_(e)}this.array_.splice(t,0,e);this.updateLength_();this.dispatchEvent(new l(o["a"].ADD,e,t))};e.prototype.pop=function(){return this.removeAt(this.getLength()-1)};e.prototype.push=function(t){if(this.unique_){this.assertUnique_(t)}var e=this.getLength();this.insertAt(e,t);return this.getLength()};e.prototype.remove=function(t){var e=this.array_;for(var r=0,n=e.length;r<n;++r){if(e[r]===t){return this.removeAt(r)}}return undefined};e.prototype.removeAt=function(t){var e=this.array_[t];this.array_.splice(t,1);this.updateLength_();this.dispatchEvent(new l(o["a"].REMOVE,e,t));return e};e.prototype.setAt=function(t,e){var r=this.getLength();if(t<r){if(this.unique_){this.assertUnique_(e,t)}var n=this.array_[t];this.array_[t]=e;this.dispatchEvent(new l(o["a"].REMOVE,n,t));this.dispatchEvent(new l(o["a"].ADD,e,t))}else{for(var i=r;i<t;++i){this.insertAt(i,undefined)}this.insertAt(t,e)}};e.prototype.updateLength_=function(){this.set(u.LENGTH,this.array_.length)};e.prototype.assertUnique_=function(t,e){for(var r=0,i=this.array_.length;r<i;++r){if(this.array_[r]===t&&r!==e){throw new n["a"](58)}}};return e}(i["a"]);e["a"]=h},function(t,e,r){"use strict";r.r(e);var n=r(12);var i=r(21);var o=r(9);var a=r(4);var s=r(8);var u=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var l=function(t){u(e,t);function e(e){var r=t.call(this)||this;var n=e.element;if(n&&!e.target&&!n.style.pointerEvents){n.style.pointerEvents="auto"}r.element=n?n:null;r.target_=null;r.map_=null;r.listenerKeys=[];if(e.render){r.render=e.render}if(e.target){r.setTarget(e.target)}return r}e.prototype.disposeInternal=function(){Object(s["e"])(this.element);t.prototype.disposeInternal.call(this)};e.prototype.getMap=function(){return this.map_};e.prototype.setMap=function(t){if(this.map_){Object(s["e"])(this.element)}for(var e=0,r=this.listenerKeys.length;e<r;++e){Object(a["c"])(this.listenerKeys[e])}this.listenerKeys.length=0;this.map_=t;if(this.map_){var n=this.target_?this.target_:t.getOverlayContainerStopEvent();n.appendChild(this.element);if(this.render!==o["c"]){this.listenerKeys.push(Object(a["a"])(t,i["a"].POSTRENDER,this.render,this))}t.render()}};e.prototype.render=function(t){};e.prototype.setTarget=function(t){this.target_=typeof t==="string"?document.getElementById(t):t};return e}(n["a"]);e["default"]=l},function(t,e,r){"use strict";e["a"]={PROPERTYCHANGE:"propertychange"}},function(t,e,r){"use strict";e["a"]={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"}},function(t,e,r){"use strict";var n=r(24);var i=r(13);var o=r(9);var a=r(3);var s=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var u=function(t){s(e,t);function e(e){var r=t.call(this)||this;r.eventTarget_=e;r.pendingRemovals_=null;r.dispatching_=null;r.listeners_=null;return r}e.prototype.addEventListener=function(t,e){if(!t||!e){return}var r=this.listeners_||(this.listeners_={});var n=r[t]||(r[t]=[]);if(n.indexOf(e)===-1){n.push(e)}};e.prototype.dispatchEvent=function(t){var e=typeof t==="string"?new i["a"](t):t;var r=e.type;if(!e.target){e.target=this.eventTarget_||this}var n=this.listeners_&&this.listeners_[r];var a;if(n){var s=this.dispatching_||(this.dispatching_={});var u=this.pendingRemovals_||(this.pendingRemovals_={});if(!(r in s)){s[r]=0;u[r]=0}++s[r];for(var l=0,h=n.length;l<h;++l){if("handleEvent"in n[l]){a=n[l].handleEvent(e)}else{a=n[l].call(this,e)}if(a===false||e.propagationStopped){a=false;break}}--s[r];if(s[r]===0){var c=u[r];delete u[r];while(c--){this.removeEventListener(r,o["c"])}delete s[r]}return a}};e.prototype.disposeInternal=function(){this.listeners_&&Object(a["b"])(this.listeners_)};e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||undefined};e.prototype.hasListener=function(t){if(!this.listeners_){return false}return t?t in this.listeners_:Object.keys(this.listeners_).length>0};e.prototype.removeEventListener=function(t,e){var r=this.listeners_&&this.listeners_[t];if(r){var n=r.indexOf(e);if(n!==-1){if(this.pendingRemovals_&&t in this.pendingRemovals_){r[n]=o["c"];++this.pendingRemovals_[t]}else{r.splice(n,1);if(r.length===0){delete this.listeners_[t]}}}}};return e}(n["a"]);e["a"]=u},function(t,e,r){"use strict";e["a"]={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"}},function(t,e,r){"use strict";r.r(e);r.d(e,"GroupEvent",(function(){return _}));var n=r(27);var i=r(16);var o=r(11);var a=r(13);var s=r(6);var u=r(18);var l=r(19);var h=r(7);var c=r(3);var f=r(0);var p=r(1);var d=r(4);var v=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var _=function(t){v(e,t);function e(e,r){var n=t.call(this,e)||this;n.layer=r;return n}return e}(a["a"]);var g={LAYERS:"layers"};var y=function(t){v(e,t);function e(e){var r=this;var n=e||{};var o=Object(c["a"])({},n);delete o.layers;var a=n.layers;r=t.call(this,o)||this;r.on;r.once;r.un;r.layersListenerKeys_=[];r.listenerKeys_={};r.addChangeListener(g.LAYERS,r.handleLayersChanged_);if(a){if(Array.isArray(a)){a=new i["a"](a.slice(),{unique:true})}else{Object(h["a"])(typeof a.getArray==="function",43)}}else{a=new i["a"](undefined,{unique:true})}r.setLayers(a);return r}e.prototype.handleLayerChange_=function(){this.changed()};e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(d["c"]);this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Object(d["a"])(t,o["a"].ADD,this.handleLayersAdd_,this),Object(d["a"])(t,o["a"].REMOVE,this.handleLayersRemove_,this));for(var e in this.listenerKeys_){this.listenerKeys_[e].forEach(d["c"])}Object(c["b"])(this.listenerKeys_);var r=t.getArray();for(var n=0,i=r.length;n<i;n++){var a=r[n];this.registerLayerListeners_(a);this.dispatchEvent(new _("addlayer",a))}this.changed()};e.prototype.registerLayerListeners_=function(t){var r=[Object(d["a"])(t,u["a"].PROPERTYCHANGE,this.handleLayerChange_,this),Object(d["a"])(t,s["a"].CHANGE,this.handleLayerChange_,this)];if(t instanceof e){r.push(Object(d["a"])(t,"addlayer",this.handleLayerGroupAdd_,this),Object(d["a"])(t,"removelayer",this.handleLayerGroupRemove_,this))}this.listenerKeys_[Object(p["c"])(t)]=r};e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new _("addlayer",t.layer))};e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new _("removelayer",t.layer))};e.prototype.handleLayersAdd_=function(t){var e=t.element;this.registerLayerListeners_(e);this.dispatchEvent(new _("addlayer",e));this.changed()};e.prototype.handleLayersRemove_=function(t){var e=t.element;var r=Object(p["c"])(e);this.listenerKeys_[r].forEach(d["c"]);delete this.listenerKeys_[r];this.dispatchEvent(new _("removelayer",e));this.changed()};e.prototype.getLayers=function(){return this.get(g.LAYERS)};e.prototype.setLayers=function(t){var e=this.getLayers();if(e){var r=e.getArray();for(var n=0,i=r.length;n<i;++n){this.dispatchEvent(new _("removelayer",r[n]))}}this.set(g.LAYERS,t)};e.prototype.getLayersArray=function(t){var e=t!==undefined?t:[];this.getLayers().forEach((function(t){t.getLayersArray(e)}));return e};e.prototype.getLayerStatesArray=function(t){var e=t!==undefined?t:[];var r=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var n=this.getLayerState();var i=n.zIndex;if(!t&&n.zIndex===undefined){i=0}for(var o=r,a=e.length;o<a;o++){var s=e[o];s.opacity*=n.opacity;s.visible=s.visible&&n.visible;s.maxResolution=Math.min(s.maxResolution,n.maxResolution);s.minResolution=Math.max(s.minResolution,n.minResolution);s.minZoom=Math.max(s.minZoom,n.minZoom);s.maxZoom=Math.min(s.maxZoom,n.maxZoom);if(n.extent!==undefined){if(s.extent!==undefined){s.extent=Object(f["A"])(s.extent,n.extent)}else{s.extent=n.extent}}if(s.zIndex===undefined){s.zIndex=i}}return e};e.prototype.getSourceState=function(){return l["a"].READY};return e}(n["a"]);e["default"]=y},function(t,e,r){"use strict";e["a"]={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},function(t,e,r){"use strict";var n=function(){function t(){this.disposed=false}t.prototype.dispose=function(){if(!this.disposed){this.disposed=true;this.disposeInternal()}};t.prototype.disposeInternal=function(){};return t}();e["a"]=n},function(t,e,r){"use strict";r.r(e);r.d(e,"unByKey",(function(){return u}));var n=r(20);var i=r(6);var o=r(4);var a=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var s=function(t){a(e,t);function e(){var e=t.call(this)||this;e.on=e.onInternal;e.once=e.onceInternal;e.un=e.unInternal;e.revision_=0;return e}e.prototype.changed=function(){++this.revision_;this.dispatchEvent(i["a"].CHANGE)};e.prototype.getRevision=function(){return this.revision_};e.prototype.onInternal=function(t,e){if(Array.isArray(t)){var r=t.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=Object(o["a"])(this,t[i],e)}return n}else{return Object(o["a"])(this,t,e)}};e.prototype.onceInternal=function(t,e){var r;if(Array.isArray(t)){var n=t.length;r=new Array(n);for(var i=0;i<n;++i){r[i]=Object(o["b"])(this,t[i],e)}}else{r=Object(o["b"])(this,t,e)}e.ol_key=r;return r};e.prototype.unInternal=function(t,e){var r=e.ol_key;if(r){u(r)}else if(Array.isArray(t)){for(var n=0,i=t.length;n<i;++n){this.removeEventListener(t[n],e)}}else{this.removeEventListener(t,e)}};return e}(n["a"]);s.prototype.on;s.prototype.once;s.prototype.un;function u(t){if(Array.isArray(t)){for(var e=0,r=t.length;e<r;++e){Object(o["c"])(t[e])}}else{Object(o["c"])(t)}}e["default"]=s},function(t,e,r){"use strict";var n=r(1);var i=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var o=function(t){i(e,t);function e(e){var r=this;var i=n["a"]==="latest"?n["a"]:"v"+n["a"].split("-")[0];var o="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+e+" for details.";r=t.call(this,o)||this;r.code=e;r.name="AssertionError";r.message=o;return r}return e}(Error);e["a"]=o},function(t,e,r){"use strict";var n=r(12);var i=r(10);var o=r(1);var a=r(7);var s=r(3);var u=r(2);var l=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var h=function(t){l(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;r.background_=e.background;var n=Object(s["a"])({},e);if(typeof e.properties==="object"){delete n.properties;Object(s["a"])(n,e.properties)}n[i["a"].OPACITY]=e.opacity!==undefined?e.opacity:1;Object(a["a"])(typeof n[i["a"].OPACITY]==="number",64);n[i["a"].VISIBLE]=e.visible!==undefined?e.visible:true;n[i["a"].Z_INDEX]=e.zIndex;n[i["a"].MAX_RESOLUTION]=e.maxResolution!==undefined?e.maxResolution:Infinity;n[i["a"].MIN_RESOLUTION]=e.minResolution!==undefined?e.minResolution:0;n[i["a"].MIN_ZOOM]=e.minZoom!==undefined?e.minZoom:-Infinity;n[i["a"].MAX_ZOOM]=e.maxZoom!==undefined?e.maxZoom:Infinity;r.className_=n.className!==undefined?e.className:"ol-layer";delete n.className;r.setProperties(n);r.state_=null;return r}e.prototype.getBackground=function(){return this.background_};e.prototype.getClassName=function(){return this.className_};e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:t===undefined?true:t};var r=this.getZIndex();e.opacity=Object(u["b"])(Math.round(this.getOpacity()*100)/100,0,1);e.sourceState=this.getSourceState();e.visible=this.getVisible();e.extent=this.getExtent();e.zIndex=r===undefined&&!e.managed?Infinity:r;e.maxResolution=this.getMaxResolution();e.minResolution=Math.max(this.getMinResolution(),0);e.minZoom=this.getMinZoom();e.maxZoom=this.getMaxZoom();this.state_=e;return e};e.prototype.getLayersArray=function(t){return Object(o["b"])()};e.prototype.getLayerStatesArray=function(t){return Object(o["b"])()};e.prototype.getExtent=function(){return this.get(i["a"].EXTENT)};e.prototype.getMaxResolution=function(){return this.get(i["a"].MAX_RESOLUTION)};e.prototype.getMinResolution=function(){return this.get(i["a"].MIN_RESOLUTION)};e.prototype.getMinZoom=function(){return this.get(i["a"].MIN_ZOOM)};e.prototype.getMaxZoom=function(){return this.get(i["a"].MAX_ZOOM)};e.prototype.getOpacity=function(){return this.get(i["a"].OPACITY)};e.prototype.getSourceState=function(){return Object(o["b"])()};e.prototype.getVisible=function(){return this.get(i["a"].VISIBLE)};e.prototype.getZIndex=function(){return this.get(i["a"].Z_INDEX)};e.prototype.setBackground=function(t){this.background_=t;this.changed()};e.prototype.setExtent=function(t){this.set(i["a"].EXTENT,t)};e.prototype.setMaxResolution=function(t){this.set(i["a"].MAX_RESOLUTION,t)};e.prototype.setMinResolution=function(t){this.set(i["a"].MIN_RESOLUTION,t)};e.prototype.setMaxZoom=function(t){this.set(i["a"].MAX_ZOOM,t)};e.prototype.setMinZoom=function(t){this.set(i["a"].MIN_ZOOM,t)};e.prototype.setOpacity=function(t){Object(a["a"])(typeof t==="number",64);this.set(i["a"].OPACITY,t)};e.prototype.setVisible=function(t){this.set(i["a"].VISIBLE,t)};e.prototype.setZIndex=function(t){this.set(i["a"].Z_INDEX,t)};e.prototype.disposeInternal=function(){if(this.state_){this.state_.layer=null;this.state_=null}t.prototype.disposeInternal.call(this)};return e}(n["a"]);e["a"]=h},function(t,e,r){!function(e,r){true?t.exports=r():undefined}(this,(function(){"use strict";function t(t,n,i,o,a){!function t(r,n,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=n-i+1,l=Math.log(s),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(s-h)/s)*(u-s/2<0?-1:1),f=Math.max(i,Math.floor(n-u*h/s+c)),p=Math.min(o,Math.floor(n+(s-u)*h/s+c));t(r,n,f,p,a)}var d=r[n],v=i,_=o;for(e(r,i,n),a(r[o],d)>0&&e(r,i,o);v<_;){for(e(r,v,_),v++,_--;a(r[v],d)<0;)v++;for(;a(r[_],d)>0;)_--}0===a(r[i],d)?e(r,i,_):e(r,++_,o),_<=n&&(i=_+1),n<=_&&(o=_-1)}}(t,n,i||0,o||t.length-1,a||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,n,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var a=t.children[o];s(i,t.leaf?n(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,r,n,i,o){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=i)){var s=r+Math.ceil((n-r)/i/2)*i;t(e,s,r,n,o),a.push(r,s,s,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!p(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?n(a):a;p(t,s)&&(e.leaf?r.push(a):f(t,s)?this._all(a,r):i.push(a))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(p(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,a=this.data,s=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],r=l.pop(),o=!0),a.leaf){var h=i(t,a.children,e);if(-1!==h)return a.children.splice(h,1),u.push(a),this._condense(u),this}o||a.leaf||!f(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(u.push(a),l.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,a=r-e+1,s=this._maxEntries;if(a<=s)return o(i=d(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(i=d([])).leaf=!1,i.height=n;var u=Math.ceil(a/s),l=u*Math.ceil(Math.sqrt(s));v(t,e,r,l,this.compareMinX);for(var h=e;h<=r;h+=l){var c=Math.min(h+l-1,r);v(t,h,c,u,this.compareMinY);for(var f=h;f<=c;f+=u){var p=Math.min(f+u-1,c);i.children.push(this._build(t,f,p,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],l=h(u),c=(f=t,p=u,(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l);c<o?(o=c,i=l<i?l:i,a=u):c===o&&l<i&&(i=l,a=u)}e=a||e.children[0]}var f,p;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),s(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n),s=d(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,o(r,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,s,u,l,c,f=1/0,p=1/0,d=e;d<=r-e;d++){var v=a(t,0,d,this.toBBox),_=a(t,d,r,this.toBBox),g=(i=v,o=_,s=void 0,u=void 0,l=void 0,c=void 0,s=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),l=Math.min(i.maxX,o.maxX),c=Math.min(i.maxY,o.maxY),Math.max(0,l-s)*Math.max(0,c-u)),y=h(v)+h(_);g<f?(f=g,n=d,p=y<p?y:p):g===f&&y<p&&(p=y,n=d)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=a(t,0,e,i),u=a(t,r-e,r,i),l=c(o)+c(u),h=e;h<r-e;h++){var f=t.children[h];s(o,t.leaf?i(f):f),l+=c(o)}for(var p=r-e-1;p>=e;p--){var d=t.children[p];s(u,t.leaf?i(d):d),l+=c(u)}return l},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)s(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}))},function(t,e,r){(function(e,n){true?t.exports=n(r(17),r(25),r(22)):undefined})(this,(function(t,e,r){"use strict";t="default"in t?t["default"]:t;r="default"in r?r["default"]:r;var n=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}return function(e,r,n){if(r)t(e.prototype,r);if(n)t(e,n);return e}}();var o=function t(e,r,n){if(e===null)e=Function.prototype;var i=Object.getOwnPropertyDescriptor(e,r);if(i===undefined){var o=Object.getPrototypeOf(e);if(o===null){return undefined}else{return t(o,r,n)}}else if("value"in i){return i.value}else{var a=i.get;if(a===undefined){return undefined}return a.call(n)}};var a=function(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof e)}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e};var s=function(t,e){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e&&(typeof e==="object"||typeof e==="function")?e:t};var u="layer-switcher-";var l=function(t){a(l,t);function l(t){n(this,l);var e=Object.assign({},t);var r=e.tipLabel?e.tipLabel:"Legend";var i=e.collapseTipLabel?e.collapseTipLabel:"Collapse legend";var o=document.createElement("div");var a=s(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,{element:o,target:e.target}));a.activationMode=e.activationMode||"mouseover";a.startActive=e.startActive===true;var h=e.label!==undefined?e.label:"";var c=e.collapseLabel!==undefined?e.collapseLabel:"»";a.groupSelectStyle=l.getGroupSelectStyle(e.groupSelectStyle);a.reverse=e.reverse!==false;a.mapListeners=[];a.hiddenClassName="ol-unselectable ol-control layer-switcher";if(l.isTouchDevice_()){a.hiddenClassName+=" touch"}a.shownClassName="shown";o.className=a.hiddenClassName;var f=document.createElement("button");f.setAttribute("title",r);f.setAttribute("aria-label",r);o.appendChild(f);a.panel=document.createElement("div");a.panel.className="panel";o.appendChild(a.panel);l.enableTouchScroll_(a.panel);f.textContent=h;o.classList.add(u+"group-select-style-"+a.groupSelectStyle);o.classList.add(u+"activation-mode-"+a.activationMode);if(a.activationMode==="click"){o.classList.add("activationModeClick");if(a.startActive){f.textContent=c;f.setAttribute("title",i);f.setAttribute("aria-label",i)}f.onclick=function(t){var e=t||window.event;if(a.element.classList.contains(a.shownClassName)){a.hidePanel();f.textContent=h;f.setAttribute("title",r);f.setAttribute("aria-label",r)}else{a.showPanel();f.textContent=c;f.setAttribute("title",i);f.setAttribute("aria-label",i)}e.preventDefault()}}else{f.onmouseover=function(){a.showPanel()};f.onclick=function(t){var e=t||window.event;a.showPanel();e.preventDefault()};a.panel.onmouseout=function(t){if(!a.panel.contains(t.relatedTarget)){a.hidePanel()}}}return a}i(l,[{key:"setMap",value:function t(r){var n=this;for(var i=0;i<this.mapListeners.length;i++){e.unByKey(this.mapListeners[i])}this.mapListeners.length=0;o(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"setMap",this).call(this,r);if(r){if(this.startActive){this.showPanel()}else{this.renderPanel()}if(this.activationMode!=="click"){this.mapListeners.push(r.on("pointerdown",(function(){n.hidePanel()})))}}}},{key:"showPanel",value:function t(){if(!this.element.classList.contains(this.shownClassName)){this.element.classList.add(this.shownClassName);this.renderPanel()}}},{key:"hidePanel",value:function t(){if(this.element.classList.contains(this.shownClassName)){this.element.classList.remove(this.shownClassName)}}},{key:"renderPanel",value:function t(){this.dispatchEvent("render");l.renderPanel(this.getMap(),this.panel,{groupSelectStyle:this.groupSelectStyle,reverse:this.reverse});this.dispatchEvent("rendercomplete")}}],[{key:"renderPanel",value:function t(e,r,n){var i=new Event("render");r.dispatchEvent(i);n=n||{};n.groupSelectStyle=l.getGroupSelectStyle(n.groupSelectStyle);l.ensureTopVisibleBaseLayerShown(e,n.groupSelectStyle);while(r.firstChild){r.removeChild(r.firstChild)}l.forEachRecursive(e,(function(t,e,r){t.set("indeterminate",false)}));if(n.groupSelectStyle==="children"||n.groupSelectStyle==="none"){l.setGroupVisibility(e)}else if(n.groupSelectStyle==="group"){l.setChildVisibility(e)}var o=document.createElement("ul");r.appendChild(o);l.renderLayers_(e,e,o,n,(function t(i){l.renderPanel(e,r,n)}));var a=new Event("rendercomplete");r.dispatchEvent(a)}},{key:"isBaseGroup",value:function t(e){if(e instanceof r){var n=e.getLayers().getArray();return n.length&&n[0].get("type")==="base"}else{return false}}},{key:"setGroupVisibility",value:function t(e){var n=l.getGroupsAndLayers(e,(function(t){return t instanceof r&&!t.get("combine")&&!l.isBaseGroup(t)})).reverse();n.forEach((function(t){var e=t.getLayersArray().map((function(t){var e=t.getVisible();return e}));if(e.every((function(t){return t===true}))){t.setVisible(true);t.set("indeterminate",false)}else if(e.every((function(t){return t===false}))){t.setVisible(false);t.set("indeterminate",false)}else{t.setVisible(true);t.set("indeterminate",true)}}))}},{key:"setChildVisibility",value:function t(e){var n=l.getGroupsAndLayers(e,(function(t){return t instanceof r&&!t.get("combine")&&!l.isBaseGroup(t)}));n.forEach((function(t){var e=t;var r=e.getVisible();var n=e.get("indeterminate");e.getLayers().getArray().forEach((function(t){t.set("indeterminate",false);if((!r||n)&&t.getVisible()){t.set("indeterminate",true)}}))}))}},{key:"ensureTopVisibleBaseLayerShown",value:function t(e,r){var n=void 0;l.forEachRecursive(e,(function(t,e,r){if(t.get("type")==="base"&&t.getVisible()){n=t}}));if(n)l.setVisible_(e,n,true,r)}},{key:"getGroupsAndLayers",value:function t(e,r){var n=[];r=r||function(t,e,r){return true};l.forEachRecursive(e,(function(t,e,i){if(t.get("title")){if(r(t,e,i)){n.push(t)}}}));return n}},{key:"setVisible_",value:function t(e,n,i,o){n.setVisible(i);if(i&&n.get("type")==="base"){l.forEachRecursive(e,(function(t,e,r){if(t!=n&&t.get("type")==="base"){t.setVisible(false)}}))}if(n instanceof r&&!n.get("combine")&&o==="children"){n.getLayers().forEach((function(t){l.setVisible_(e,t,n.getVisible(),o)}))}}},{key:"renderLayer_",value:function t(e,n,i,o,a){var s=document.createElement("li");var h=n.get("title");var c=l.uuid();var f=document.createElement("label");if(n instanceof r&&!n.get("combine")){var p=l.isBaseGroup(n);s.classList.add("group");if(p){s.classList.add(u+"base-group")}if(n.get("fold")){s.classList.add(u+"fold");s.classList.add(u+n.get("fold"));var d=document.createElement("button");d.onclick=function(t){var e=t||window.event;l.toggleFold_(n,s);e.preventDefault()};s.appendChild(d)}if(!p&&o.groupSelectStyle!="none"){var v=document.createElement("input");v.type="checkbox";v.id=c;v.checked=n.getVisible();v.indeterminate=n.get("indeterminate");v.onchange=function(t){var r=t.target;l.setVisible_(e,n,r.checked,o.groupSelectStyle);a(n)};s.appendChild(v);f.htmlFor=c}f.innerHTML=h;s.appendChild(f);var _=document.createElement("ul");s.appendChild(_);l.renderLayers_(e,n,_,o,a)}else{s.className="layer";var g=document.createElement("input");if(n.get("type")==="base"){g.type="radio";g.name="base"}else{g.type="checkbox"}g.id=c;g.checked=n.get("visible");g.indeterminate=n.get("indeterminate");g.onchange=function(t){var r=t.target;l.setVisible_(e,n,r.checked,o.groupSelectStyle);a(n)};s.appendChild(g);f.htmlFor=c;f.innerHTML=h;var y=e.getView().getResolution();if(y>n.getMaxResolution()||y<n.getMinResolution()){f.className+=" disabled"}s.appendChild(f)}return s}},{key:"renderLayers_",value:function t(e,r,n,i,o){var a=r.getLayers().getArray().slice();if(i.reverse)a=a.reverse();for(var s=0,u;s<a.length;s++){u=a[s];if(u.get("title")){n.appendChild(l.renderLayer_(e,u,s,i,o))}}}},{key:"forEachRecursive",value:function t(e,n){e.getLayers().forEach((function(t,e,i){n(t,e,i);if(t instanceof r){l.forEachRecursive(t,n)}}))}},{key:"uuid",value:function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=Math.random()*16|0,r=t=="x"?e:e&3|8;return r.toString(16)}))}},{key:"enableTouchScroll_",value:function t(e){if(l.isTouchDevice_()){var r=0;e.addEventListener("touchstart",(function(t){r=this.scrollTop+t.touches[0].pageY}),false);e.addEventListener("touchmove",(function(t){this.scrollTop=r-t.touches[0].pageY}),false)}}},{key:"isTouchDevice_",value:function t(){try{document.createEvent("TouchEvent");return true}catch(t){return false}}},{key:"toggleFold_",value:function t(e,r){r.classList.remove(u+e.get("fold"));e.set("fold",e.get("fold")==="open"?"close":"open");r.classList.add(u+e.get("fold"))}},{key:"getGroupSelectStyle",value:function t(e){return["none","children","group"].indexOf(e)>=0?e:"children"}}]);return l}(t);if(window["ol"]&&window["ol"]["control"]){window["ol"]["control"]["LayerSwitcher"]=l}return l}))},,,,,,,,,,,function(t,e,r){"use strict";r.r(e);const n={dynamicUrl:undefined};var i={};var o=r(24);var a=r(9);var s=r(1);var u=r(14);var l=r(7);var h=new Array(6);function c(){return[1,0,0,1,0,0]}function f(t){return d(t,1,0,0,1,0,0)}function p(t,e){var r=t[0];var n=t[1];var i=t[2];var o=t[3];var a=t[4];var s=t[5];var u=e[0];var l=e[1];var h=e[2];var c=e[3];var f=e[4];var p=e[5];t[0]=r*u+i*l;t[1]=n*u+o*l;t[2]=r*h+i*c;t[3]=n*h+o*c;t[4]=r*f+i*p+a;t[5]=n*f+o*p+s;return t}function d(t,e,r,n,i,o,a){t[0]=e;t[1]=r;t[2]=n;t[3]=i;t[4]=o;t[5]=a;return t}function v(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];return t}function _(t,e){var r=e[0];var n=e[1];e[0]=t[0]*r+t[2]*n+t[4];e[1]=t[1]*r+t[3]*n+t[5];return e}function g(t,e){var r=Math.cos(e);var n=Math.sin(e);return p(t,d(h,r,n,-n,r,0,0))}function y(t,e,r){return p(t,d(h,e,0,0,r,0,0))}function m(t,e,r){return d(t,e,0,0,r,0,0)}function E(t,e,r){return p(t,d(h,1,0,0,1,e,r))}function O(t,e,r,n,i,o,a,s){var u=Math.sin(o);var l=Math.cos(o);t[0]=n*l;t[1]=i*u;t[2]=-n*u;t[3]=i*l;t[4]=a*n*l-s*n*u+e;t[5]=a*i*u+s*i*l+r;return t}function b(t,e,r,n,i,o,a){return C(O(c(),t,e,r,n,i,o,a))}function x(t){return w(t,t)}function w(t,e){var r=M(e);Object(l["a"])(r!==0,32);var n=e[0];var i=e[1];var o=e[2];var a=e[3];var s=e[4];var u=e[5];t[0]=a/r;t[1]=-i/r;t[2]=-o/r;t[3]=n/r;t[4]=(o*u-a*s)/r;t[5]=-(n*u-i*s)/r;return t}function M(t){return t[0]*t[3]-t[1]*t[2]}var S;function C(t){var e="matrix("+t.join(", ")+")";if(u["g"]){return e}var r=S||(S=document.createElement("div"));r.style.transform=e;return r.style.transform}var R=r(0);var T=r(2);var I=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;var P=/^([a-z]*)$|^hsla?\(.*\)$/i;function L(t){if(typeof t==="string"){return t}else{return G(t)}}function A(t){var e=document.createElement("div");e.style.color=t;if(e.style.color!==""){document.body.appendChild(e);var r=getComputedStyle(e).color;document.body.removeChild(e);return r}else{return""}}var j=function(){var t=1024;var e={};var r=0;return function(n){var i;if(e.hasOwnProperty(n)){i=e[n]}else{if(r>=t){var o=0;for(var a in e){if((o++&3)===0){delete e[a];--r}}}i=F(n);e[n]=i;++r}return i}}();function N(t){if(Array.isArray(t)){return t}else{return j(t)}}function F(t){var e,r,n,i,o;if(P.exec(t)){t=A(t)}if(I.exec(t)){var a=t.length-1;var s=void 0;if(a<=4){s=1}else{s=2}var u=a===4||a===8;e=parseInt(t.substr(1+0*s,s),16);r=parseInt(t.substr(1+1*s,s),16);n=parseInt(t.substr(1+2*s,s),16);if(u){i=parseInt(t.substr(1+3*s,s),16)}else{i=255}if(s==1){e=(e<<4)+e;r=(r<<4)+r;n=(n<<4)+n;if(u){i=(i<<4)+i}}o=[e,r,n,i/255]}else if(t.indexOf("rgba(")==0){o=t.slice(5,-1).split(",").map(Number);D(o)}else if(t.indexOf("rgb(")==0){o=t.slice(4,-1).split(",").map(Number);o.push(1);D(o)}else{Object(l["a"])(false,14)}return o}function D(t){t[0]=Object(T["b"])(t[0]+.5|0,0,255);t[1]=Object(T["b"])(t[1]+.5|0,0,255);t[2]=Object(T["b"])(t[2]+.5|0,0,255);t[3]=Object(T["b"])(t[3],0,1);return t}function G(t){var e=t[0];if(e!=(e|0)){e=e+.5|0}var r=t[1];if(r!=(r|0)){r=r+.5|0}var n=t[2];if(n!=(n|0)){n=n+.5|0}var i=t[3]===undefined?1:Math.round(t[3]*100)/100;return"rgba("+e+","+r+","+n+","+i+")"}function k(t){if(P.test(t)){t=A(t)}return I.test(t)||t.indexOf("rgba(")===0||t.indexOf("rgb(")===0}var U=function(){function t(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32}t.prototype.clear=function(){this.cache_={};this.cacheSize_=0};t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_};t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var r=this.cache_[e];if((t++&3)===0&&!r.hasListener()){delete this.cache_[e];--this.cacheSize_}}}};t.prototype.get=function(t,e,r){var n=B(t,e,r);return n in this.cache_?this.cache_[n]:null};t.prototype.set=function(t,e,r,n){var i=B(t,e,r);this.cache_[i]=n;++this.cacheSize_};t.prototype.setSize=function(t){this.maxCacheSize_=t;this.expire()};return t}();function B(t,e,r){var n=r?L(r):"null";return e+":"+t+":"+n}var z=U;var Y=new U;var W=r(27);var V=r(6);var X=r(10);var q={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var Z=r(19);var K=r(3);var H=r(4);var J=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Q=function(t){J(e,t);function e(e){var r=this;var n=Object(K["a"])({},e);delete n.source;r=t.call(this,n)||this;r.on;r.once;r.un;r.mapPrecomposeKey_=null;r.mapRenderKey_=null;r.sourceChangeKey_=null;r.renderer_=null;if(e.render){r.render=e.render}if(e.map){r.setMap(e.map)}r.addChangeListener(X["a"].SOURCE,r.handleSourcePropertyChange_);var i=e.source?e.source:null;r.setSource(i);return r}e.prototype.getLayersArray=function(t){var e=t?t:[];e.push(this);return e};e.prototype.getLayerStatesArray=function(t){var e=t?t:[];e.push(this.getLayerState());return e};e.prototype.getSource=function(){return this.get(X["a"].SOURCE)||null};e.prototype.getSourceState=function(){var t=this.getSource();return!t?Z["a"].UNDEFINED:t.getState()};e.prototype.handleSourceChange_=function(){this.changed()};e.prototype.handleSourcePropertyChange_=function(){if(this.sourceChangeKey_){Object(H["c"])(this.sourceChangeKey_);this.sourceChangeKey_=null}var t=this.getSource();if(t){this.sourceChangeKey_=Object(H["a"])(t,V["a"].CHANGE,this.handleSourceChange_,this)}this.changed()};e.prototype.getFeatures=function(t){if(!this.renderer_){return new Promise((function(t){return t([])}))}return this.renderer_.getFeatures(t)};e.prototype.render=function(t,e){var r=this.getRenderer();if(r.prepareFrame(t)){return r.renderFrame(t,e)}};e.prototype.setMapInternal=function(t){this.set(X["a"].MAP,t)};e.prototype.getMapInternal=function(){return this.get(X["a"].MAP)};e.prototype.setMap=function(t){if(this.mapPrecomposeKey_){Object(H["c"])(this.mapPrecomposeKey_);this.mapPrecomposeKey_=null}if(!t){this.changed()}if(this.mapRenderKey_){Object(H["c"])(this.mapRenderKey_);this.mapRenderKey_=null}if(t){this.mapPrecomposeKey_=Object(H["a"])(t,q.PRECOMPOSE,(function(t){var e=t;var r=e.frameState.layerStatesArray;var n=this.getLayerState(false);Object(l["a"])(!r.some((function(t){return t.layer===n.layer})),67);r.push(n)}),this);this.mapRenderKey_=Object(H["a"])(this,V["a"].CHANGE,t.render,t);this.changed()}};e.prototype.setSource=function(t){this.set(X["a"].SOURCE,t)};e.prototype.getRenderer=function(){if(!this.renderer_){this.renderer_=this.createRenderer()}return this.renderer_};e.prototype.hasRenderer=function(){return!!this.renderer_};e.prototype.createRenderer=function(){return null};e.prototype.disposeInternal=function(){if(this.renderer_){this.renderer_.dispose();delete this.renderer_}this.setSource(null);t.prototype.disposeInternal.call(this)};return e}(W["a"]);function $(t,e){if(!t.visible){return false}var r=e.resolution;if(r<t.minResolution||r>=t.maxResolution){return false}var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var tt=Q;function et(t,e,r){var n=r!==undefined?t.toFixed(r):""+t;var i=n.indexOf(".");i=i===-1?n.length:i;return i>e?n:new Array(1+e-i).join("0")+n}function rt(t,e){var r=(""+t).split(".");var n=(""+e).split(".");for(var i=0;i<Math.max(r.length,n.length);i++){var o=parseInt(r[i]||"0",10);var a=parseInt(n[i]||"0",10);if(o>a){return 1}if(a>o){return-1}}return 0}function nt(t,e){t[0]+=+e[0];t[1]+=+e[1];return t}function it(t,e){var r=e.getRadius();var n=e.getCenter();var i=n[0];var o=n[1];var a=t[0];var s=t[1];var u=a-i;var l=s-o;if(u===0&&l===0){u=1}var h=Math.sqrt(u*u+l*l);var c=i+r*u/h;var f=o+r*l/h;return[c,f]}function ot(t,e){var r=t[0];var n=t[1];var i=e[0];var o=e[1];var a=i[0];var s=i[1];var u=o[0];var l=o[1];var h=u-a;var c=l-s;var f=h===0&&c===0?0:(h*(r-a)+c*(n-s))/(h*h+c*c||0);var p,d;if(f<=0){p=a;d=s}else if(f>=1){p=u;d=l}else{p=a+f*h;d=s+f*c}return[p,d]}function at(t){return function(e){return _t(e,t)}}function st(t,e,r){var n=Object(T["g"])(e+180,360)-180;var i=Math.abs(3600*n);var o=r||0;var a=Math.pow(10,o);var s=Math.floor(i/3600);var u=Math.floor((i-s*3600)/60);var l=i-s*3600-u*60;l=Math.ceil(l*a)/a;if(l>=60){l=0;u+=1}if(u>=60){u=0;s+=1}return s+"° "+et(u,2)+"′ "+et(l,2,o)+"″"+(n==0?"":" "+t.charAt(n<0?1:0))}function ut(t,e,r){if(t){return e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r))}else{return""}}function lt(t,e){var r=true;for(var n=t.length-1;n>=0;--n){if(t[n]!=e[n]){r=false;break}}return r}function ht(t,e){var r=Math.cos(e);var n=Math.sin(e);var i=t[0]*r-t[1]*n;var o=t[1]*r+t[0]*n;t[0]=i;t[1]=o;return t}function ct(t,e){t[0]*=e;t[1]*=e;return t}function ft(t,e){var r=t[0]-e[0];var n=t[1]-e[1];return r*r+n*n}function pt(t,e){return Math.sqrt(ft(t,e))}function dt(t,e){return ft(t,ot(t,e))}function vt(t,e){if(t){return st("NS",t[1],e)+" "+st("EW",t[0],e)}else{return""}}function _t(t,e){return ut(t,"{x}, {y}",e)}function gt(t,e){if(e.canWrapX()){var r=Object(R["D"])(e.getExtent());var n=yt(t,e,r);if(n){t[0]-=n*r}}return t}function yt(t,e,r){var n=e.getExtent();var i=0;if(e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])){var o=r||Object(R["D"])(n);i=Math.floor((t[0]-n[0])/o)}return i}var mt=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Et=function(t){mt(e,t);function e(e){var r=t.call(this)||this;r.map_=e;return r}e.prototype.dispatchRenderEvent=function(t,e){Object(s["b"])()};e.prototype.calculateMatrices2D=function(t){var e=t.viewState;var r=t.coordinateToPixelTransform;var n=t.pixelToCoordinateTransform;O(r,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]);w(n,r)};e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i,o,a,s){var u;var l=e.viewState;function h(t,e,r,n){return i.call(o,e,t?r:null,n)}var c=l.projection;var f=gt(t.slice(),c);var p=[[0,0]];if(c.canWrapX()&&n){var d=c.getExtent();var v=Object(R["D"])(d);p.push([-v,0],[v,0])}var _=e.layerStatesArray;var g=_.length;var y=[];var m=[];for(var E=0;E<p.length;E++){for(var O=g-1;O>=0;--O){var b=_[O];var x=b.layer;if(x.hasRenderer()&&$(b,l)&&a.call(s,x)){var w=x.getRenderer();var M=x.getSource();if(w&&M){var S=M.getWrapX()?f:t;var C=h.bind(null,b.managed);m[0]=S[0]+p[E][0];m[1]=S[1]+p[E][1];u=w.forEachFeatureAtCoordinate(m,e,r,C,y)}if(u){return u}}}}if(y.length===0){return undefined}var T=1/y.length;y.forEach((function(t,e){return t.distanceSq+=e*T}));y.sort((function(t,e){return t.distanceSq-e.distanceSq}));y.some((function(t){return u=t.callback(t.feature,t.layer,t.geometry)}));return u};e.prototype.forEachLayerAtPixel=function(t,e,r,n,i){return Object(s["b"])()};e.prototype.hasFeatureAtCoordinate=function(t,e,r,n,i,o){var s=this.forEachFeatureAtCoordinate(t,e,r,n,a["b"],this,i,o);return s!==undefined};e.prototype.getMap=function(){return this.map_};e.prototype.renderFrame=function(t){Object(s["b"])()};e.prototype.scheduleExpireIconCache=function(t){if(Y.canExpireCache()){t.postRenderFunctions.push(Ot)}};return e}(o["a"]);function Ot(t,e){Y.expire()}var bt=Et;var xt=r(18);var wt=r(13);var Mt=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var St=function(t){Mt(e,t);function e(e,r,n,i){var o=t.call(this,e)||this;o.inversePixelTransform=r;o.frameState=n;o.context=i;return o}return e}(wt["a"]);var Ct=St;var Rt="ol-hidden";var Tt="ol-selectable";var It="ol-unselectable";var Pt="ol-unsupported";var Lt="ol-control";var At="ol-collapsed";var jt=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i");var Nt=["style","variant","weight","size","lineHeight","family"];var Ft=function(t){var e=t.match(jt);if(!e){return null}var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(var n=0,i=Nt.length;n<i;++n){var o=e[n+1];if(o!==undefined){r[Nt[n]]=o}}r.families=r.family.split(/,\s?/);return r};function Dt(t){return t===1?"":String(Math.round(t*100)/100)}var Gt=r(12);var kt=r(20);var Ut=r(8);var Bt="10px sans-serif";var zt="#000";var Yt="round";var Wt=[];var Vt=0;var Xt="round";var qt=10;var Zt="#000";var Kt="center";var Ht="middle";var Jt=[0,0,0,0];var Qt=1;var $t=new Gt["a"];var te=new kt["a"];te.setSize=function(){console.warn("labelCache is deprecated.")};var ee=null;var re;var ne={};var ie=function(){var t=100;var e="32px ";var r=["monospace","serif"];var n=r.length;var i="wmytzilWMYTZIL@#/&?$%10";var o,a;function s(t,o,s){var u=true;for(var l=0;l<n;++l){var h=r[l];a=se(t+" "+o+" "+e+h,i);if(s!=h){var c=se(t+" "+o+" "+e+s+","+h,i);u=u&&c!=a}}if(u){return true}return false}function u(){var e=true;var r=$t.getKeys();for(var n=0,i=r.length;n<i;++n){var a=r[n];if($t.get(a)<t){if(s.apply(this,a.split("\n"))){Object(K["b"])(ne);ee=null;re=undefined;$t.set(a,t)}else{$t.set(a,$t.get(a)+1,true);e=false}}}if(e){clearInterval(o);o=undefined}}return function(e){var r=Ft(e);if(!r){return}var n=r.families;for(var i=0,a=n.length;i<a;++i){var l=n[i];var h=r.style+"\n"+r.weight+"\n"+l;if($t.get(h)===undefined){$t.set(h,t,true);if(!s(r.style,r.weight,l)){$t.set(h,0,true);if(o===undefined){o=setInterval(u,32)}}}}}}();var oe=function(){var t;return function(e){var r=ne[e];if(r==undefined){if(u["g"]){var n=Ft(e);var i=ae(e,"Žg");var o=isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight);r=o*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else{if(!t){t=document.createElement("div");t.innerHTML="M";t.style.minHeight="0";t.style.maxHeight="none";t.style.height="auto";t.style.padding="0";t.style.border="none";t.style.position="absolute";t.style.display="block";t.style.left="-99999px"}t.style.font=e;document.body.appendChild(t);r=t.offsetHeight;document.body.removeChild(t)}ne[e]=r}return r}}();function ae(t,e){if(!ee){ee=Object(Ut["a"])(1,1)}if(t!=re){ee.font=t;re=ee.font}return ee.measureText(e)}function se(t,e){return ae(t,e).width}function ue(t,e,r){if(e in r){return r[e]}var n=se(t,e);r[e]=n;return n}function le(t,e,r){var n=e.length;var i=0;for(var o=0;o<n;++o){var a=se(t,e[o]);i=Math.max(i,a);r.push(a)}return i}function he(t,e,r,n){if(e!==0){t.translate(r,n);t.rotate(e);t.translate(-r,-n)}}function ce(t,e,r,n,i,o,a,s,u,l,h){t.save();if(r!==1){t.globalAlpha*=r}if(e){t.setTransform.apply(t,e)}if(n.contextInstructions){t.translate(u,l);t.scale(h[0],h[1]);fe(n,t)}else if(h[0]<0||h[1]<0){t.translate(u,l);t.scale(h[0],h[1]);t.drawImage(n,i,o,a,s,0,0,a,s)}else{t.drawImage(n,i,o,a,s,u,l,a*h[0],s*h[1])}t.restore()}function fe(t,e){var r=t.contextInstructions;for(var n=0,i=r.length;n<i;n+=2){if(Array.isArray(r[n+1])){e[r[n]].apply(e,r[n+1])}else{e[r[n]]=r[n+1]}}}var pe=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var de=function(t){pe(e,t);function e(e){var r=t.call(this,e)||this;r.fontChangeListenerKey_=Object(H["a"])($t,xt["a"].PROPERTYCHANGE,e.redrawText.bind(e));r.element_=document.createElement("div");var n=r.element_.style;n.position="absolute";n.width="100%";n.height="100%";n.zIndex="0";r.element_.className=It+" ol-layers";var i=e.getViewport();i.insertBefore(r.element_,i.firstChild||null);r.children_=[];r.renderedVisible_=true;return r}e.prototype.dispatchRenderEvent=function(t,e){var r=this.getMap();if(r.hasListener(t)){var n=new Ct(t,undefined,e);r.dispatchEvent(n)}};e.prototype.disposeInternal=function(){Object(H["c"])(this.fontChangeListenerKey_);this.element_.parentNode.removeChild(this.element_);t.prototype.disposeInternal.call(this)};e.prototype.renderFrame=function(t){if(!t){if(this.renderedVisible_){this.element_.style.display="none";this.renderedVisible_=false}return}this.calculateMatrices2D(t);this.dispatchRenderEvent(q.PRECOMPOSE,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex}));var r=t.viewState;this.children_.length=0;var n=[];var i=null;for(var o=0,a=e.length;o<a;++o){var s=e[o];t.layerIndex=o;if(!$(s,r)||s.sourceState!=Z["a"].READY&&s.sourceState!=Z["a"].UNDEFINED){continue}var u=s.layer;var l=u.render(t,i);if(!l){continue}if(l!==i){this.children_.push(l);i=l}if("getDeclutter"in u){n.push(u)}}for(var o=n.length-1;o>=0;--o){n[o].renderDeclutter(t)}Object(Ut["f"])(this.element_,this.children_);this.dispatchRenderEvent(q.POSTCOMPOSE,t);if(!this.renderedVisible_){this.element_.style.display="";this.renderedVisible_=true}this.scheduleExpireIconCache(t)};e.prototype.forEachLayerAtPixel=function(t,e,r,n,i){var o=e.viewState;var a=e.layerStatesArray;var s=a.length;for(var u=s-1;u>=0;--u){var l=a[u];var h=l.layer;if(h.hasRenderer()&&$(l,o)&&i(h)){var c=h.getRenderer();var f=c.getDataAtPixel(t,e,r);if(f){var p=n(h,f);if(p){return p}}}}return undefined};return e}(bt);var ve=de;var _e=r(16);var ge=r(11);var ye=r(22);var me=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ee=function(t){me(e,t);function e(e,r,n){var i=t.call(this,e)||this;i.map=r;i.frameState=n!==undefined?n:null;return i}return e}(wt["a"]);var Oe=Ee;var be=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var xe=function(t){be(e,t);function e(e,r,n,i,o){var a=t.call(this,e,r,o)||this;a.originalEvent=n;a.pixel_=null;a.coordinate_=null;a.dragging=i!==undefined?i:false;return a}Object.defineProperty(e.prototype,"pixel",{get:function(){if(!this.pixel_){this.pixel_=this.map.getEventPixel(this.originalEvent)}return this.pixel_},set:function(t){this.pixel_=t},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"coordinate",{get:function(){if(!this.coordinate_){this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)}return this.coordinate_},set:function(t){this.coordinate_=t},enumerable:false,configurable:true});e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this);if("preventDefault"in this.originalEvent){this.originalEvent.preventDefault()}};e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this);if("stopPropagation"in this.originalEvent){this.originalEvent.stopPropagation()}};return e}(Oe);var we=xe;var Me={SINGLECLICK:"singleclick",CLICK:V["a"].CLICK,DBLCLICK:V["a"].DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Se={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Ce=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Re=function(t){Ce(e,t);function e(e,r){var n=t.call(this,e)||this;n.map_=e;n.clickTimeoutId_;n.emulateClicks_=false;n.dragging_=false;n.dragListenerKeys_=[];n.moveTolerance_=r===undefined?1:r;n.down_=null;var i=n.map_.getViewport();n.activePointers_=0;n.trackedTouches_={};n.element_=i;n.pointerdownListenerKey_=Object(H["a"])(i,Se.POINTERDOWN,n.handlePointerDown_,n);n.originalPointerMoveEvent_;n.relayedListenerKey_=Object(H["a"])(i,Se.POINTERMOVE,n.relayEvent_,n);n.boundHandleTouchMove_=n.handleTouchMove_.bind(n);n.element_.addEventListener(V["a"].TOUCHMOVE,n.boundHandleTouchMove_,u["e"]?{passive:false}:false);return n}e.prototype.emulateClick_=function(t){var e=new we(Me.CLICK,this.map_,t);this.dispatchEvent(e);if(this.clickTimeoutId_!==undefined){clearTimeout(this.clickTimeoutId_);this.clickTimeoutId_=undefined;e=new we(Me.DBLCLICK,this.map_,t);this.dispatchEvent(e)}else{this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=undefined;var e=new we(Me.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}};e.prototype.updateActivePointers_=function(t){var e=t;if(e.type==Me.POINTERUP||e.type==Me.POINTERCANCEL){delete this.trackedTouches_[e.pointerId]}else if(e.type==Me.POINTERDOWN){this.trackedTouches_[e.pointerId]=true}this.activePointers_=Object.keys(this.trackedTouches_).length};e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new we(Me.POINTERUP,this.map_,t);this.dispatchEvent(e);if(this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)){this.emulateClick_(this.down_)}if(this.activePointers_===0){this.dragListenerKeys_.forEach(H["c"]);this.dragListenerKeys_.length=0;this.dragging_=false;this.down_=null}};e.prototype.isMouseActionButton_=function(t){return t.button===0};e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0;this.updateActivePointers_(t);var e=new we(Me.POINTERDOWN,this.map_,t);this.dispatchEvent(e);this.down_={};for(var r in t){var n=t[r];this.down_[r]=typeof n==="function"?a["c"]:n}if(this.dragListenerKeys_.length===0){var i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Object(H["a"])(i,Me.POINTERMOVE,this.handlePointerMove_,this),Object(H["a"])(i,Me.POINTERUP,this.handlePointerUp_,this),Object(H["a"])(this.element_,Me.POINTERCANCEL,this.handlePointerUp_,this));if(this.element_.getRootNode&&this.element_.getRootNode()!==i){this.dragListenerKeys_.push(Object(H["a"])(this.element_.getRootNode(),Me.POINTERUP,this.handlePointerUp_,this))}}};e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=true;var e=new we(Me.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}};e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new we(t.type,this.map_,t,e))};e.prototype.handleTouchMove_=function(t){var e=this.originalPointerMoveEvent_;if((!e||e.defaultPrevented)&&(typeof t.cancelable!=="boolean"||t.cancelable===true)){t.preventDefault()}};e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_};e.prototype.disposeInternal=function(){if(this.relayedListenerKey_){Object(H["c"])(this.relayedListenerKey_);this.relayedListenerKey_=null}this.element_.removeEventListener(V["a"].TOUCHMOVE,this.boundHandleTouchMove_);if(this.pointerdownListenerKey_){Object(H["c"])(this.pointerdownListenerKey_);this.pointerdownListenerKey_=null}this.dragListenerKeys_.forEach(H["c"]);this.dragListenerKeys_.length=0;this.element_=null;t.prototype.disposeInternal.call(this)};return e}(kt["a"]);var Te=Re;var Ie=r(21);var Pe={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var Le=Infinity;var Ae=function(){function t(t,e){this.priorityFunction_=t;this.keyFunction_=e;this.elements_=[];this.priorities_=[];this.queuedElements_={}}t.prototype.clear=function(){this.elements_.length=0;this.priorities_.length=0;Object(K["b"])(this.queuedElements_)};t.prototype.dequeue=function(){var t=this.elements_;var e=this.priorities_;var r=t[0];if(t.length==1){t.length=0;e.length=0}else{t[0]=t.pop();e[0]=e.pop();this.siftUp_(0)}var n=this.keyFunction_(r);delete this.queuedElements_[n];return r};t.prototype.enqueue=function(t){Object(l["a"])(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);if(e!=Le){this.elements_.push(t);this.priorities_.push(e);this.queuedElements_[this.keyFunction_(t)]=true;this.siftDown_(0,this.elements_.length-1);return true}return false};t.prototype.getCount=function(){return this.elements_.length};t.prototype.getLeftChildIndex_=function(t){return t*2+1};t.prototype.getRightChildIndex_=function(t){return t*2+2};t.prototype.getParentIndex_=function(t){return t-1>>1};t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--){this.siftUp_(t)}};t.prototype.isEmpty=function(){return this.elements_.length===0};t.prototype.isKeyQueued=function(t){return t in this.queuedElements_};t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))};t.prototype.siftUp_=function(t){var e=this.elements_;var r=this.priorities_;var n=e.length;var i=e[t];var o=r[t];var a=t;while(t<n>>1){var s=this.getLeftChildIndex_(t);var u=this.getRightChildIndex_(t);var l=u<n&&r[u]<r[s]?u:s;e[t]=e[l];r[t]=r[l];t=l}e[t]=i;r[t]=o;this.siftDown_(a,t)};t.prototype.siftDown_=function(t,e){var r=this.elements_;var n=this.priorities_;var i=r[e];var o=n[e];while(e>t){var a=this.getParentIndex_(e);if(n[a]>o){r[e]=r[a];n[e]=n[a];e=a}else{break}}r[e]=i;n[e]=o};t.prototype.reprioritize=function(){var t=this.priorityFunction_;var e=this.elements_;var r=this.priorities_;var n=0;var i=e.length;var o,a,s;for(a=0;a<i;++a){o=e[a];s=t(o);if(s==Le){delete this.queuedElements_[this.keyFunction_(o)]}else{r[n]=s;e[n++]=o}}e.length=n;r.length=n;this.heapify_()};return t}();var je=Ae;var Ne={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Fe=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var De=function(t){Fe(e,t);function e(e,r){var n=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;n.boundHandleTileChange_=n.handleTileChange.bind(n);n.tileChangeCallback_=r;n.tilesLoading_=0;n.tilesLoadingKeys_={};return n}e.prototype.enqueue=function(e){var r=t.prototype.enqueue.call(this,e);if(r){var n=e[0];n.addEventListener(V["a"].CHANGE,this.boundHandleTileChange_)}return r};e.prototype.getTilesLoading=function(){return this.tilesLoading_};e.prototype.handleTileChange=function(t){var e=t.target;var r=e.getState();if(r===Ne.LOADED||r===Ne.ERROR||r===Ne.EMPTY){e.removeEventListener(V["a"].CHANGE,this.boundHandleTileChange_);var n=e.getKey();if(n in this.tilesLoadingKeys_){delete this.tilesLoadingKeys_[n];--this.tilesLoading_}this.tileChangeCallback_()}};e.prototype.loadMoreTiles=function(t,e){var r=0;var n,i,o;while(this.tilesLoading_<t&&r<e&&this.getCount()>0){i=this.dequeue()[0];o=i.getKey();n=i.getState();if(n===Ne.IDLE&&!(o in this.tilesLoadingKeys_)){this.tilesLoadingKeys_[o]=true;++this.tilesLoading_;++r;i.load()}}};return e}(je);var Ge=De;function ke(t,e,r,n,i){if(!t||!(r in t.wantedTiles)){return Le}if(!t.wantedTiles[r][e.getKey()]){return Le}var o=t.viewState.center;var a=n[0]-o[0];var s=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+s*s)/i}var Ue={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};var Be={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};var ze={9001:Be.METERS,9002:Be.FEET,9003:Be.USFEET,9101:Be.RADIANS,9102:Be.DEGREES};function Ye(t){return ze[t]}var We={};We[Be.RADIANS]=6370997/(2*Math.PI);We[Be.DEGREES]=2*Math.PI*6370997/360;We[Be.FEET]=.3048;We[Be.METERS]=1;We[Be.USFEET]=1200/3937;var Ve=Be;var Xe={ANIMATING:0,INTERACTING:1};var qe={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var Ze=42;var Ke=256;var He=function(){function t(t){this.code_=t.code;this.units_=t.units;this.extent_=t.extent!==undefined?t.extent:null;this.worldExtent_=t.worldExtent!==undefined?t.worldExtent:null;this.axisOrientation_=t.axisOrientation!==undefined?t.axisOrientation:"enu";this.global_=t.global!==undefined?t.global:false;this.canWrapX_=!!(this.global_&&this.extent_);this.getPointResolutionFunc_=t.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=t.metersPerUnit}t.prototype.canWrapX=function(){return this.canWrapX_};t.prototype.getCode=function(){return this.code_};t.prototype.getExtent=function(){return this.extent_};t.prototype.getUnits=function(){return this.units_};t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||We[this.units_]};t.prototype.getWorldExtent=function(){return this.worldExtent_};t.prototype.getAxisOrientation=function(){return this.axisOrientation_};t.prototype.isGlobal=function(){return this.global_};t.prototype.setGlobal=function(t){this.global_=t;this.canWrapX_=!!(t&&this.extent_)};t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_};t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t};t.prototype.setExtent=function(t){this.extent_=t;this.canWrapX_=!!(this.global_&&t)};t.prototype.setWorldExtent=function(t){this.worldExtent_=t};t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t};t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};return t}();var Je=He;var Qe=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var $e=6378137;var tr=Math.PI*$e;var er=[-tr,-tr,tr,tr];var rr=[-180,-85,180,85];var nr=$e*Math.log(Math.tan(Math.PI/2));var ir=function(t){Qe(e,t);function e(e){return t.call(this,{code:e,units:Ve.METERS,extent:er,global:true,worldExtent:rr,getPointResolution:function(t,e){return t/Object(T["c"])(e[1]/$e)}})||this}return e}(Je);var or=[new ir("EPSG:3857"),new ir("EPSG:102100"),new ir("EPSG:102113"),new ir("EPSG:900913"),new ir("http://www.opengis.net/def/crs/EPSG/0/3857"),new ir("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ar(t,e,r){var n=t.length;var i=r>1?r:2;var o=e;if(o===undefined){if(i>2){o=t.slice()}else{o=new Array(n)}}for(var a=0;a<n;a+=i){o[a]=tr*t[a]/180;var s=$e*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));if(s>nr){s=nr}else if(s<-nr){s=-nr}o[a+1]=s}return o}function sr(t,e,r){var n=t.length;var i=r>1?r:2;var o=e;if(o===undefined){if(i>2){o=t.slice()}else{o=new Array(n)}}for(var a=0;a<n;a+=i){o[a]=180*t[a]/tr;o[a+1]=360*Math.atan(Math.exp(t[a+1]/$e))/Math.PI-90}return o}var ur=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var lr=6378137;var hr=[-180,-90,180,90];var cr=Math.PI*lr/180;var fr=function(t){ur(e,t);function e(e,r){return t.call(this,{code:e,units:Ve.DEGREES,extent:hr,axisOrientation:r,global:true,metersPerUnit:cr,worldExtent:hr})||this}return e}(Je);var pr=[new fr("CRS:84"),new fr("EPSG:4326","neu"),new fr("urn:ogc:def:crs:OGC:1.3:CRS84"),new fr("urn:ogc:def:crs:OGC:2:84"),new fr("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new fr("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new fr("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var dr={};function vr(){dr={}}function _r(t){return dr[t]||dr[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function gr(t,e){dr[t]=e}var yr={};function mr(){yr={}}function Er(t,e,r){var n=t.getCode();var i=e.getCode();if(!(n in yr)){yr[n]={}}yr[n][i]=r}function Or(t,e){var r=t.getCode();var n=e.getCode();var i=yr[r][n];delete yr[r][n];if(Object(K["d"])(yr[r])){delete yr[r]}return i}function br(t,e){var r;if(t in yr&&e in yr[t]){r=yr[t][e]}return r}var xr=6371008.8;function wr(t,e,r){var n=r||xr;var i=Object(T["m"])(t[1]);var o=Object(T["m"])(e[1]);var a=(o-i)/2;var s=Object(T["m"])(e[0]-t[0])/2;var u=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function Mr(t,e){var r=0;for(var n=0,i=t.length;n<i-1;++n){r+=wr(t[n],t[n+1],e)}return r}function Sr(t,e){var r=e||{};var n=r.radius||xr;var i=r.projection||"EPSG:3857";var o=t.getType();if(o!==Ue.GEOMETRY_COLLECTION){t=t.clone().transform(i,"EPSG:4326")}var a=0;var s,u,l,h,c,f;switch(o){case Ue.POINT:case Ue.MULTI_POINT:{break}case Ue.LINE_STRING:case Ue.LINEAR_RING:{s=t.getCoordinates();a=Mr(s,n);break}case Ue.MULTI_LINE_STRING:case Ue.POLYGON:{s=t.getCoordinates();for(l=0,h=s.length;l<h;++l){a+=Mr(s[l],n)}break}case Ue.MULTI_POLYGON:{s=t.getCoordinates();for(l=0,h=s.length;l<h;++l){u=s[l];for(c=0,f=u.length;c<f;++c){a+=Mr(u[c],n)}}break}case Ue.GEOMETRY_COLLECTION:{var p=t.getGeometries();for(l=0,h=p.length;l<h;++l){a+=Sr(p[l],e)}break}default:{throw new Error("Unsupported geometry type: "+o)}}return a}function Cr(t,e){var r=0;var n=t.length;var i=t[n-1][0];var o=t[n-1][1];for(var a=0;a<n;a++){var s=t[a][0];var u=t[a][1];r+=Object(T["m"])(s-i)*(2+Math.sin(Object(T["m"])(o))+Math.sin(Object(T["m"])(u)));i=s;o=u}return r*e*e/2}function Rr(t,e){var r=e||{};var n=r.radius||xr;var i=r.projection||"EPSG:3857";var o=t.getType();if(o!==Ue.GEOMETRY_COLLECTION){t=t.clone().transform(i,"EPSG:4326")}var a=0;var s,u,l,h,c,f;switch(o){case Ue.POINT:case Ue.MULTI_POINT:case Ue.LINE_STRING:case Ue.MULTI_LINE_STRING:case Ue.LINEAR_RING:{break}case Ue.POLYGON:{s=t.getCoordinates();a=Math.abs(Cr(s[0],n));for(l=1,h=s.length;l<h;++l){a-=Math.abs(Cr(s[l],n))}break}case Ue.MULTI_POLYGON:{s=t.getCoordinates();for(l=0,h=s.length;l<h;++l){u=s[l];a+=Math.abs(Cr(u[0],n));for(c=1,f=u.length;c<f;++c){a-=Math.abs(Cr(u[c],n))}}break}case Ue.GEOMETRY_COLLECTION:{var p=t.getGeometries();for(l=0,h=p.length;l<h;++l){a+=Rr(p[l],e)}break}default:{throw new Error("Unsupported geometry type: "+o)}}return a}function Tr(t,e,r,n){var i=n||xr;var o=Object(T["m"])(t[1]);var a=Object(T["m"])(t[0]);var s=e/i;var u=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(r));var l=a+Math.atan2(Math.sin(r)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(u));return[Object(T["l"])(l),Object(T["l"])(u)]}function Ir(t,e,r){var n;if(e!==undefined){for(var i=0,o=t.length;i<o;++i){e[i]=t[i]}n=e}else{n=t.slice()}return n}function Pr(t,e,r){if(e!==undefined&&t!==e){for(var n=0,i=t.length;n<i;++n){e[n]=t[n]}t=e}return t}function Lr(t){gr(t.getCode(),t);Er(t,t,Ir)}function Ar(t){t.forEach(Lr)}function jr(t){return typeof t==="string"?_r(t):t||null}function Nr(t,e,r,n){t=jr(t);var i;var o=t.getPointResolutionFunc();if(o){i=o(e,r);if(n&&n!==t.getUnits()){var a=t.getMetersPerUnit();if(a){i=i*a/We[n]}}}else{var s=t.getUnits();if(s==Ve.DEGREES&&!n||n==Ve.DEGREES){i=e}else{var u=Vr(t,jr("EPSG:4326"));if(u===Pr&&s!==Ve.DEGREES){i=e*t.getMetersPerUnit()}else{var l=[r[0]-e/2,r[1],r[0]+e/2,r[1],r[0],r[1]-e/2,r[0],r[1]+e/2];l=u(l,l,2);var h=wr(l.slice(0,2),l.slice(2,4));var c=wr(l.slice(4,6),l.slice(6,8));i=(h+c)/2}var a=n?We[n]:t.getMetersPerUnit();if(a!==undefined){i/=a}}}return i}function Fr(t){Ar(t);t.forEach((function(e){t.forEach((function(t){if(e!==t){Er(e,t,Ir)}}))}))}function Dr(t,e,r,n){t.forEach((function(t){e.forEach((function(e){Er(t,e,r);Er(e,t,n)}))}))}function Gr(){vr();mr()}function kr(t,e){if(!t){return jr(e)}else if(typeof t==="string"){return jr(t)}else{return t}}function Ur(t){return function(e,r,n){var i=e.length;var o=n!==undefined?n:2;var a=r!==undefined?r:new Array(i);for(var s=0;s<i;s+=o){var u=t([e[s],e[s+1]]);a[s]=u[0];a[s+1]=u[1];for(var l=o-1;l>=2;--l){a[s+l]=e[s+l]}}return a}}function Br(t,e,r,n){var i=jr(t);var o=jr(e);Er(i,o,Ur(r));Er(o,i,Ur(n))}function zr(t,e){return qr(t,"EPSG:4326",e!==undefined?e:"EPSG:3857")}function Yr(t,e){var r=qr(t,e!==undefined?e:"EPSG:3857","EPSG:4326");var n=r[0];if(n<-180||n>180){r[0]=Object(T["g"])(n+180,360)-180}return r}function Wr(t,e){if(t===e){return true}var r=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode()){return r}else{var n=Vr(t,e);return n===Ir&&r}}function Vr(t,e){var r=t.getCode();var n=e.getCode();var i=br(r,n);if(!i){i=Pr}return i}function Xr(t,e){var r=jr(t);var n=jr(e);return Vr(r,n)}function qr(t,e,r){var n=Xr(e,r);return n(t,undefined,t.length)}function Zr(t,e,r,n){var i=Xr(e,r);return Object(R["a"])(t,i,undefined,n)}function Kr(t,e,r){var n=Vr(e,r);return n(t)}var Hr=null;function Jr(t){Hr=jr(t)}function Qr(){Hr=null}function $r(){return Hr}function tn(){Jr("EPSG:4326")}function en(t,e){if(!Hr){return t}return qr(t,e,Hr)}function rn(t,e){if(!Hr){return t}return qr(t,Hr,e)}function nn(t,e){if(!Hr){return t}return Zr(t,e,Hr)}function on(t,e){if(!Hr){return t}return Zr(t,Hr,e)}function an(t,e){if(!Hr){return t}var r=jr(e).getUnits();var n=Hr.getUnits();return r&&n?t*We[r]/We[n]:t}function sn(t,e){if(!Hr){return t}var r=jr(e).getUnits();var n=Hr.getUnits();return r&&n?t*We[n]/We[r]:t}function un(t,e,r){return function(n){var i=n[0];var o=n[1];var a,s;if(t.canWrapX()){var u=t.getExtent();var l=Object(R["D"])(u);s=yt(n,t,l);if(s){i=i-s*l}i=Object(T["b"])(i,u[0],u[2]);o=Object(T["b"])(o,u[1],u[3]);a=r([i,o])}else{a=r(n)}if(s&&e.canWrapX()){a[0]+=s*Object(R["D"])(e.getExtent())}return a}}function ln(){Fr(or);Fr(pr);Dr(pr,or,ar,sr)}ln();function hn(t,e,r){return function(n,i,o,a,s){if(n){var u=e?0:o[0]*i;var l=e?0:o[1]*i;var h=s?s[0]:0;var c=s?s[1]:0;var f=t[0]+u/2+h;var p=t[2]-u/2+h;var d=t[1]+l/2+c;var v=t[3]-l/2+c;if(f>p){f=(p+f)/2;p=f}if(d>v){d=(v+d)/2;v=d}var _=Object(T["b"])(n[0],f,p);var g=Object(T["b"])(n[1],d,v);var y=30*i;if(a&&r){_+=-y*Math.log(1+Math.max(0,f-n[0])/y)+y*Math.log(1+Math.max(0,n[0]-p)/y);g+=-y*Math.log(1+Math.max(0,d-n[1])/y)+y*Math.log(1+Math.max(0,n[1]-v)/y)}return[_,g]}else{return undefined}}}function cn(t){return t}var fn=r(5);function pn(t,e,r,n){var i=Object(R["D"])(e)/r[0];var o=Object(R["z"])(e)/r[1];if(n){return Math.min(t,Math.max(i,o))}return Math.min(t,Math.min(i,o))}function dn(t,e,r){var n=Math.min(t,e);var i=50;n*=Math.log(1+i*Math.max(0,t/e-1))/i+1;if(r){n=Math.max(n,r);n/=Math.log(1+i*Math.max(0,r/t-1))/i+1}return Object(T["b"])(n,r/2,e*2)}function vn(t,e,r,n){return function(i,o,a,s){if(i!==undefined){var u=t[0];var l=t[t.length-1];var h=r?pn(u,r,a,n):u;if(s){var c=e!==undefined?e:true;if(!c){return Object(T["b"])(i,l,h)}return dn(i,h,l)}var f=Math.min(h,i);var p=Math.floor(Object(fn["h"])(t,f,o));if(t[p]>h&&p<t.length-1){return t[p+1]}return t[p]}else{return undefined}}}function _n(t,e,r,n,i,o){return function(a,s,u,l){if(a!==undefined){var h=i?pn(e,i,u,o):e;var c=r!==undefined?r:0;if(l){var f=n!==undefined?n:true;if(!f){return Object(T["b"])(a,c,h)}return dn(a,h,c)}var p=1e-9;var d=Math.ceil(Math.log(e/h)/Math.log(t)-p);var v=-s*(.5-p)+.5;var _=Math.min(h,a);var g=Math.floor(Math.log(e/_)/Math.log(t)+v);var y=Math.max(d,g);var m=e/Math.pow(t,y);return Object(T["b"])(m,c,h)}else{return undefined}}}function gn(t,e,r,n,i){return function(o,a,s,u){if(o!==undefined){var l=n?pn(t,n,s,i):t;var h=r!==undefined?r:true;if(!h||!u){return Object(T["b"])(o,e,l)}return dn(o,l,e)}else{return undefined}}}function yn(t){if(t!==undefined){return 0}else{return undefined}}function mn(t){if(t!==undefined){return t}else{return undefined}}function En(t){var e=2*Math.PI/t;return function(t,r){if(r){return t}if(t!==undefined){t=Math.floor(t/e+.5)*e;return t}else{return undefined}}}function On(t){var e=t||Object(T["m"])(5);return function(t,r){if(r){return t}if(t!==undefined){if(Math.abs(t)<=e){return 0}else{return t}}else{return undefined}}}function bn(t){return Math.pow(t,3)}function xn(t){return 1-bn(1-t)}function wn(t){return 3*t*t-2*t*t*t}function Mn(t){return t}function Sn(t){if(t<.5){return wn(2*t)}else{return 1-wn(2*(t-.5))}}var Cn={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function Rn(t,e,r,n,i,o){var a=o?o:[];var s=0;for(var u=e;u<r;u+=n){var l=t[u];var h=t[u+1];a[s++]=i[0]*l+i[2]*h+i[4];a[s++]=i[1]*l+i[3]*h+i[5]}if(o&&a.length!=s){a.length=s}return a}function Tn(t,e,r,n,i,o,a){var s=a?a:[];var u=Math.cos(i);var l=Math.sin(i);var h=o[0];var c=o[1];var f=0;for(var p=e;p<r;p+=n){var d=t[p]-h;var v=t[p+1]-c;s[f++]=h+d*u-v*l;s[f++]=c+d*l+v*u;for(var _=p+2;_<p+n;++_){s[f++]=t[_]}}if(a&&s.length!=f){s.length=f}return s}function In(t,e,r,n,i,o,a,s){var u=s?s:[];var l=a[0];var h=a[1];var c=0;for(var f=e;f<r;f+=n){var p=t[f]-l;var d=t[f+1]-h;u[c++]=l+i*p;u[c++]=h+o*d;for(var v=f+2;v<f+n;++v){u[c++]=t[v]}}if(s&&u.length!=c){u.length=c}return u}function Pn(t,e,r,n,i,o,a){var s=a?a:[];var u=0;for(var l=e;l<r;l+=n){s[u++]=t[l]+i;s[u++]=t[l+1]+o;for(var h=l+2;h<l+n;++h){s[u++]=t[h]}}if(a&&s.length!=u){s.length=u}return s}var Ln=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var An=c();var jn=function(t){Ln(e,t);function e(){var e=t.call(this)||this;e.extent_=Object(R["j"])();e.extentRevision_=-1;e.simplifiedGeometryMaxMinSquaredTolerance=0;e.simplifiedGeometryRevision=0;e.simplifyTransformedInternal=Object(a["d"])((function(t,e,r){if(!r){return this.getSimplifiedGeometry(e)}var n=this.clone();n.applyTransform(r);return n.getSimplifiedGeometry(e)}));return e}e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)};e.prototype.clone=function(){return Object(s["b"])()};e.prototype.closestPointXY=function(t,e,r,n){return Object(s["b"])()};e.prototype.containsXY=function(t,e){var r=this.getClosestPoint([t,e]);return r[0]===t&&r[1]===e};e.prototype.getClosestPoint=function(t,e){var r=e?e:[NaN,NaN];this.closestPointXY(t[0],t[1],r,Infinity);return r};e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])};e.prototype.computeExtent=function(t){return Object(s["b"])()};e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);if(isNaN(e[0])||isNaN(e[1])){Object(R["l"])(e)}this.extentRevision_=this.getRevision()}return Object(R["H"])(this.extent_,t)};e.prototype.rotate=function(t,e){Object(s["b"])()};e.prototype.scale=function(t,e,r){Object(s["b"])()};e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)};e.prototype.getSimplifiedGeometry=function(t){return Object(s["b"])()};e.prototype.getType=function(){return Object(s["b"])()};e.prototype.applyTransform=function(t){Object(s["b"])()};e.prototype.intersectsExtent=function(t){return Object(s["b"])()};e.prototype.translate=function(t,e){Object(s["b"])()};e.prototype.transform=function(t,e){var r=jr(t);var n=r.getUnits()==Ve.TILE_PIXELS?function(t,n,i){var o=r.getExtent();var a=r.getWorldExtent();var s=Object(R["z"])(a)/Object(R["z"])(o);O(An,a[0],a[3],s,-s,0,0,0);Rn(t,0,t.length,i,An,n);return Xr(r,e)(t,n,i)}:Xr(r,e);this.applyTransform(n);return this};return e}(Gt["a"]);var Nn=jn;var Fn=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Dn=function(t){Fn(e,t);function e(){var e=t.call(this)||this;e.layout=Cn.XY;e.stride=2;e.flatCoordinates=null;return e}e.prototype.computeExtent=function(t){return Object(R["n"])(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)};e.prototype.getCoordinates=function(){return Object(s["b"])()};e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)};e.prototype.getFlatCoordinates=function(){return this.flatCoordinates};e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)};e.prototype.getLayout=function(){return this.layout};e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()){this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=this.getRevision()}if(t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance){return this}var e=this.getSimplifiedGeometryInternal(t);var r=e.getFlatCoordinates();if(r.length<this.flatCoordinates.length){return e}else{this.simplifiedGeometryMaxMinSquaredTolerance=t;return this}};e.prototype.getSimplifiedGeometryInternal=function(t){return this};e.prototype.getStride=function(){return this.stride};e.prototype.setFlatCoordinates=function(t,e){this.stride=kn(t);this.layout=t;this.flatCoordinates=e};e.prototype.setCoordinates=function(t,e){Object(s["b"])()};e.prototype.setLayout=function(t,e,r){var n;if(t){n=kn(t)}else{for(var i=0;i<r;++i){if(e.length===0){this.layout=Cn.XY;this.stride=2;return}else{e=e[0]}}n=e.length;t=Gn(n)}this.layout=t;this.stride=n};e.prototype.applyTransform=function(t){if(this.flatCoordinates){t(this.flatCoordinates,this.flatCoordinates,this.stride);this.changed()}};e.prototype.rotate=function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();Tn(r,0,r.length,n,t,e,r);this.changed()}};e.prototype.scale=function(t,e,r){var n=e;if(n===undefined){n=t}var i=r;if(!i){i=Object(R["w"])(this.getExtent())}var o=this.getFlatCoordinates();if(o){var a=this.getStride();In(o,0,o.length,a,t,n,i,o);this.changed()}};e.prototype.translate=function(t,e){var r=this.getFlatCoordinates();if(r){var n=this.getStride();Pn(r,0,r.length,n,t,e,r);this.changed()}};return e}(Nn);function Gn(t){var e;if(t==2){e=Cn.XY}else if(t==3){e=Cn.XYZ}else if(t==4){e=Cn.XYZM}return e}function kn(t){var e;if(t==Cn.XY){e=2}else if(t==Cn.XYZ||t==Cn.XYM){e=3}else if(t==Cn.XYZM){e=4}return e}function Un(t,e,r){var n=t.getFlatCoordinates();if(!n){return null}else{var i=t.getStride();return Rn(n,0,n.length,i,e,r)}}var Bn=Dn;function zn(t,e,r,n,i,o,a){var s=t[e];var u=t[e+1];var l=t[r]-s;var h=t[r+1]-u;var c;if(l===0&&h===0){c=e}else{var f=((i-s)*l+(o-u)*h)/(l*l+h*h);if(f>1){c=r}else if(f>0){for(var p=0;p<n;++p){a[p]=Object(T["e"])(t[e+p],t[r+p],f)}a.length=n;return}else{c=e}}for(var p=0;p<n;++p){a[p]=t[c+p]}a.length=n}function Yn(t,e,r,n,i){var o=t[e];var a=t[e+1];for(e+=n;e<r;e+=n){var s=t[e];var u=t[e+1];var l=Object(T["j"])(o,a,s,u);if(l>i){i=l}o=s;a=u}return i}function Wn(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=Yn(t,e,s,n,i);e=s}return i}function Vn(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];i=Wn(t,e,s,n,i);e=s[s.length-1]}return i}function Xn(t,e,r,n,i,o,a,s,u,l,h){if(e==r){return l}var c,f;if(i===0){f=Object(T["j"])(a,s,t[e],t[e+1]);if(f<l){for(c=0;c<n;++c){u[c]=t[e+c]}u.length=n;return f}else{return l}}var p=h?h:[NaN,NaN];var d=e+n;while(d<r){zn(t,d-n,d,n,a,s,p);f=Object(T["j"])(a,s,p[0],p[1]);if(f<l){l=f;for(c=0;c<n;++c){u[c]=p[c]}u.length=n;d+=n}else{d+=n*Math.max((Math.sqrt(f)-Math.sqrt(l))/i|0,1)}}if(o){zn(t,r-n,e,n,a,s,p);f=Object(T["j"])(a,s,p[0],p[1]);if(f<l){l=f;for(c=0;c<n;++c){u[c]=p[c]}u.length=n}}return l}function qn(t,e,r,n,i,o,a,s,u,l,h){var c=h?h:[NaN,NaN];for(var f=0,p=r.length;f<p;++f){var d=r[f];l=Xn(t,e,d,n,i,o,a,s,u,l,c);e=d}return l}function Zn(t,e,r,n,i,o,a,s,u,l,h){var c=h?h:[NaN,NaN];for(var f=0,p=r.length;f<p;++f){var d=r[f];l=qn(t,e,d,n,i,o,a,s,u,l,c);e=d[d.length-1]}return l}function Kn(t,e,r,n){for(var i=0,o=r.length;i<o;++i){t[e++]=r[i]}return e}function Hn(t,e,r,n){for(var i=0,o=r.length;i<o;++i){var a=r[i];for(var s=0;s<n;++s){t[e++]=a[s]}}return e}function Jn(t,e,r,n,i){var o=i?i:[];var a=0;for(var s=0,u=r.length;s<u;++s){var l=Hn(t,e,r[s],n);o[a++]=l;e=l}o.length=a;return o}function Qn(t,e,r,n,i){var o=i?i:[];var a=0;for(var s=0,u=r.length;s<u;++s){var l=Jn(t,e,r[s],n,o[a]);o[a++]=l;e=l[l.length-1]}o.length=a;return o}function $n(t,e,r,n,i,o,a){var s=a!==undefined?a:[];if(!o){r=ni(t,e,r,n,i,s,0);t=s;e=0;n=2}s.length=ti(t,e,r,n,i,s,0);return s}function ti(t,e,r,n,i,o,a){var s=(r-e)/n;if(s<3){for(;e<r;e+=n){o[a++]=t[e];o[a++]=t[e+1]}return a}var u=new Array(s);u[0]=1;u[s-1]=1;var l=[e,r-n];var h=0;while(l.length>0){var c=l.pop();var f=l.pop();var p=0;var d=t[f];var v=t[f+1];var _=t[c];var g=t[c+1];for(var y=f+n;y<c;y+=n){var m=t[y];var E=t[y+1];var O=Object(T["k"])(m,E,d,v,_,g);if(O>p){h=y;p=O}}if(p>i){u[(h-e)/n]=1;if(f+n<h){l.push(f,h)}if(h+n<c){l.push(h,c)}}}for(var y=0;y<s;++y){if(u[y]){o[a++]=t[e+y*n];o[a++]=t[e+y*n+1]}}return a}function ei(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var h=r[u];a=ti(t,e,h,n,i,o,a);s.push(a);e=h}return a}function ri(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var h=r[u];var c=[];a=ei(t,e,h,n,i,o,a,c);s.push(c);e=h[h.length-1]}return a}function ni(t,e,r,n,i,o,a){if(r<=e+n){for(;e<r;e+=n){o[a++]=t[e];o[a++]=t[e+1]}return a}var s=t[e];var u=t[e+1];o[a++]=s;o[a++]=u;var l=s;var h=u;for(e+=n;e<r;e+=n){l=t[e];h=t[e+1];if(Object(T["j"])(s,u,l,h)>i){o[a++]=l;o[a++]=h;s=l;u=h}}if(l!=s||h!=u){o[a++]=l;o[a++]=h}return a}function ii(t,e){return e*Math.round(t/e)}function oi(t,e,r,n,i,o,a){if(e==r){return a}var s=ii(t[e],i);var u=ii(t[e+1],i);e+=n;o[a++]=s;o[a++]=u;var l,h;do{l=ii(t[e],i);h=ii(t[e+1],i);e+=n;if(e==r){o[a++]=l;o[a++]=h;return a}}while(l==s&&h==u);while(e<r){var c=ii(t[e],i);var f=ii(t[e+1],i);e+=n;if(c==l&&f==h){continue}var p=l-s;var d=h-u;var v=c-s;var _=f-u;if(p*_==d*v&&(p<0&&v<p||p==v||p>0&&v>p)&&(d<0&&_<d||d==_||d>0&&_>d)){l=c;h=f;continue}o[a++]=l;o[a++]=h;s=l;u=h;l=c;h=f}o[a++]=l;o[a++]=h;return a}function ai(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var h=r[u];a=oi(t,e,h,n,i,o,a);s.push(a);e=h}return a}function si(t,e,r,n,i,o,a,s){for(var u=0,l=r.length;u<l;++u){var h=r[u];var c=[];a=ai(t,e,h,n,i,o,a,c);s.push(c);e=h[h.length-1]}return a}function ui(t,e,r,n,i){var o=i!==undefined?i:[];var a=0;for(var s=e;s<r;s+=n){o[a++]=t.slice(s,s+n)}o.length=a;return o}function li(t,e,r,n,i){var o=i!==undefined?i:[];var a=0;for(var s=0,u=r.length;s<u;++s){var l=r[s];o[a++]=ui(t,e,l,n,o[a]);e=l}o.length=a;return o}function hi(t,e,r,n,i){var o=i!==undefined?i:[];var a=0;for(var s=0,u=r.length;s<u;++s){var l=r[s];o[a++]=li(t,e,l,n,o[a]);e=l[l.length-1]}o.length=a;return o}function ci(t,e,r,n){var i=0;var o=t[r-n];var a=t[r-n+1];for(;e<r;e+=n){var s=t[e];var u=t[e+1];i+=a*s-o*u;o=s;a=u}return i/2}function fi(t,e,r,n){var i=0;for(var o=0,a=r.length;o<a;++o){var s=r[o];i+=ci(t,e,s,n);e=s}return i}function pi(t,e,r,n){var i=0;for(var o=0,a=r.length;o<a;++o){var s=r[o];i+=fi(t,e,s,n);e=s[s.length-1]}return i}var di=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var vi=function(t){di(e,t);function e(e,r){var n=t.call(this)||this;n.maxDelta_=-1;n.maxDeltaRevision_=-1;if(r!==undefined&&!Array.isArray(e[0])){n.setFlatCoordinates(r,e)}else{n.setCoordinates(e,r)}return n}e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,true,t,e,r,n)};e.prototype.getArea=function(){return ci(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getCoordinates=function(){return ui(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];r.length=ti(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0);return new e(r,Cn.XY)};e.prototype.getType=function(){return Ue.LINEAR_RING};e.prototype.intersectsExtent=function(t){return false};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Hn(this.flatCoordinates,0,t,this.stride);this.changed()};return e}(Bn);var _i=vi;var gi=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var yi=function(t){gi(e,t);function e(e,r){var n=t.call(this)||this;n.setCoordinates(e,r);return n}e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){var i=this.flatCoordinates;var o=Object(T["j"])(t,e,i[0],i[1]);if(o<n){var a=this.stride;for(var s=0;s<a;++s){r[s]=i[s]}r.length=a;return o}else{return n}};e.prototype.getCoordinates=function(){return!this.flatCoordinates?[]:this.flatCoordinates.slice()};e.prototype.computeExtent=function(t){return Object(R["m"])(this.flatCoordinates,t)};e.prototype.getType=function(){return Ue.POINT};e.prototype.intersectsExtent=function(t){return Object(R["h"])(t,this.flatCoordinates[0],this.flatCoordinates[1])};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Kn(this.flatCoordinates,0,t,this.stride);this.changed()};return e}(Bn);var mi=yi;function Ei(t,e,r,n,i){var o=Object(R["s"])(i,(function(i){return!Oi(t,e,r,n,i[0],i[1])}));return!o}function Oi(t,e,r,n,i,o){var a=0;var s=t[r-n];var u=t[r-n+1];for(;e<r;e+=n){var l=t[e];var h=t[e+1];if(u<=o){if(h>o&&(l-s)*(o-u)-(i-s)*(h-u)>0){a++}}else if(h<=o&&(l-s)*(o-u)-(i-s)*(h-u)<0){a--}s=l;u=h}return a!==0}function bi(t,e,r,n,i,o){if(r.length===0){return false}if(!Oi(t,e,r[0],n,i,o)){return false}for(var a=1,s=r.length;a<s;++a){if(Oi(t,r[a-1],r[a],n,i,o)){return false}}return true}function xi(t,e,r,n,i,o){if(r.length===0){return false}for(var a=0,s=r.length;a<s;++a){var u=r[a];if(bi(t,e,u,n,i,o)){return true}e=u[u.length-1]}return false}function wi(t,e,r,n,i,o,a){var s,u,l,h,c,f,p;var d=i[o+1];var v=[];for(var _=0,g=r.length;_<g;++_){var y=r[_];h=t[y-n];f=t[y-n+1];for(s=e;s<y;s+=n){c=t[s];p=t[s+1];if(d<=f&&p<=d||f<=d&&d<=p){l=(d-f)/(p-f)*(c-h)+h;v.push(l)}h=c;f=p}}var m=NaN;var E=-Infinity;v.sort(fn["i"]);h=v[0];for(s=1,u=v.length;s<u;++s){c=v[s];var O=Math.abs(c-h);if(O>E){l=(h+c)/2;if(bi(t,e,r,n,l,d)){m=l;E=O}}h=c}if(isNaN(m)){m=i[o]}if(a){a.push(m,d,E);return a}else{return[m,d,E]}}function Mi(t,e,r,n,i){var o=[];for(var a=0,s=r.length;a<s;++a){var u=r[a];o=wi(t,e,u,n,i,2*a,o);e=u[u.length-1]}return o}function Si(t,e,r,n,i){var o;e+=n;for(;e<r;e+=n){o=i(t.slice(e-n,e),t.slice(e,e+n));if(o){return o}}return false}function Ci(t,e,r,n,i){var o=Object(R["r"])(Object(R["j"])(),t,e,r,n);if(!Object(R["E"])(i,o)){return false}if(Object(R["g"])(i,o)){return true}if(o[0]>=i[0]&&o[2]<=i[2]){return true}if(o[1]>=i[1]&&o[3]<=i[3]){return true}return Si(t,e,r,n,(function(t,e){return Object(R["F"])(i,t,e)}))}function Ri(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){if(Ci(t,e,r[o],n,i)){return true}e=r[o]}return false}function Ti(t,e,r,n,i){if(Ci(t,e,r,n,i)){return true}if(Oi(t,e,r,n,i[0],i[1])){return true}if(Oi(t,e,r,n,i[0],i[3])){return true}if(Oi(t,e,r,n,i[2],i[1])){return true}if(Oi(t,e,r,n,i[2],i[3])){return true}return false}function Ii(t,e,r,n,i){if(!Ti(t,e,r[0],n,i)){return false}if(r.length===1){return true}for(var o=1,a=r.length;o<a;++o){if(Ei(t,r[o-1],r[o],n,i)){if(!Ci(t,r[o-1],r[o],n,i)){return false}}}return true}function Pi(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(Ii(t,e,s,n,i)){return true}e=s[s.length-1]}return false}function Li(t,e,r,n){while(e<r-n){for(var i=0;i<n;++i){var o=t[e+i];t[e+i]=t[r-n+i];t[r-n+i]=o}e+=n;r-=n}}function Ai(t,e,r,n){var i=0;var o=t[r-n];var a=t[r-n+1];for(;e<r;e+=n){var s=t[e];var u=t[e+1];i+=(s-o)*(u+a);o=s;a=u}return i===0?undefined:i>0}function ji(t,e,r,n,i){var o=i!==undefined?i:false;for(var a=0,s=r.length;a<s;++a){var u=r[a];var l=Ai(t,e,u,n);if(a===0){if(o&&l||!o&&!l){return false}}else{if(o&&!l||!o&&l){return false}}e=u}return true}function Ni(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];if(!ji(t,e,s,n,i)){return false}if(s.length){e=s[s.length-1]}}return true}function Fi(t,e,r,n,i){var o=i!==undefined?i:false;for(var a=0,s=r.length;a<s;++a){var u=r[a];var l=Ai(t,e,u,n);var h=a===0?o&&l||!o&&!l:o&&!l||!o&&l;if(h){Li(t,e,u,n)}e=u}return e}function Di(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){e=Fi(t,e,r[o],n,i)}return e}var Gi=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ki=function(t){Gi(e,t);function e(e,r,n){var i=t.call(this)||this;i.ends_=[];i.flatInteriorPointRevision_=-1;i.flatInteriorPoint_=null;i.maxDelta_=-1;i.maxDeltaRevision_=-1;i.orientedRevision_=-1;i.orientedFlatCoordinates_=null;if(r!==undefined&&n){i.setFlatCoordinates(r,e);i.ends_=n}else{i.setCoordinates(e,r)}return i}e.prototype.appendLinearRing=function(t){if(!this.flatCoordinates){this.flatCoordinates=t.getFlatCoordinates().slice()}else{Object(fn["c"])(this.flatCoordinates,t.getFlatCoordinates())}this.ends_.push(this.flatCoordinates.length);this.changed()};e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Wn(this.flatCoordinates,0,this.ends_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return qn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,true,t,e,r,n)};e.prototype.containsXY=function(t,e){return bi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)};e.prototype.getArea=function(){return fi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)};e.prototype.getCoordinates=function(t){var e;if(t!==undefined){e=this.getOrientedFlatCoordinates().slice();Fi(e,0,this.ends_,this.stride,t)}else{e=this.flatCoordinates}return li(e,0,this.ends_,this.stride)};e.prototype.getEnds=function(){return this.ends_};e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Object(R["w"])(this.getExtent());this.flatInteriorPoint_=wi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_};e.prototype.getInteriorPoint=function(){return new mi(this.getFlatInteriorPoint(),Cn.XYM)};e.prototype.getLinearRingCount=function(){return this.ends_.length};e.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t){return null}return new _i(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)};e.prototype.getLinearRings=function(){var t=this.layout;var e=this.flatCoordinates;var r=this.ends_;var n=[];var i=0;for(var o=0,a=r.length;o<a;++o){var s=r[o];var u=new _i(e.slice(i,s),t);n.push(u);i=s}return n};e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;if(ji(t,0,this.ends_,this.stride)){this.orientedFlatCoordinates_=t}else{this.orientedFlatCoordinates_=t.slice();this.orientedFlatCoordinates_.length=Fi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)}this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];var n=[];r.length=ai(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,n);return new e(r,Cn.XY,n)};e.prototype.getType=function(){return Ue.POLYGON};e.prototype.intersectsExtent=function(t){return Ii(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2);if(!this.flatCoordinates){this.flatCoordinates=[]}var r=Jn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1];this.changed()};return e}(Bn);var Ui=ki;function Bi(t,e,r,n){var i=r?r:32;var o=[];for(var a=0;a<i;++a){Object(fn["c"])(o,Tr(t,e,2*Math.PI*a/i,n))}o.push(o[0],o[1]);return new ki(o,Cn.XY,[o.length])}function zi(t){var e=t[0];var r=t[1];var n=t[2];var i=t[3];var o=[e,r,e,i,n,i,n,r,e,r];return new ki(o,Cn.XY,[o.length])}function Yi(t,e,r){var n=e?e:32;var i=t.getStride();var o=t.getLayout();var a=t.getCenter();var s=i*(n+1);var u=new Array(s);for(var l=0;l<s;l+=i){u[l]=0;u[l+1]=0;for(var h=2;h<i;h++){u[l+h]=a[h]}}var c=[u.length];var f=new ki(u,o,c);Wi(f,a,t.getRadius(),r);return f}function Wi(t,e,r,n){var i=t.getFlatCoordinates();var o=t.getStride();var a=i.length/o-1;var s=n?n:0;for(var u=0;u<=a;++u){var l=u*o;var h=s+Object(T["g"])(u,a)*2*Math.PI/a;i[l]=e[0]+r*Math.cos(h);i[l+1]=e[1]+r*Math.sin(h)}t.changed()}var Vi=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Xi=0;var qi=function(t){Vi(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;var n=Object(K["a"])({},e);r.hints_=[0,0];r.animations_=[];r.updateAnimationKey_;r.projection_=kr(n.projection,"EPSG:3857");r.viewportSize_=[100,100];r.targetCenter_=null;r.targetResolution_;r.targetRotation_;r.nextCenter_=null;r.nextResolution_;r.nextRotation_;r.cancelAnchor_=undefined;if(n.center){n.center=rn(n.center,r.projection_)}if(n.extent){n.extent=on(n.extent,r.projection_)}r.applyOptions_(n);return r}e.prototype.applyOptions_=function(t){var e=Object(K["a"])({},t);for(var r in qe){delete e[r]}this.setProperties(e,true);var n=Hi(t);this.maxResolution_=n.maxResolution;this.minResolution_=n.minResolution;this.zoomFactor_=n.zoomFactor;this.resolutions_=t.resolutions;this.padding_=t.padding;this.minZoom_=n.minZoom;var i=Ki(t);var o=n.constraint;var a=Ji(t);this.constraints_={center:i,resolution:o,rotation:a};this.setRotation(t.rotation!==undefined?t.rotation:0);this.setCenterInternal(t.center!==undefined?t.center:null);if(t.resolution!==undefined){this.setResolution(t.resolution)}else if(t.zoom!==undefined){this.setZoom(t.zoom)}};Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var r=this.getCenter();if(r){var n=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution();var o=i/2*(n[3]-e[3]+e[1]-n[1]);var a=i/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([r[0]+o,r[1]-a])}},enumerable:false,configurable:true});e.prototype.getUpdatedOptions_=function(t){var e=this.getProperties();if(e.resolution!==undefined){e.resolution=this.getResolution()}else{e.zoom=this.getZoom()}e.center=this.getCenterInternal();e.rotation=this.getRotation();return Object(K["a"])({},e,t)};e.prototype.animate=function(t){if(this.isDef()&&!this.getAnimating()){this.resolveConstraints(0)}var e=new Array(arguments.length);for(var r=0;r<e.length;++r){var n=arguments[r];if(n.center){n=Object(K["a"])({},n);n.center=rn(n.center,this.getProjection())}if(n.anchor){n=Object(K["a"])({},n);n.anchor=rn(n.anchor,this.getProjection())}e[r]=n}this.animateInternal.apply(this,e)};e.prototype.animateInternal=function(t){var e=arguments.length;var r;if(e>1&&typeof arguments[e-1]==="function"){r=arguments[e-1];--e}var n=0;for(;n<e&&!this.isDef();++n){var i=arguments[n];if(i.center){this.setCenterInternal(i.center)}if(i.zoom!==undefined){this.setZoom(i.zoom)}else if(i.resolution){this.setResolution(i.resolution)}if(i.rotation!==undefined){this.setRotation(i.rotation)}}if(n===e){if(r){Zi(r,true)}return}var o=Date.now();var a=this.targetCenter_.slice();var s=this.targetResolution_;var u=this.targetRotation_;var l=[];for(;n<e;++n){var h=arguments[n];var c={start:o,complete:false,anchor:h.anchor,duration:h.duration!==undefined?h.duration:1e3,easing:h.easing||wn,callback:r};if(h.center){c.sourceCenter=a;c.targetCenter=h.center.slice();a=c.targetCenter}if(h.zoom!==undefined){c.sourceResolution=s;c.targetResolution=this.getResolutionForZoom(h.zoom);s=c.targetResolution}else if(h.resolution){c.sourceResolution=s;c.targetResolution=h.resolution;s=c.targetResolution}if(h.rotation!==undefined){c.sourceRotation=u;var f=Object(T["g"])(h.rotation-u+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=u+f;u=c.targetRotation}if(Qi(c)){c.complete=true}else{o+=c.duration}l.push(c)}this.animations_.push(l);this.setHint(Xe.ANIMATING,1);this.updateAnimations_()};e.prototype.getAnimating=function(){return this.hints_[Xe.ANIMATING]>0};e.prototype.getInteracting=function(){return this.hints_[Xe.INTERACTING]>0};e.prototype.cancelAnimations=function(){this.setHint(Xe.ANIMATING,-this.hints_[Xe.ANIMATING]);var t;for(var e=0,r=this.animations_.length;e<r;++e){var n=this.animations_[e];if(n[0].callback){Zi(n[0].callback,false)}if(!t){for(var i=0,o=n.length;i<o;++i){var a=n[i];if(!a.complete){t=a.anchor;break}}}}this.animations_.length=0;this.cancelAnchor_=t;this.nextCenter_=null;this.nextResolution_=NaN;this.nextRotation_=NaN};e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==undefined){cancelAnimationFrame(this.updateAnimationKey_);this.updateAnimationKey_=undefined}if(!this.getAnimating()){return}var t=Date.now();var e=false;for(var r=this.animations_.length-1;r>=0;--r){var n=this.animations_[r];var i=true;for(var o=0,a=n.length;o<a;++o){var s=n[o];if(s.complete){continue}var u=t-s.start;var l=s.duration>0?u/s.duration:1;if(l>=1){s.complete=true;l=1}else{i=false}var h=s.easing(l);if(s.sourceCenter){var c=s.sourceCenter[0];var f=s.sourceCenter[1];var p=s.targetCenter[0];var d=s.targetCenter[1];this.nextCenter_=s.targetCenter;var v=c+h*(p-c);var _=f+h*(d-f);this.targetCenter_=[v,_]}if(s.sourceResolution&&s.targetResolution){var g=h===1?s.targetResolution:s.sourceResolution+h*(s.targetResolution-s.sourceResolution);if(s.anchor){var y=this.getViewportSize_(this.getRotation());var m=this.constraints_.resolution(g,0,y,true);this.targetCenter_=this.calculateCenterZoom(m,s.anchor)}this.nextResolution_=s.targetResolution;this.targetResolution_=g;this.applyTargetState_(true)}if(s.sourceRotation!==undefined&&s.targetRotation!==undefined){var E=h===1?Object(T["g"])(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+h*(s.targetRotation-s.sourceRotation);if(s.anchor){var O=this.constraints_.rotation(E,true);this.targetCenter_=this.calculateCenterRotate(O,s.anchor)}this.nextRotation_=s.targetRotation;this.targetRotation_=E}this.applyTargetState_(true);e=true;if(!s.complete){break}}if(i){this.animations_[r]=null;this.setHint(Xe.ANIMATING,-1);this.nextCenter_=null;this.nextResolution_=NaN;this.nextRotation_=NaN;var b=n[0].callback;if(b){Zi(b,true)}}}this.animations_=this.animations_.filter(Boolean);if(e&&this.updateAnimationKey_===undefined){this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this))}};e.prototype.calculateCenterRotate=function(t,e){var r;var n=this.getCenterInternal();if(n!==undefined){r=[n[0]-e[0],n[1]-e[1]];ht(r,t-this.getRotation());nt(r,e)}return r};e.prototype.calculateCenterZoom=function(t,e){var r;var n=this.getCenterInternal();var i=this.getResolution();if(n!==undefined&&i!==undefined){var o=e[0]-t*(e[0]-n[0])/i;var a=e[1]-t*(e[1]-n[1])/i;r=[o,a]}return r};e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var r=e[0];var n=e[1];return[Math.abs(r*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(n*Math.cos(t))]}else{return e}};e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100];if(!this.getAnimating()){this.resolveConstraints(0)}};e.prototype.getCenter=function(){var t=this.getCenterInternal();if(!t){return t}return en(t,this.getProjection())};e.prototype.getCenterInternal=function(){return this.get(qe.CENTER)};e.prototype.getConstraints=function(){return this.constraints_};e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")};e.prototype.getHints=function(t){if(t!==undefined){t[0]=this.hints_[0];t[1]=this.hints_[1];return t}else{return this.hints_.slice()}};e.prototype.calculateExtent=function(t){var e=this.calculateExtentInternal(t);return nn(e,this.getProjection())};e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSizeMinusPadding_();var r=this.getCenterInternal();Object(l["a"])(r,1);var n=this.getResolution();Object(l["a"])(n!==undefined,2);var i=this.getRotation();Object(l["a"])(i!==undefined,3);return Object(R["y"])(r,n,i,e)};e.prototype.getMaxResolution=function(){return this.maxResolution_};e.prototype.getMinResolution=function(){return this.minResolution_};e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)};e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))};e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)};e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))};e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))};e.prototype.getProjection=function(){return this.projection_};e.prototype.getResolution=function(){return this.get(qe.RESOLUTION)};e.prototype.getResolutions=function(){return this.resolutions_};e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(on(t,this.getProjection()),e)};e.prototype.getResolutionForExtentInternal=function(t,e){var r=e||this.getViewportSizeMinusPadding_();var n=Object(R["D"])(t)/r[0];var i=Object(R["z"])(t)/r[1];return Math.max(n,i)};e.prototype.getResolutionForValueFunction=function(t){var e=t||2;var r=this.getConstrainedResolution(this.maxResolution_);var n=this.minResolution_;var i=Math.log(r/n)/Math.log(e);return function(t){var n=r/Math.pow(e,t*i);return n}};e.prototype.getRotation=function(){return this.get(qe.ROTATION)};e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2);var r=this.getConstrainedResolution(this.maxResolution_);var n=this.minResolution_;var i=Math.log(r/n)/e;return function(t){var n=Math.log(r/t)/e/i;return n}};e.prototype.getViewportSizeMinusPadding_=function(t){var e=this.getViewportSize_(t);var r=this.padding_;if(r){e=[e[0]-r[1]-r[3],e[1]-r[0]-r[2]]}return e};e.prototype.getState=function(){var t=this.getProjection();var e=this.getResolution();var r=this.getRotation();var n=this.getCenterInternal();var i=this.padding_;if(i){var o=this.getViewportSizeMinusPadding_();n=$i(n,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,r)}return{center:n.slice(0),projection:t!==undefined?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}};e.prototype.getZoom=function(){var t;var e=this.getResolution();if(e!==undefined){t=this.getZoomForResolution(e)}return t};e.prototype.getZoomForResolution=function(t){var e=this.minZoom_||0;var r,n;if(this.resolutions_){var i=Object(fn["h"])(this.resolutions_,t,1);e=i;r=this.resolutions_[i];if(i==this.resolutions_.length-1){n=2}else{n=r/this.resolutions_[i+1]}}else{r=this.maxResolution_;n=this.zoomFactor_}return e+Math.log(r/t)/Math.log(n)};e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1){return 0}var e=Object(T["b"])(Math.floor(t),0,this.resolutions_.length-2);var r=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(r,Object(T["b"])(t-e,0,1))}else{return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}};e.prototype.fit=function(t,e){var r;Object(l["a"])(Array.isArray(t)||typeof t.getSimplifiedGeometry==="function",24);if(Array.isArray(t)){Object(l["a"])(!Object(R["G"])(t),25);var n=on(t,this.getProjection());r=zi(n)}else if(t.getType()===Ue.CIRCLE){var n=on(t.getExtent(),this.getProjection());r=zi(n);r.rotate(this.getRotation(),Object(R["w"])(n))}else{var i=$r();if(i){r=t.clone().transform(i,this.getProjection())}else{r=t}}this.fitInternal(r,e)};e.prototype.rotatedExtentForGeometry=function(t){var e=this.getRotation();var r=Math.cos(e);var n=Math.sin(-e);var i=t.getFlatCoordinates();var o=t.getStride();var a=+Infinity;var s=+Infinity;var u=-Infinity;var l=-Infinity;for(var h=0,c=i.length;h<c;h+=o){var f=i[h]*r-i[h+1]*n;var p=i[h]*n+i[h+1]*r;a=Math.min(a,f);s=Math.min(s,p);u=Math.max(u,f);l=Math.max(l,p)}return[a,s,u,l]};e.prototype.fitInternal=function(t,e){var r=e||{};var n=r.size;if(!n){n=this.getViewportSizeMinusPadding_()}var i=r.padding!==undefined?r.padding:[0,0,0,0];var o=r.nearest!==undefined?r.nearest:false;var s;if(r.minResolution!==undefined){s=r.minResolution}else if(r.maxZoom!==undefined){s=this.getResolutionForZoom(r.maxZoom)}else{s=0}var u=this.rotatedExtentForGeometry(t);var l=this.getResolutionForExtentInternal(u,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);l=isNaN(l)?s:Math.max(l,s);l=this.getConstrainedResolution(l,o?0:1);var h=this.getRotation();var c=Math.sin(h);var f=Math.cos(h);var p=Object(R["w"])(u);p[0]+=(i[1]-i[3])/2*l;p[1]+=(i[0]-i[2])/2*l;var d=p[0]*f-p[1]*c;var v=p[1]*f+p[0]*c;var _=this.getConstrainedCenter([d,v],l);var g=r.callback?r.callback:a["c"];if(r.duration!==undefined){this.animateInternal({resolution:l,center:_,duration:r.duration,easing:r.easing},g)}else{this.targetResolution_=l;this.targetCenter_=_;this.applyTargetState_(false,true);Zi(g,true)}};e.prototype.centerOn=function(t,e,r){this.centerOnInternal(rn(t,this.getProjection()),e,r)};e.prototype.centerOnInternal=function(t,e,r){this.setCenterInternal($i(t,e,r,this.getResolution(),this.getRotation()))};e.prototype.calculateCenterShift=function(t,e,r,n){var i;var o=this.padding_;if(o&&t){var a=this.getViewportSizeMinusPadding_(-r);var s=$i(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,r);i=[t[0]-s[0],t[1]-s[1]]}return i};e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==undefined};e.prototype.adjustCenter=function(t){var e=en(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])};e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])};e.prototype.adjustResolution=function(t,e){var r=e&&rn(e,this.getProjection());this.adjustResolutionInternal(t,r)};e.prototype.adjustResolutionInternal=function(t,e){var r=this.getAnimating()||this.getInteracting();var n=this.getViewportSize_(this.getRotation());var i=this.constraints_.resolution(this.targetResolution_*t,0,n,r);if(e){this.targetCenter_=this.calculateCenterZoom(i,e)}this.targetResolution_*=t;this.applyTargetState_()};e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)};e.prototype.adjustRotation=function(t,e){if(e){e=rn(e,this.getProjection())}this.adjustRotationInternal(t,e)};e.prototype.adjustRotationInternal=function(t,e){var r=this.getAnimating()||this.getInteracting();var n=this.constraints_.rotation(this.targetRotation_+t,r);if(e){this.targetCenter_=this.calculateCenterRotate(n,e)}this.targetRotation_+=t;this.applyTargetState_()};e.prototype.setCenter=function(t){this.setCenterInternal(rn(t,this.getProjection()))};e.prototype.setCenterInternal=function(t){this.targetCenter_=t;this.applyTargetState_()};e.prototype.setHint=function(t,e){this.hints_[t]+=e;this.changed();return this.hints_[t]};e.prototype.setResolution=function(t){this.targetResolution_=t;this.applyTargetState_()};e.prototype.setRotation=function(t){this.targetRotation_=t;this.applyTargetState_()};e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))};e.prototype.applyTargetState_=function(t,e){var r=this.getAnimating()||this.getInteracting()||e;var n=this.constraints_.rotation(this.targetRotation_,r);var i=this.getViewportSize_(n);var o=this.constraints_.resolution(this.targetResolution_,0,i,r);var a=this.constraints_.center(this.targetCenter_,o,i,r,this.calculateCenterShift(this.targetCenter_,o,n,i));if(this.get(qe.ROTATION)!==n){this.set(qe.ROTATION,n)}if(this.get(qe.RESOLUTION)!==o){this.set(qe.RESOLUTION,o);this.set("zoom",this.getZoom(),true)}if(!a||!this.get(qe.CENTER)||!lt(this.get(qe.CENTER),a)){this.set(qe.CENTER,a)}if(this.getAnimating()&&!t){this.cancelAnimations()}this.cancelAnchor_=undefined};e.prototype.resolveConstraints=function(t,e,r){var n=t!==undefined?t:200;var i=e||0;var o=this.constraints_.rotation(this.targetRotation_);var a=this.getViewportSize_(o);var s=this.constraints_.resolution(this.targetResolution_,i,a);var u=this.constraints_.center(this.targetCenter_,s,a,false,this.calculateCenterShift(this.targetCenter_,s,o,a));if(n===0&&!this.cancelAnchor_){this.targetResolution_=s;this.targetRotation_=o;this.targetCenter_=u;this.applyTargetState_();return}var l=r||(n===0?this.cancelAnchor_:undefined);this.cancelAnchor_=undefined;if(this.getResolution()!==s||this.getRotation()!==o||!this.getCenterInternal()||!lt(this.getCenterInternal(),u)){if(this.getAnimating()){this.cancelAnimations()}this.animateInternal({rotation:o,center:u,resolution:s,duration:n,easing:xn,anchor:l})}};e.prototype.beginInteraction=function(){this.resolveConstraints(0);this.setHint(Xe.INTERACTING,1)};e.prototype.endInteraction=function(t,e,r){var n=r&&rn(r,this.getProjection());this.endInteractionInternal(t,e,n)};e.prototype.endInteractionInternal=function(t,e,r){this.setHint(Xe.INTERACTING,-1);this.resolveConstraints(t,e,r)};e.prototype.getConstrainedCenter=function(t,e){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),r)};e.prototype.getConstrainedZoom=function(t,e){var r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,e))};e.prototype.getConstrainedResolution=function(t,e){var r=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,n)};return e}(Gt["a"]);function Zi(t,e){setTimeout((function(){t(e)}),0)}function Ki(t){if(t.extent!==undefined){var e=t.smoothExtentConstraint!==undefined?t.smoothExtentConstraint:true;return hn(t.extent,t.constrainOnlyCenter,e)}var r=kr(t.projection,"EPSG:3857");if(t.multiWorld!==true&&r.isGlobal()){var n=r.getExtent().slice();n[0]=-Infinity;n[2]=Infinity;return hn(n,false,false)}return cn}function Hi(t){var e;var r;var n;var i=28;var o=2;var a=t.minZoom!==undefined?t.minZoom:Xi;var s=t.maxZoom!==undefined?t.maxZoom:i;var u=t.zoomFactor!==undefined?t.zoomFactor:o;var l=t.multiWorld!==undefined?t.multiWorld:false;var h=t.smoothResolutionConstraint!==undefined?t.smoothResolutionConstraint:true;var c=t.showFullExtent!==undefined?t.showFullExtent:false;var f=kr(t.projection,"EPSG:3857");var p=f.getExtent();var d=t.constrainOnlyCenter;var v=t.extent;if(!l&&!v&&f.isGlobal()){d=false;v=p}if(t.resolutions!==undefined){var _=t.resolutions;r=_[a];n=_[s]!==undefined?_[s]:_[_.length-1];if(t.constrainResolution){e=vn(_,h,!d&&v,c)}else{e=gn(r,n,h,!d&&v,c)}}else{var g=!p?360*We[Ve.DEGREES]/f.getMetersPerUnit():Math.max(Object(R["D"])(p),Object(R["z"])(p));var y=g/Ke/Math.pow(o,Xi);var m=y/Math.pow(o,i-Xi);r=t.maxResolution;if(r!==undefined){a=0}else{r=y/Math.pow(u,a)}n=t.minResolution;if(n===undefined){if(t.maxZoom!==undefined){if(t.maxResolution!==undefined){n=r/Math.pow(u,s)}else{n=y/Math.pow(u,s)}}else{n=m}}s=a+Math.floor(Math.log(r/n)/Math.log(u));n=r/Math.pow(u,s-a);if(t.constrainResolution){e=_n(u,r,n,h,!d&&v,c)}else{e=gn(r,n,h,!d&&v,c)}}return{constraint:e,maxResolution:r,minResolution:n,minZoom:a,zoomFactor:u}}function Ji(t){var e=t.enableRotation!==undefined?t.enableRotation:true;if(e){var r=t.constrainRotation;if(r===undefined||r===true){return On()}else if(r===false){return mn}else if(typeof r==="number"){return En(r)}else{return mn}}else{return yn}}function Qi(t){if(t.sourceCenter&&t.targetCenter){if(!lt(t.sourceCenter,t.targetCenter)){return false}}if(t.sourceResolution!==t.targetResolution){return false}if(t.sourceRotation!==t.targetRotation){return false}return true}function $i(t,e,r,n,i){var o=Math.cos(-i);var a=Math.sin(-i);var s=t[0]*o-t[1]*a;var u=t[1]*o+t[0]*a;s+=(e[0]/2-r[0])*n;u+=(r[1]-e[1]/2)*n;a=-a;var l=s*o-u*a;var h=u*o+s*a;return[l,h]}var to=qi;function eo(t,e,r){if(r===undefined){r=[0,0]}r[0]=t[0]+2*e;r[1]=t[1]+2*e;return r}function ro(t){return t[0]>0&&t[1]>0}function no(t,e,r){if(r===undefined){r=[0,0]}r[0]=t[0]*e+.5|0;r[1]=t[1]*e+.5|0;return r}function io(t,e){if(Array.isArray(t)){return t}else{if(e===undefined){e=[t,t]}else{e[0]=t;e[1]=t}return e}}var oo=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();function ao(t){if(t instanceof tt){t.setMapInternal(null);return}if(t instanceof ye["default"]){t.getLayers().forEach(ao)}}function so(t,e){if(t instanceof tt){t.setMapInternal(e);return}if(t instanceof ye["default"]){var r=t.getLayers().getArray();for(var n=0,i=r.length;n<i;++n){so(r[n],e)}}}var uo=function(t){oo(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;var n=lo(e);r.renderComplete_;r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r);r.maxTilesLoading_=e.maxTilesLoading!==undefined?e.maxTilesLoading:16;r.pixelRatio_=e.pixelRatio!==undefined?e.pixelRatio:u["a"];r.postRenderTimeoutHandle_;r.animationDelayKey_;r.animationDelay_=function(){this.animationDelayKey_=undefined;this.renderFrame_(Date.now())}.bind(r);r.coordinateToPixelTransform_=c();r.pixelToCoordinateTransform_=c();r.frameIndex_=0;r.frameState_=null;r.previousExtent_=null;r.viewPropertyListenerKey_=null;r.viewChangeListenerKey_=null;r.layerGroupPropertyListenerKeys_=null;r.viewport_=document.createElement("div");r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":"");r.viewport_.style.position="relative";r.viewport_.style.overflow="hidden";r.viewport_.style.width="100%";r.viewport_.style.height="100%";r.overlayContainer_=document.createElement("div");r.overlayContainer_.style.position="absolute";r.overlayContainer_.style.zIndex="0";r.overlayContainer_.style.width="100%";r.overlayContainer_.style.height="100%";r.overlayContainer_.style.pointerEvents="none";r.overlayContainer_.className="ol-overlaycontainer";r.viewport_.appendChild(r.overlayContainer_);r.overlayContainerStopEvent_=document.createElement("div");r.overlayContainerStopEvent_.style.position="absolute";r.overlayContainerStopEvent_.style.zIndex="0";r.overlayContainerStopEvent_.style.width="100%";r.overlayContainerStopEvent_.style.height="100%";r.overlayContainerStopEvent_.style.pointerEvents="none";r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";r.viewport_.appendChild(r.overlayContainerStopEvent_);r.mapBrowserEventHandler_=null;r.moveTolerance_=e.moveTolerance;r.keyboardEventTarget_=n.keyboardEventTarget;r.targetChangeHandlerKeys_=null;r.controls=n.controls||new _e["a"];r.interactions=n.interactions||new _e["a"];r.overlays_=n.overlays;r.overlayIdIndex_={};r.renderer_=null;r.postRenderFunctions_=[];r.tileQueue_=new Ge(r.getTilePriority.bind(r),r.handleTileChange_.bind(r));r.addChangeListener(Pe.LAYERGROUP,r.handleLayerGroupChanged_);r.addChangeListener(Pe.VIEW,r.handleViewChanged_);r.addChangeListener(Pe.SIZE,r.handleSizeChanged_);r.addChangeListener(Pe.TARGET,r.handleTargetChanged_);r.setProperties(n.values);var i=r;if(e.view&&!(e.view instanceof to)){e.view.then((function(t){i.setView(new to(t))}))}r.controls.addEventListener(ge["a"].ADD,function(t){t.element.setMap(this)}.bind(r));r.controls.addEventListener(ge["a"].REMOVE,function(t){t.element.setMap(null)}.bind(r));r.interactions.addEventListener(ge["a"].ADD,function(t){t.element.setMap(this)}.bind(r));r.interactions.addEventListener(ge["a"].REMOVE,function(t){t.element.setMap(null)}.bind(r));r.overlays_.addEventListener(ge["a"].ADD,function(t){this.addOverlayInternal_(t.element)}.bind(r));r.overlays_.addEventListener(ge["a"].REMOVE,function(t){var e=t.element;var r=e.getId();if(r!==undefined){delete this.overlayIdIndex_[r.toString()]}t.element.setMap(null)}.bind(r));r.controls.forEach(function(t){t.setMap(this)}.bind(r));r.interactions.forEach(function(t){t.setMap(this)}.bind(r));r.overlays_.forEach(r.addOverlayInternal_.bind(r));return r}e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")};e.prototype.addControl=function(t){this.getControls().push(t)};e.prototype.addInteraction=function(t){this.getInteractions().push(t)};e.prototype.addLayer=function(t){var e=this.getLayerGroup().getLayers();e.push(t)};e.prototype.handleLayerAdd_=function(t){so(t.layer,this)};e.prototype.addOverlay=function(t){this.getOverlays().push(t)};e.prototype.addOverlayInternal_=function(t){var e=t.getId();if(e!==undefined){this.overlayIdIndex_[e.toString()]=t}t.setMap(this)};e.prototype.disposeInternal=function(){this.setTarget(null);t.prototype.disposeInternal.call(this)};e.prototype.forEachFeatureAtPixel=function(t,e,r){if(!this.frameState_){return}var n=this.getCoordinateFromPixelInternal(t);r=r!==undefined?r:{};var i=r.hitTolerance!==undefined?r.hitTolerance:0;var o=r.layerFilter!==undefined?r.layerFilter:a["b"];var s=r.checkWrapped!==false;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,i,s,e,null,o,null)};e.prototype.getFeaturesAtPixel=function(t,e){var r=[];this.forEachFeatureAtPixel(t,(function(t){r.push(t)}),e);return r};e.prototype.getAllLayers=function(){var t=[];function e(r){r.forEach((function(r){if(r instanceof ye["default"]){e(r.getLayers())}else{t.push(r)}}))}e(this.getLayers());return t};e.prototype.forEachLayerAtPixel=function(t,e,r){if(!this.frameState_){return}var n=r||{};var i=n.hitTolerance!==undefined?n.hitTolerance:0;var o=n.layerFilter||a["b"];return this.renderer_.forEachLayerAtPixel(t,this.frameState_,i,e,o)};e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_){return false}var r=this.getCoordinateFromPixelInternal(t);e=e!==undefined?e:{};var n=e.layerFilter!==undefined?e.layerFilter:a["b"];var i=e.hitTolerance!==undefined?e.hitTolerance:0;var o=e.checkWrapped!==false;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,i,o,n,null)};e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))};e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))};e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect();var r="changedTouches"in t?t.changedTouches[0]:t;return[r.clientX-e.left,r.clientY-e.top]};e.prototype.getTarget=function(){return this.get(Pe.TARGET)};e.prototype.getTargetElement=function(){var t=this.getTarget();if(t!==undefined){return typeof t==="string"?document.getElementById(t):t}else{return null}};e.prototype.getCoordinateFromPixel=function(t){return en(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())};e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;if(!e){return null}else{return _(e.pixelToCoordinateTransform,t.slice())}};e.prototype.getControls=function(){return this.controls};e.prototype.getOverlays=function(){return this.overlays_};e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return e!==undefined?e:null};e.prototype.getInteractions=function(){return this.interactions};e.prototype.getLayerGroup=function(){return this.get(Pe.LAYERGROUP)};e.prototype.setLayers=function(t){var e=this.getLayerGroup();if(t instanceof _e["a"]){e.setLayers(t);return}var r=e.getLayers();r.clear();r.extend(t)};e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t};e.prototype.getLoading=function(){var t=this.getLayerGroup().getLayerStatesArray();for(var e=0,r=t.length;e<r;++e){var n=t[e].layer;var i=n.getSource();if(i&&i.loading){return true}}return false};e.prototype.getPixelFromCoordinate=function(t){var e=rn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)};e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;if(!e){return null}else{return _(e.coordinateToPixelTransform,t.slice(0,2))}};e.prototype.getRenderer=function(){return this.renderer_};e.prototype.getSize=function(){return this.get(Pe.SIZE)};e.prototype.getView=function(){return this.get(Pe.VIEW)};e.prototype.getViewport=function(){return this.viewport_};e.prototype.getOverlayContainer=function(){return this.overlayContainer_};e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_};e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document};e.prototype.getTilePriority=function(t,e,r,n){return ke(this.frameState_,t,e,r,n)};e.prototype.handleBrowserEvent=function(t,e){var r=e||t.type;var n=new we(r,this,t);this.handleMapBrowserEvent(n)};e.prototype.handleMapBrowserEvent=function(t){if(!this.frameState_){return}var e=t.originalEvent;var r=e.type;if(r===Se.POINTERDOWN||r===V["a"].WHEEL||r===V["a"].KEYDOWN){var n=this.getOwnerDocument();var i=this.viewport_.getRootNode?this.viewport_.getRootNode():n;var o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(i===n?n.documentElement:i).contains(o)){return}}t.frameState=this.frameState_;if(this.dispatchEvent(t)!==false){var a=this.getInteractions().getArray().slice();for(var s=a.length-1;s>=0;s--){var u=a[s];if(u.getMap()!==this||!u.getActive()||!this.getTargetElement()){continue}var l=u.handleEvent(t);if(!l||t.propagationStopped){break}}}};e.prototype.handlePostRender=function(){var t=this.frameState_;var e=this.tileQueue_;if(!e.isEmpty()){var r=this.maxTilesLoading_;var n=r;if(t){var i=t.viewHints;if(i[Xe.ANIMATING]||i[Xe.INTERACTING]){var o=Date.now()-t.time>8;r=o?0:8;n=o?0:2}}if(e.getTilesLoading()<r){e.reprioritize();e.loadMoreTiles(r,n)}}if(t&&this.hasListener(q.RENDERCOMPLETE)&&!t.animate&&this.renderComplete_){this.renderer_.dispatchRenderEvent(q.RENDERCOMPLETE,t)}var a=this.postRenderFunctions_;for(var s=0,u=a.length;s<u;++s){a[s](this,t)}a.length=0};e.prototype.handleSizeChanged_=function(){if(this.getView()&&!this.getView().getAnimating()){this.getView().resolveConstraints(0)}this.render()};e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t){Object(H["c"])(this.targetChangeHandlerKeys_[t])}this.targetChangeHandlerKeys_=null;this.viewport_.removeEventListener(V["a"].CONTEXTMENU,this.boundHandleBrowserEvent_);this.viewport_.removeEventListener(V["a"].WHEEL,this.boundHandleBrowserEvent_);this.mapBrowserEventHandler_.dispose();this.mapBrowserEventHandler_=null;Object(Ut["e"])(this.viewport_)}var r=this.getTargetElement();if(!r){if(this.renderer_){clearTimeout(this.postRenderTimeoutHandle_);this.postRenderTimeoutHandle_=undefined;this.postRenderFunctions_.length=0;this.renderer_.dispose();this.renderer_=null}if(this.animationDelayKey_){cancelAnimationFrame(this.animationDelayKey_);this.animationDelayKey_=undefined}}else{r.appendChild(this.viewport_);if(!this.renderer_){this.renderer_=this.createRenderer()}this.mapBrowserEventHandler_=new Te(this,this.moveTolerance_);for(var n in Me){this.mapBrowserEventHandler_.addEventListener(Me[n],this.handleMapBrowserEvent.bind(this))}this.viewport_.addEventListener(V["a"].CONTEXTMENU,this.boundHandleBrowserEvent_,false);this.viewport_.addEventListener(V["a"].WHEEL,this.boundHandleBrowserEvent_,u["e"]?{passive:false}:false);var i=this.getOwnerDocument().defaultView;var o=!this.keyboardEventTarget_?r:this.keyboardEventTarget_;this.targetChangeHandlerKeys_=[Object(H["a"])(o,V["a"].KEYDOWN,this.handleBrowserEvent,this),Object(H["a"])(o,V["a"].KEYPRESS,this.handleBrowserEvent,this),Object(H["a"])(i,V["a"].RESIZE,this.updateSize,this)]}this.updateSize()};e.prototype.handleTileChange_=function(){this.render()};e.prototype.handleViewPropertyChanged_=function(){this.render()};e.prototype.handleViewChanged_=function(){if(this.viewPropertyListenerKey_){Object(H["c"])(this.viewPropertyListenerKey_);this.viewPropertyListenerKey_=null}if(this.viewChangeListenerKey_){Object(H["c"])(this.viewChangeListenerKey_);this.viewChangeListenerKey_=null}var t=this.getView();if(t){this.updateViewportSize_();this.viewPropertyListenerKey_=Object(H["a"])(t,xt["a"].PROPERTYCHANGE,this.handleViewPropertyChanged_,this);this.viewChangeListenerKey_=Object(H["a"])(t,V["a"].CHANGE,this.handleViewPropertyChanged_,this);t.resolveConstraints(0)}this.render()};e.prototype.handleLayerGroupChanged_=function(){if(this.layerGroupPropertyListenerKeys_){this.layerGroupPropertyListenerKeys_.forEach(H["c"]);this.layerGroupPropertyListenerKeys_=null}var t=this.getLayerGroup();if(t){this.handleLayerAdd_(new ye["GroupEvent"]("addlayer",t));this.layerGroupPropertyListenerKeys_=[Object(H["a"])(t,xt["a"].PROPERTYCHANGE,this.render,this),Object(H["a"])(t,V["a"].CHANGE,this.render,this),Object(H["a"])(t,"addlayer",this.handleLayerAdd_,this),Object(H["a"])(t,"removelayer",this.handleLayerRemove_,this)]}this.render()};e.prototype.isRendered=function(){return!!this.frameState_};e.prototype.renderSync=function(){if(this.animationDelayKey_){cancelAnimationFrame(this.animationDelayKey_)}this.animationDelay_()};e.prototype.redrawText=function(){var t=this.getLayerGroup().getLayerStatesArray();for(var e=0,r=t.length;e<r;++e){var n=t[e].layer;if(n.hasRenderer()){n.getRenderer().handleFontsChanged()}}};e.prototype.render=function(){if(this.renderer_&&this.animationDelayKey_===undefined){this.animationDelayKey_=requestAnimationFrame(this.animationDelay_)}};e.prototype.removeControl=function(t){return this.getControls().remove(t)};e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)};e.prototype.removeLayer=function(t){var e=this.getLayerGroup().getLayers();return e.remove(t)};e.prototype.handleLayerRemove_=function(t){ao(t.layer)};e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)};e.prototype.renderFrame_=function(t){var e=this;var r=this.getSize();var n=this.getView();var i=this.frameState_;var o=null;if(r!==undefined&&ro(r)&&n&&n.isDef()){var a=n.getHints(this.frameState_?this.frameState_.viewHints:undefined);var u=n.getState();o={animate:false,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Object(R["y"])(u.center,u.resolution,u.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:a,wantedTiles:{},mapId:Object(s["c"])(this),renderTargets:{}};if(u.nextCenter&&u.nextResolution){var l=isNaN(u.nextRotation)?u.rotation:u.nextRotation;o.nextExtent=Object(R["y"])(u.nextCenter,u.nextResolution,l,r)}}this.frameState_=o;this.renderer_.renderFrame(o);if(o){if(o.animate){this.render()}Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions);if(i){var h=!this.previousExtent_||!Object(R["G"])(this.previousExtent_)&&!Object(R["o"])(o.extent,this.previousExtent_);if(h){this.dispatchEvent(new Oe(Ie["a"].MOVESTART,this,i));this.previousExtent_=Object(R["l"])(this.previousExtent_)}}var c=this.previousExtent_&&!o.viewHints[Xe.ANIMATING]&&!o.viewHints[Xe.INTERACTING]&&!Object(R["o"])(o.extent,this.previousExtent_);if(c){this.dispatchEvent(new Oe(Ie["a"].MOVEEND,this,o));Object(R["d"])(o.extent,this.previousExtent_)}}this.dispatchEvent(new Oe(Ie["a"].POSTRENDER,this,o));this.renderComplete_=!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoading();if(!this.postRenderTimeoutHandle_){this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=undefined;e.handlePostRender()}),0)}};e.prototype.setLayerGroup=function(t){var e=this.getLayerGroup();if(e){this.handleLayerRemove_(new ye["GroupEvent"]("removelayer",e))}this.set(Pe.LAYERGROUP,t)};e.prototype.setSize=function(t){this.set(Pe.SIZE,t)};e.prototype.setTarget=function(t){this.set(Pe.TARGET,t)};e.prototype.setView=function(t){if(!t||t instanceof to){this.set(Pe.VIEW,t);return}this.set(Pe.VIEW,new to);var e=this;t.then((function(t){e.setView(new to(t))}))};e.prototype.updateSize=function(){var t=this.getTargetElement();var e=undefined;if(t){var r=getComputedStyle(t);var n=t.offsetWidth-parseFloat(r["borderLeftWidth"])-parseFloat(r["paddingLeft"])-parseFloat(r["paddingRight"])-parseFloat(r["borderRightWidth"]);var i=t.offsetHeight-parseFloat(r["borderTopWidth"])-parseFloat(r["paddingTop"])-parseFloat(r["paddingBottom"])-parseFloat(r["borderBottomWidth"]);if(!isNaN(n)&&!isNaN(i)){e=[n,i];if(!ro(e)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)){console.warn("No map visible because the map container's width or height are 0.")}}}this.setSize(e);this.updateViewportSize_()};e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=undefined;var r=getComputedStyle(this.viewport_);if(r.width&&r.height){e=[parseInt(r.width,10),parseInt(r.height,10)]}t.setViewportSize(e)}};return e}(Gt["a"]);function lo(t){var e=null;if(t.keyboardEventTarget!==undefined){e=typeof t.keyboardEventTarget==="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget}var r={};var n=t.layers&&typeof t.layers.getLayers==="function"?t.layers:new ye["default"]({layers:t.layers});r[Pe.LAYERGROUP]=n;r[Pe.TARGET]=t.target;r[Pe.VIEW]=t.view instanceof to?t.view:new to;var i;if(t.controls!==undefined){if(Array.isArray(t.controls)){i=new _e["a"](t.controls.slice())}else{Object(l["a"])(typeof t.controls.getArray==="function",47);i=t.controls}}var o;if(t.interactions!==undefined){if(Array.isArray(t.interactions)){o=new _e["a"](t.interactions.slice())}else{Object(l["a"])(typeof t.interactions.getArray==="function",48);o=t.interactions}}var a;if(t.overlays!==undefined){if(Array.isArray(t.overlays)){a=new _e["a"](t.overlays.slice())}else{Object(l["a"])(typeof t.overlays.getArray==="function",49);a=t.overlays}}else{a=new _e["a"]}return{controls:i,interactions:o,keyboardEventTarget:e,overlays:a,values:r}}var ho=uo;var co=r(17);var fo=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var po=function(t){fo(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;r.ulElement_=document.createElement("ul");r.collapsed_=n.collapsed!==undefined?n.collapsed:true;r.userCollapsed_=r.collapsed_;r.overrideCollapsible_=n.collapsible!==undefined;r.collapsible_=n.collapsible!==undefined?n.collapsible:true;if(!r.collapsible_){r.collapsed_=false}var i=n.className!==undefined?n.className:"ol-attribution";var o=n.tipLabel!==undefined?n.tipLabel:"Attributions";var a=n.expandClassName!==undefined?n.expandClassName:i+"-expand";var s=n.collapseLabel!==undefined?n.collapseLabel:"›";var u=n.collapseClassName!==undefined?n.collapseClassName:i+"-collpase";if(typeof s==="string"){r.collapseLabel_=document.createElement("span");r.collapseLabel_.textContent=s;r.collapseLabel_.className=u}else{r.collapseLabel_=s}var l=n.label!==undefined?n.label:"i";if(typeof l==="string"){r.label_=document.createElement("span");r.label_.textContent=l;r.label_.className=a}else{r.label_=l}var h=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;r.toggleButton_=document.createElement("button");r.toggleButton_.setAttribute("type","button");r.toggleButton_.setAttribute("aria-expanded",String(!r.collapsed_));r.toggleButton_.title=o;r.toggleButton_.appendChild(h);r.toggleButton_.addEventListener(V["a"].CLICK,r.handleClick_.bind(r),false);var c=i+" "+It+" "+Lt+(r.collapsed_&&r.collapsible_?" "+At:"")+(r.collapsible_?"":" ol-uncollapsible");var f=r.element;f.className=c;f.appendChild(r.toggleButton_);f.appendChild(r.ulElement_);r.renderedAttributions_=[];r.renderedVisible_=true;return r}e.prototype.collectSourceAttributions_=function(t){var e={};var r=[];var n=true;var i=t.layerStatesArray;for(var o=0,a=i.length;o<a;++o){var s=i[o];if(!$(s,t.viewState)){continue}var u=s.layer.getSource();if(!u){continue}var l=u.getAttributions();if(!l){continue}var h=l(t);if(!h){continue}n=n&&u.getAttributionsCollapsible()!==false;if(Array.isArray(h)){for(var c=0,f=h.length;c<f;++c){if(!(h[c]in e)){r.push(h[c]);e[h[c]]=true}}}else{if(!(h in e)){r.push(h);e[h]=true}}}if(!this.overrideCollapsible_){this.setCollapsible(n)}return r};e.prototype.updateElement_=function(t){if(!t){if(this.renderedVisible_){this.element.style.display="none";this.renderedVisible_=false}return}var e=this.collectSourceAttributions_(t);var r=e.length>0;if(this.renderedVisible_!=r){this.element.style.display=r?"":"none";this.renderedVisible_=r}if(Object(fn["b"])(e,this.renderedAttributions_)){return}Object(Ut["d"])(this.ulElement_);for(var n=0,i=e.length;n<i;++n){var o=document.createElement("li");o.innerHTML=e[n];this.ulElement_.appendChild(o)}this.renderedAttributions_=e};e.prototype.handleClick_=function(t){t.preventDefault();this.handleToggle_();this.userCollapsed_=this.collapsed_};e.prototype.handleToggle_=function(){this.element.classList.toggle(At);if(this.collapsed_){Object(Ut["g"])(this.collapseLabel_,this.label_)}else{Object(Ut["g"])(this.label_,this.collapseLabel_)}this.collapsed_=!this.collapsed_;this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))};e.prototype.getCollapsible=function(){return this.collapsible_};e.prototype.setCollapsible=function(t){if(this.collapsible_===t){return}this.collapsible_=t;this.element.classList.toggle("ol-uncollapsible");if(this.userCollapsed_){this.handleToggle_()}};e.prototype.setCollapsed=function(t){this.userCollapsed_=t;if(!this.collapsible_||this.collapsed_===t){return}this.handleToggle_()};e.prototype.getCollapsed=function(){return this.collapsed_};e.prototype.render=function(t){this.updateElement_(t.frameState)};return e}(co["default"]);var vo=po;var _o=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var go=function(t){_o(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var i=n.className!==undefined?n.className:"ol-rotate";var o=n.label!==undefined?n.label:"⇧";var a=n.compassClassName!==undefined?n.compassClassName:"ol-compass";r.label_=null;if(typeof o==="string"){r.label_=document.createElement("span");r.label_.className=a;r.label_.textContent=o}else{r.label_=o;r.label_.classList.add(a)}var s=n.tipLabel?n.tipLabel:"Reset rotation";var u=document.createElement("button");u.className=i+"-reset";u.setAttribute("type","button");u.title=s;u.appendChild(r.label_);u.addEventListener(V["a"].CLICK,r.handleClick_.bind(r),false);var l=i+" "+It+" "+Lt;var h=r.element;h.className=l;h.appendChild(u);r.callResetNorth_=n.resetNorth?n.resetNorth:undefined;r.duration_=n.duration!==undefined?n.duration:250;r.autoHide_=n.autoHide!==undefined?n.autoHide:true;r.rotation_=undefined;if(r.autoHide_){r.element.classList.add(Rt)}return r}e.prototype.handleClick_=function(t){t.preventDefault();if(this.callResetNorth_!==undefined){this.callResetNorth_()}else{this.resetNorth_()}};e.prototype.resetNorth_=function(){var t=this.getMap();var e=t.getView();if(!e){return}var r=e.getRotation();if(r!==undefined){if(this.duration_>0&&r%(2*Math.PI)!==0){e.animate({rotation:0,duration:this.duration_,easing:xn})}else{e.setRotation(0)}}};e.prototype.render=function(t){var e=t.frameState;if(!e){return}var r=e.viewState.rotation;if(r!=this.rotation_){var n="rotate("+r+"rad)";if(this.autoHide_){var i=this.element.classList.contains(Rt);if(!i&&r===0){this.element.classList.add(Rt)}else if(i&&r!==0){this.element.classList.remove(Rt)}}this.label_.style.transform=n}this.rotation_=r};return e}(co["default"]);var yo=go;var mo=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Eo=function(t){mo(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{element:document.createElement("div"),target:n.target})||this;var i=n.className!==undefined?n.className:"ol-zoom";var o=n.delta!==undefined?n.delta:1;var a=n.zoomInClassName!==undefined?n.zoomInClassName:i+"-in";var s=n.zoomOutClassName!==undefined?n.zoomOutClassName:i+"-out";var u=n.zoomInLabel!==undefined?n.zoomInLabel:"+";var l=n.zoomOutLabel!==undefined?n.zoomOutLabel:"–";var h=n.zoomInTipLabel!==undefined?n.zoomInTipLabel:"Zoom in";var c=n.zoomOutTipLabel!==undefined?n.zoomOutTipLabel:"Zoom out";var f=document.createElement("button");f.className=a;f.setAttribute("type","button");f.title=h;f.appendChild(typeof u==="string"?document.createTextNode(u):u);f.addEventListener(V["a"].CLICK,r.handleClick_.bind(r,o),false);var p=document.createElement("button");p.className=s;p.setAttribute("type","button");p.title=c;p.appendChild(typeof l==="string"?document.createTextNode(l):l);p.addEventListener(V["a"].CLICK,r.handleClick_.bind(r,-o),false);var d=i+" "+It+" "+Lt;var v=r.element;v.className=d;v.appendChild(f);v.appendChild(p);r.duration_=n.duration!==undefined?n.duration:250;return r}e.prototype.handleClick_=function(t,e){e.preventDefault();this.zoomByDelta_(t)};e.prototype.zoomByDelta_=function(t){var e=this.getMap();var r=e.getView();if(!r){return}var n=r.getZoom();if(n!==undefined){var i=r.getConstrainedZoom(n+t);if(this.duration_>0){if(r.getAnimating()){r.cancelAnimations()}r.animate({zoom:i,duration:this.duration_,easing:xn})}else{r.setZoom(i)}}};return e}(co["default"]);var Oo=Eo;function bo(t){var e=t?t:{};var r=new _e["a"];var n=e.zoom!==undefined?e.zoom:true;if(n){r.push(new Oo(e.zoomOptions))}var i=e.rotate!==undefined?e.rotate:true;if(i){r.push(new yo(e.rotateOptions))}var o=e.attribution!==undefined?e.attribution:true;if(o){r.push(new vo(e.attributionOptions))}return r}var xo={ACTIVE:"active"};var wo=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Mo=function(t){wo(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;if(e&&e.handleEvent){r.handleEvent=e.handleEvent}r.map_=null;r.setActive(true);return r}e.prototype.getActive=function(){return this.get(xo.ACTIVE)};e.prototype.getMap=function(){return this.map_};e.prototype.handleEvent=function(t){return true};e.prototype.setActive=function(t){this.set(xo.ACTIVE,t)};e.prototype.setMap=function(t){this.map_=t};return e}(Gt["a"]);function So(t,e,r){var n=t.getCenterInternal();if(n){var i=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:r!==undefined?r:250,easing:Mn,center:t.getConstrainedCenter(i)})}}function Co(t,e,r,n){var i=t.getZoom();if(i===undefined){return}var o=t.getConstrainedZoom(i+e);var a=t.getResolutionForZoom(o);if(t.getAnimating()){t.cancelAnimations()}t.animate({resolution:a,anchor:r,duration:n!==undefined?n:250,easing:xn})}var Ro=Mo;var To=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Io=function(t){To(e,t);function e(e){var r=t.call(this)||this;var n=e?e:{};r.delta_=n.delta?n.delta:1;r.duration_=n.duration!==undefined?n.duration:250;return r}e.prototype.handleEvent=function(t){var e=false;if(t.type==Me.DBLCLICK){var r=t.originalEvent;var n=t.map;var i=t.coordinate;var o=r.shiftKey?-this.delta_:this.delta_;var a=n.getView();Co(a,o,i,this.duration_);r.preventDefault();e=true}return!e};return e}(Ro);var Po=Io;var Lo=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ao=function(t){Lo(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;if(n.handleDownEvent){r.handleDownEvent=n.handleDownEvent}if(n.handleDragEvent){r.handleDragEvent=n.handleDragEvent}if(n.handleMoveEvent){r.handleMoveEvent=n.handleMoveEvent}if(n.handleUpEvent){r.handleUpEvent=n.handleUpEvent}if(n.stopDown){r.stopDown=n.stopDown}r.handlingDownUpSequence=false;r.trackedPointers_={};r.targetPointers=[];return r}e.prototype.getPointerCount=function(){return this.targetPointers.length};e.prototype.handleDownEvent=function(t){return false};e.prototype.handleDragEvent=function(t){};e.prototype.handleEvent=function(t){if(!t.originalEvent){return true}var e=false;this.updateTrackedPointers_(t);if(this.handlingDownUpSequence){if(t.type==Me.POINTERDRAG){this.handleDragEvent(t);t.originalEvent.preventDefault()}else if(t.type==Me.POINTERUP){var r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else{if(t.type==Me.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n;e=this.stopDown(n)}else if(t.type==Me.POINTERMOVE){this.handleMoveEvent(t)}}return!e};e.prototype.handleMoveEvent=function(t){};e.prototype.handleUpEvent=function(t){return false};e.prototype.stopDown=function(t){return t};e.prototype.updateTrackedPointers_=function(t){if(No(t)){var e=t.originalEvent;var r=e.pointerId.toString();if(t.type==Me.POINTERUP){delete this.trackedPointers_[r]}else if(t.type==Me.POINTERDOWN){this.trackedPointers_[r]=e}else if(r in this.trackedPointers_){this.trackedPointers_[r]=e}this.targetPointers=Object(K["c"])(this.trackedPointers_)}};return e}(Ro);function jo(t){var e=t.length;var r=0;var n=0;for(var i=0;i<e;i++){r+=t[i].clientX;n+=t[i].clientY}return[r/e,n/e]}function No(t){var e=t.type;return e===Me.POINTERDOWN||e===Me.POINTERDRAG||e===Me.POINTERUP}var Fo=Ao;function Do(t){var e=arguments;return function(t){var r=true;for(var n=0,i=e.length;n<i;++n){r=r&&e[n](t);if(!r){break}}return r}}var Go=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};var ko=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};var Uo=function(t){var e=t.map.getTargetElement();var r=t.map.getOwnerDocument().activeElement;return e.contains(r)};var Bo=function(t){return t.map.getTargetElement().hasAttribute("tabindex")?Uo(t):true};var zo=a["b"];var Yo=function(t){return t.type==Me.CLICK};var Wo=function(t){var e=t.originalEvent;return e.button==0&&!(u["f"]&&u["d"]&&e.ctrlKey)};var Vo=a["a"];var Xo=function(t){return t.type=="pointermove"};var qo=function(t){return t.type==Me.SINGLECLICK};var Zo=function(t){return t.type==Me.DBLCLICK};var Ko=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};var Ho=function(t){var e=t.originalEvent;return!e.altKey&&(u["d"]?e.metaKey:e.ctrlKey)&&!e.shiftKey};var Jo=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey};var Qo=function(t){var e=t.originalEvent;var r=e.target.tagName;return r!=="INPUT"&&r!=="SELECT"&&r!=="TEXTAREA"};var $o=function(t){var e=t.originalEvent;Object(l["a"])(e!==undefined,56);return e.pointerType=="mouse"};var ta=function(t){var e=t.originalEvent;Object(l["a"])(e!==undefined,56);return e.pointerType==="touch"};var ea=function(t){var e=t.originalEvent;Object(l["a"])(e!==undefined,56);return e.pointerType==="pen"};var ra=function(t){var e=t.originalEvent;Object(l["a"])(e!==undefined,56);return e.isPrimary&&e.button===0};var na=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ia=function(t){na(e,t);function e(e){var r=t.call(this,{stopDown:a["a"]})||this;var n=e?e:{};r.kinetic_=n.kinetic;r.lastCentroid=null;r.lastPointersCount_;r.panning_=false;var i=n.condition?n.condition:Do(Ko,ra);r.condition_=n.onFocusOnly?Do(Bo,i):i;r.noKinetic_=false;return r}e.prototype.handleDragEvent=function(t){if(!this.panning_){this.panning_=true;this.getMap().getView().beginInteraction()}var e=this.targetPointers;var r=jo(e);if(e.length==this.lastPointersCount_){if(this.kinetic_){this.kinetic_.update(r[0],r[1])}if(this.lastCentroid){var n=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]];var i=t.map;var o=i.getView();ct(n,o.getResolution());ht(n,o.getRotation());o.adjustCenterInternal(n)}}else if(this.kinetic_){this.kinetic_.begin()}this.lastCentroid=r;this.lastPointersCount_=e.length;t.originalEvent.preventDefault()};e.prototype.handleUpEvent=function(t){var e=t.map;var r=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance();var i=this.kinetic_.getAngle();var o=r.getCenterInternal();var a=e.getPixelFromCoordinateInternal(o);var s=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(i),a[1]-n*Math.sin(i)]);r.animateInternal({center:r.getConstrainedCenter(s),duration:500,easing:xn})}if(this.panning_){this.panning_=false;r.endInteraction()}return false}else{if(this.kinetic_){this.kinetic_.begin()}this.lastCentroid=null;return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map;var r=e.getView();this.lastCentroid=null;if(r.getAnimating()){r.cancelAnimations()}if(this.kinetic_){this.kinetic_.begin()}this.noKinetic_=this.targetPointers.length>1;return true}else{return false}};return e}(Fo);var oa=ia;var aa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var sa=function(t){aa(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{stopDown:a["a"]})||this;r.condition_=n.condition?n.condition:ko;r.lastAngle_=undefined;r.duration_=n.duration!==undefined?n.duration:250;return r}e.prototype.handleDragEvent=function(t){if(!$o(t)){return}var e=t.map;var r=e.getView();if(r.getConstraints().rotation===yn){return}var n=e.getSize();var i=t.pixel;var o=Math.atan2(n[1]/2-i[1],i[0]-n[0]/2);if(this.lastAngle_!==undefined){var a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o};e.prototype.handleUpEvent=function(t){if(!$o(t)){return true}var e=t.map;var r=e.getView();r.endInteraction(this.duration_);return false};e.prototype.handleDownEvent=function(t){if(!$o(t)){return false}if(Wo(t)&&this.condition_(t)){var e=t.map;e.getView().beginInteraction();this.lastAngle_=undefined;return true}else{return false}};return e}(Fo);var ua=sa;var la=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ha=function(t){la(e,t);function e(e){var r=t.call(this)||this;r.geometry_=null;r.element_=document.createElement("div");r.element_.style.position="absolute";r.element_.style.pointerEvents="auto";r.element_.className="ol-box "+e;r.map_=null;r.startPixel_=null;r.endPixel_=null;return r}e.prototype.disposeInternal=function(){this.setMap(null)};e.prototype.render_=function(){var t=this.startPixel_;var e=this.endPixel_;var r="px";var n=this.element_.style;n.left=Math.min(t[0],e[0])+r;n.top=Math.min(t[1],e[1])+r;n.width=Math.abs(e[0]-t[0])+r;n.height=Math.abs(e[1]-t[1])+r};e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit";e.top="inherit";e.width="inherit";e.height="inherit"}this.map_=t;if(this.map_){this.map_.getOverlayContainer().appendChild(this.element_)}};e.prototype.setPixels=function(t,e){this.startPixel_=t;this.endPixel_=e;this.createOrUpdateGeometry();this.render_()};e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_;var e=this.endPixel_;var r=[t,[t[0],e[1]],e,[e[0],t[1]]];var n=r.map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice();if(!this.geometry_){this.geometry_=new Ui([n])}else{this.geometry_.setCoordinates([n])}};e.prototype.getGeometry=function(){return this.geometry_};return e}(o["a"]);var ca=ha;var fa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var pa={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};var da=function(t){fa(e,t);function e(e,r,n){var i=t.call(this,e)||this;i.coordinate=r;i.mapBrowserEvent=n;return i}return e}(wt["a"]);var va=function(t){fa(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;var n=e?e:{};r.box_=new ca(n.className||"ol-dragbox");r.minArea_=n.minArea!==undefined?n.minArea:64;if(n.onBoxEnd){r.onBoxEnd=n.onBoxEnd}r.startPixel_=null;r.condition_=n.condition?n.condition:Wo;r.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:r.defaultBoxEndCondition;return r}e.prototype.defaultBoxEndCondition=function(t,e,r){var n=r[0]-e[0];var i=r[1]-e[1];return n*n+i*i>=this.minArea_};e.prototype.getGeometry=function(){return this.box_.getGeometry()};e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel);this.dispatchEvent(new da(pa.BOXDRAG,t.coordinate,t))};e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);if(e){this.onBoxEnd(t)}this.dispatchEvent(new da(e?pa.BOXEND:pa.BOXCANCEL,t.coordinate,t));return false};e.prototype.handleDownEvent=function(t){if(this.condition_(t)){this.startPixel_=t.pixel;this.box_.setMap(t.map);this.box_.setPixels(this.startPixel_,this.startPixel_);this.dispatchEvent(new da(pa.BOXSTART,t.coordinate,t));return true}else{return false}};e.prototype.onBoxEnd=function(t){};return e}(Fo);var _a=va;var ga=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ya=function(t){ga(e,t);function e(e){var r=this;var n=e?e:{};var i=n.condition?n.condition:Jo;r=t.call(this,{condition:i,className:n.className||"ol-dragzoom",minArea:n.minArea})||this;r.duration_=n.duration!==undefined?n.duration:200;r.out_=n.out!==undefined?n.out:false;return r}e.prototype.onBoxEnd=function(t){var e=this.getMap();var r=e.getView();var n=this.getGeometry();if(this.out_){var i=r.rotatedExtentForGeometry(n);var o=r.getResolutionForExtentInternal(i);var a=r.getResolution()/o;n=n.clone();n.scale(a*a)}r.fitInternal(n,{duration:this.duration_,easing:xn})};return e}(_a);var ma=ya;var Ea={LEFT:37,UP:38,RIGHT:39,DOWN:40};var Oa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ba=function(t){Oa(e,t);function e(e){var r=t.call(this)||this;var n=e||{};r.defaultCondition_=function(t){return Ko(t)&&Qo(t)};r.condition_=n.condition!==undefined?n.condition:r.defaultCondition_;r.duration_=n.duration!==undefined?n.duration:100;r.pixelDelta_=n.pixelDelta!==undefined?n.pixelDelta:128;return r}e.prototype.handleEvent=function(t){var e=false;if(t.type==V["a"].KEYDOWN){var r=t.originalEvent;var n=r.keyCode;if(this.condition_(t)&&(n==Ea.DOWN||n==Ea.LEFT||n==Ea.RIGHT||n==Ea.UP)){var i=t.map;var o=i.getView();var a=o.getResolution()*this.pixelDelta_;var s=0,u=0;if(n==Ea.DOWN){u=-a}else if(n==Ea.LEFT){s=-a}else if(n==Ea.RIGHT){s=a}else{u=a}var l=[s,u];ht(l,o.getRotation());So(o,l,this.duration_);r.preventDefault();e=true}}return!e};return e}(Ro);var xa=ba;var wa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ma=function(t){wa(e,t);function e(e){var r=t.call(this)||this;var n=e?e:{};r.condition_=n.condition?n.condition:Qo;r.delta_=n.delta?n.delta:1;r.duration_=n.duration!==undefined?n.duration:100;return r}e.prototype.handleEvent=function(t){var e=false;if(t.type==V["a"].KEYDOWN||t.type==V["a"].KEYPRESS){var r=t.originalEvent;var n=r.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map;var o=n=="+".charCodeAt(0)?this.delta_:-this.delta_;var a=i.getView();Co(a,o,undefined,this.duration_);r.preventDefault();e=true}}return!e};return e}(Ro);var Sa=Ma;var Ca=function(){function t(t,e,r){this.decay_=t;this.minVelocity_=e;this.delay_=r;this.points_=[];this.angle_=0;this.initialVelocity_=0}t.prototype.begin=function(){this.points_.length=0;this.angle_=0;this.initialVelocity_=0};t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())};t.prototype.end=function(){if(this.points_.length<6){return false}var t=Date.now()-this.delay_;var e=this.points_.length-3;if(this.points_[e+2]<t){return false}var r=e-3;while(r>0&&this.points_[r+2]>t){r-=3}var n=this.points_[e+2]-this.points_[r+2];if(n<1e3/60){return false}var i=this.points_[e]-this.points_[r];var o=this.points_[e+1]-this.points_[r+1];this.angle_=Math.atan2(o,i);this.initialVelocity_=Math.sqrt(i*i+o*o)/n;return this.initialVelocity_>this.minVelocity_};t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_};t.prototype.getAngle=function(){return this.angle_};return t}();var Ra=Ca;var Ta=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ia={TRACKPAD:"trackpad",WHEEL:"wheel"};var Pa=function(t){Ta(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;r.totalDelta_=0;r.lastDelta_=0;r.maxDelta_=n.maxDelta!==undefined?n.maxDelta:1;r.duration_=n.duration!==undefined?n.duration:250;r.timeout_=n.timeout!==undefined?n.timeout:80;r.useAnchor_=n.useAnchor!==undefined?n.useAnchor:true;r.constrainResolution_=n.constrainResolution!==undefined?n.constrainResolution:false;var i=n.condition?n.condition:zo;r.condition_=n.onFocusOnly?Do(Bo,i):i;r.lastAnchor_=null;r.startTime_=undefined;r.timeoutId_;r.mode_=undefined;r.trackpadEventGap_=400;r.trackpadTimeoutId_;r.deltaPerZoom_=300;return r}e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=undefined;var t=this.getMap().getView();t.endInteraction(undefined,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)};e.prototype.handleEvent=function(t){if(!this.condition_(t)){return true}var e=t.type;if(e!==V["a"].WHEEL){return true}var r=t.map;var n=t.originalEvent;n.preventDefault();if(this.useAnchor_){this.lastAnchor_=t.coordinate}var i;if(t.type==V["a"].WHEEL){i=n.deltaY;if(u["b"]&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL){i/=u["a"]}if(n.deltaMode===WheelEvent.DOM_DELTA_LINE){i*=40}}if(i===0){return false}else{this.lastDelta_=i}var o=Date.now();if(this.startTime_===undefined){this.startTime_=o}if(!this.mode_||o-this.startTime_>this.trackpadEventGap_){this.mode_=Math.abs(i)<4?Ia.TRACKPAD:Ia.WHEEL}var a=r.getView();if(this.mode_===Ia.TRACKPAD&&!(a.getConstrainResolution()||this.constrainResolution_)){if(this.trackpadTimeoutId_){clearTimeout(this.trackpadTimeoutId_)}else{if(a.getAnimating()){a.cancelAnimations()}a.beginInteraction()}this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_);a.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_);this.startTime_=o;return false}this.totalDelta_+=i;var s=Math.max(this.timeout_-(o-this.startTime_),0);clearTimeout(this.timeoutId_);this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),s);return false};e.prototype.handleWheelZoom_=function(t){var e=t.getView();if(e.getAnimating()){e.cancelAnimations()}var r=-Object(T["b"])(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;if(e.getConstrainResolution()||this.constrainResolution_){r=r?r>0?1:-1:0}Co(e,r,this.lastAnchor_,this.duration_);this.mode_=undefined;this.totalDelta_=0;this.lastAnchor_=null;this.startTime_=undefined;this.timeoutId_=undefined};e.prototype.setMouseAnchor=function(t){this.useAnchor_=t;if(!t){this.lastAnchor_=null}};return e}(Ro);var La=Pa;var Aa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ja=function(t){Aa(e,t);function e(e){var r=this;var n=e?e:{};var i=n;if(!i.stopDown){i.stopDown=a["a"]}r=t.call(this,i)||this;r.anchor_=null;r.lastAngle_=undefined;r.rotating_=false;r.rotationDelta_=0;r.threshold_=n.threshold!==undefined?n.threshold:.3;r.duration_=n.duration!==undefined?n.duration:250;return r}e.prototype.handleDragEvent=function(t){var e=0;var r=this.targetPointers[0];var n=this.targetPointers[1];var i=Math.atan2(n.clientY-r.clientY,n.clientX-r.clientX);if(this.lastAngle_!==undefined){var o=i-this.lastAngle_;this.rotationDelta_+=o;if(!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_){this.rotating_=true}e=o}this.lastAngle_=i;var a=t.map;var s=a.getView();if(s.getConstraints().rotation===yn){return}var u=a.getViewport().getBoundingClientRect();var l=jo(this.targetPointers);l[0]-=u.left;l[1]-=u.top;this.anchor_=a.getCoordinateFromPixelInternal(l);if(this.rotating_){a.render();s.adjustRotationInternal(e,this.anchor_)}};e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map;var r=e.getView();r.endInteraction(this.duration_);return false}else{return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;this.anchor_=null;this.lastAngle_=undefined;this.rotating_=false;this.rotationDelta_=0;if(!this.handlingDownUpSequence){e.getView().beginInteraction()}return true}else{return false}};return e}(Fo);var Na=ja;var Fa=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Da=function(t){Fa(e,t);function e(e){var r=this;var n=e?e:{};var i=n;if(!i.stopDown){i.stopDown=a["a"]}r=t.call(this,i)||this;r.anchor_=null;r.duration_=n.duration!==undefined?n.duration:400;r.lastDistance_=undefined;r.lastScaleDelta_=1;return r}e.prototype.handleDragEvent=function(t){var e=1;var r=this.targetPointers[0];var n=this.targetPointers[1];var i=r.clientX-n.clientX;var o=r.clientY-n.clientY;var a=Math.sqrt(i*i+o*o);if(this.lastDistance_!==undefined){e=this.lastDistance_/a}this.lastDistance_=a;var s=t.map;var u=s.getView();if(e!=1){this.lastScaleDelta_=e}var l=s.getViewport().getBoundingClientRect();var h=jo(this.targetPointers);h[0]-=l.left;h[1]-=l.top;this.anchor_=s.getCoordinateFromPixelInternal(h);s.render();u.adjustResolutionInternal(e,this.anchor_)};e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map;var r=e.getView();var n=this.lastScaleDelta_>1?1:-1;r.endInteraction(this.duration_,n);return false}else{return true}};e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;this.anchor_=null;this.lastDistance_=undefined;this.lastScaleDelta_=1;if(!this.handlingDownUpSequence){e.getView().beginInteraction()}return true}else{return false}};return e}(Fo);var Ga=Da;function ka(t){var e=t?t:{};var r=new _e["a"];var n=new Ra(-.005,.05,100);var i=e.altShiftDragRotate!==undefined?e.altShiftDragRotate:true;if(i){r.push(new ua)}var o=e.doubleClickZoom!==undefined?e.doubleClickZoom:true;if(o){r.push(new Po({delta:e.zoomDelta,duration:e.zoomDuration}))}var a=e.dragPan!==undefined?e.dragPan:true;if(a){r.push(new oa({onFocusOnly:e.onFocusOnly,kinetic:n}))}var s=e.pinchRotate!==undefined?e.pinchRotate:true;if(s){r.push(new Na)}var u=e.pinchZoom!==undefined?e.pinchZoom:true;if(u){r.push(new Ga({duration:e.zoomDuration}))}var l=e.keyboard!==undefined?e.keyboard:true;if(l){r.push(new xa);r.push(new Sa({delta:e.zoomDelta,duration:e.zoomDuration}))}var h=e.mouseWheelZoom!==undefined?e.mouseWheelZoom:true;if(h){r.push(new La({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}))}var c=e.shiftDragZoom!==undefined?e.shiftDragZoom:true;if(c){r.push(new ma({duration:e.zoomDuration}))}return r}var Ua=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ba=function(t){Ua(e,t);function e(e){var r=this;e=Object(K["a"])({},e);if(!e.controls){e.controls=bo()}if(!e.interactions){e.interactions=ka({onFocusOnly:true})}r=t.call(this,e)||this;return r}e.prototype.createRenderer=function(){return new ve(this)};return e}(ho);var za=Ba;var Ya=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Wa=function(t){Ya(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;r.id_=undefined;r.geometryName_="geometry";r.style_=null;r.styleFunction_=undefined;r.geometryChangeKey_=null;r.addChangeListener(r.geometryName_,r.handleGeometryChanged_);if(e){if(typeof e.getSimplifiedGeometry==="function"){var n=e;r.setGeometry(n)}else{var i=e;r.setProperties(i)}}return r}e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var r=this.getGeometry();if(r){t.setGeometry(r.clone())}var n=this.getStyle();if(n){t.setStyle(n)}return t};e.prototype.getGeometry=function(){return this.get(this.geometryName_)};e.prototype.getId=function(){return this.id_};e.prototype.getGeometryName=function(){return this.geometryName_};e.prototype.getStyle=function(){return this.style_};e.prototype.getStyleFunction=function(){return this.styleFunction_};e.prototype.handleGeometryChange_=function(){this.changed()};e.prototype.handleGeometryChanged_=function(){if(this.geometryChangeKey_){Object(H["c"])(this.geometryChangeKey_);this.geometryChangeKey_=null}var t=this.getGeometry();if(t){this.geometryChangeKey_=Object(H["a"])(t,V["a"].CHANGE,this.handleGeometryChange_,this)}this.changed()};e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)};e.prototype.setStyle=function(t){this.style_=t;this.styleFunction_=!t?undefined:Va(t);this.changed()};e.prototype.setId=function(t){this.id_=t;this.changed()};e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_);this.geometryName_=t;this.addChangeListener(this.geometryName_,this.handleGeometryChanged_);this.handleGeometryChanged_()};return e}(Gt["a"]);function Va(t){if(typeof t==="function"){return t}else{var e;if(Array.isArray(t)){e=t}else{Object(l["a"])(typeof t.getZIndex==="function",41);var r=t;e=[r]}return function(){return e}}}var Xa=Wa;var qa={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};var Za=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ka={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};var Ha=function(t){Za(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;r.options=e;r.id=e.id;r.insertFirst=e.insertFirst!==undefined?e.insertFirst:true;r.stopEvent=e.stopEvent!==undefined?e.stopEvent:true;r.element=document.createElement("div");r.element.className=e.className!==undefined?e.className:"ol-overlay-container "+Tt;r.element.style.position="absolute";r.element.style.pointerEvents="auto";var n=e.autoPan;if(n&&"object"!==typeof n){n={animation:e.autoPanAnimation,margin:e.autoPanMargin}}r.autoPan=n||false;r.rendered={transform_:"",visible:true};r.mapPostrenderListenerKey=null;r.addChangeListener(Ka.ELEMENT,r.handleElementChanged);r.addChangeListener(Ka.MAP,r.handleMapChanged);r.addChangeListener(Ka.OFFSET,r.handleOffsetChanged);r.addChangeListener(Ka.POSITION,r.handlePositionChanged);r.addChangeListener(Ka.POSITIONING,r.handlePositioningChanged);if(e.element!==undefined){r.setElement(e.element)}r.setOffset(e.offset!==undefined?e.offset:[0,0]);r.setPositioning(e.positioning!==undefined?e.positioning:qa.TOP_LEFT);if(e.position!==undefined){r.setPosition(e.position)}return r}e.prototype.getElement=function(){return this.get(Ka.ELEMENT)};e.prototype.getId=function(){return this.id};e.prototype.getMap=function(){return this.get(Ka.MAP)};e.prototype.getOffset=function(){return this.get(Ka.OFFSET)};e.prototype.getPosition=function(){return this.get(Ka.POSITION)};e.prototype.getPositioning=function(){return this.get(Ka.POSITIONING)};e.prototype.handleElementChanged=function(){Object(Ut["d"])(this.element);var t=this.getElement();if(t){this.element.appendChild(t)}};e.prototype.handleMapChanged=function(){if(this.mapPostrenderListenerKey){Object(Ut["e"])(this.element);Object(H["c"])(this.mapPostrenderListenerKey);this.mapPostrenderListenerKey=null}var t=this.getMap();if(t){this.mapPostrenderListenerKey=Object(H["a"])(t,Ie["a"].POSTRENDER,this.render,this);this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();if(this.insertFirst){e.insertBefore(this.element,e.childNodes[0]||null)}else{e.appendChild(this.element)}this.performAutoPan()}};e.prototype.render=function(){this.updatePixelPosition()};e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()};e.prototype.handlePositionChanged=function(){this.updatePixelPosition();this.performAutoPan()};e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()};e.prototype.setElement=function(t){this.set(Ka.ELEMENT,t)};e.prototype.setMap=function(t){this.set(Ka.MAP,t)};e.prototype.setOffset=function(t){this.set(Ka.OFFSET,t)};e.prototype.setPosition=function(t){this.set(Ka.POSITION,t)};e.prototype.performAutoPan=function(){if(this.autoPan){this.panIntoView(this.autoPan)}};e.prototype.panIntoView=function(t){var e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Ka.POSITION)){return}var r=this.getRect(e.getTargetElement(),e.getSize());var n=this.getElement();var i=this.getRect(n,[Object(Ut["c"])(n),Object(Ut["b"])(n)]);var o=t||{};var a=o.margin===undefined?20:o.margin;if(!Object(R["g"])(r,i)){var s=i[0]-r[0];var u=r[2]-i[2];var l=i[1]-r[1];var h=r[3]-i[3];var c=[0,0];if(s<0){c[0]=s-a}else if(u<0){c[0]=Math.abs(u)+a}if(l<0){c[1]=l-a}else if(h<0){c[1]=Math.abs(h)+a}if(c[0]!==0||c[1]!==0){var f=e.getView().getCenterInternal();var p=e.getPixelFromCoordinateInternal(f);if(!p){return}var d=[p[0]+c[0],p[1]+c[1]];var v=o.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(d),duration:v.duration,easing:v.easing})}}};e.prototype.getRect=function(t,e){var r=t.getBoundingClientRect();var n=r.left+window.pageXOffset;var i=r.top+window.pageYOffset;return[n,i,n+e[0],i+e[1]]};e.prototype.setPositioning=function(t){this.set(Ka.POSITIONING,t)};e.prototype.setVisible=function(t){if(this.rendered.visible!==t){this.element.style.display=t?"":"none";this.rendered.visible=t}};e.prototype.updatePixelPosition=function(){var t=this.getMap();var e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(false);return}var r=t.getPixelFromCoordinate(e);var n=t.getSize();this.updateRenderedPosition(r,n)};e.prototype.updateRenderedPosition=function(t,e){var r=this.element.style;var n=this.getOffset();var i=this.getPositioning();this.setVisible(true);var o=Math.round(t[0]+n[0])+"px";var a=Math.round(t[1]+n[1])+"px";var s="0%";var u="0%";if(i==qa.BOTTOM_RIGHT||i==qa.CENTER_RIGHT||i==qa.TOP_RIGHT){s="-100%"}else if(i==qa.BOTTOM_CENTER||i==qa.CENTER_CENTER||i==qa.TOP_CENTER){s="-50%"}if(i==qa.BOTTOM_LEFT||i==qa.BOTTOM_CENTER||i==qa.BOTTOM_RIGHT){u="-100%"}else if(i==qa.CENTER_LEFT||i==qa.CENTER_CENTER||i==qa.CENTER_RIGHT){u="-50%"}var l="translate("+s+", "+u+") translate("+o+", "+a+")";if(this.rendered.transform_!=l){this.rendered.transform_=l;r.transform=l;r.msTransform=l}};e.prototype.getOptions=function(){return this.options};return e}(Gt["a"]);var Ja=Ha;var Qa={FRACTION:"fraction",PIXELS:"pixels"};var $a={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var ts={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var es=function(){function t(t){this.opacity_=t.opacity;this.rotateWithView_=t.rotateWithView;this.rotation_=t.rotation;this.scale_=t.scale;this.scaleArray_=io(t.scale);this.displacement_=t.displacement}t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})};t.prototype.getOpacity=function(){return this.opacity_};t.prototype.getRotateWithView=function(){return this.rotateWithView_};t.prototype.getRotation=function(){return this.rotation_};t.prototype.getScale=function(){return this.scale_};t.prototype.getScaleArray=function(){return this.scaleArray_};t.prototype.getDisplacement=function(){return this.displacement_};t.prototype.getAnchor=function(){return Object(s["b"])()};t.prototype.getImage=function(t){return Object(s["b"])()};t.prototype.getHitDetectionImage=function(){return Object(s["b"])()};t.prototype.getPixelRatio=function(t){return 1};t.prototype.getImageState=function(){return Object(s["b"])()};t.prototype.getImageSize=function(){return Object(s["b"])()};t.prototype.getOrigin=function(){return Object(s["b"])()};t.prototype.getSize=function(){return Object(s["b"])()};t.prototype.setDisplacement=function(t){this.displacement_=t};t.prototype.setOpacity=function(t){this.opacity_=t};t.prototype.setRotateWithView=function(t){this.rotateWithView_=t};t.prototype.setRotation=function(t){this.rotation_=t};t.prototype.setScale=function(t){this.scale_=t;this.scaleArray_=io(t)};t.prototype.listenImageChange=function(t){Object(s["b"])()};t.prototype.load=function(){Object(s["b"])()};t.prototype.unlistenImageChange=function(t){Object(s["b"])()};return t}();var rs=es;var ns=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var is=function(t){ns(e,t);function e(e,r,n,i){var o=t.call(this)||this;o.extent=e;o.pixelRatio_=n;o.resolution=r;o.state=i;return o}e.prototype.changed=function(){this.dispatchEvent(V["a"].CHANGE)};e.prototype.getExtent=function(){return this.extent};e.prototype.getImage=function(){return Object(s["b"])()};e.prototype.getPixelRatio=function(){return this.pixelRatio_};e.prototype.getResolution=function(){return this.resolution};e.prototype.getState=function(){return this.state};e.prototype.load=function(){Object(s["b"])()};return e}(kt["a"]);var os=is;var as=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ss=function(t){as(e,t);function e(e,r,n,i,o,a){var s=t.call(this,e,r,n,ts.IDLE)||this;s.src_=i;s.image_=new Image;if(o!==null){s.image_.crossOrigin=o}s.unlisten_=null;s.state=ts.IDLE;s.imageLoadFunction_=a;return s}e.prototype.getImage=function(){return this.image_};e.prototype.handleImageError_=function(){this.state=ts.ERROR;this.unlistenImage_();this.changed()};e.prototype.handleImageLoad_=function(){if(this.resolution===undefined){this.resolution=Object(R["z"])(this.extent)/this.image_.height}this.state=ts.LOADED;this.unlistenImage_();this.changed()};e.prototype.load=function(){if(this.state==ts.IDLE||this.state==ts.ERROR){this.state=ts.LOADING;this.changed();this.imageLoadFunction_(this,this.src_);this.unlisten_=us(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.setImage=function(t){this.image_=t;this.resolution=Object(R["z"])(this.extent)/this.image_.height};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(os);function us(t,e,r){var n=t;var i=true;var o=false;var a=false;var s=[Object(H["b"])(n,V["a"].LOAD,(function(){a=true;if(!o){e()}}))];if(n.src&&u["c"]){o=true;n.decode().then((function(){if(i){e()}})).catch((function(t){if(i){if(a){e()}else{r()}}}))}else{s.push(Object(H["b"])(n,V["a"].ERROR,r))}return function t(){i=false;s.forEach(H["c"])}}var ls=ss;var hs=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var cs=null;var fs=function(t){hs(e,t);function e(e,r,n,i,o,a){var s=t.call(this)||this;s.hitDetectionImage_=null;s.image_=!e?new Image:e;if(i!==null){s.image_.crossOrigin=i}s.canvas_={};s.color_=a;s.unlisten_=null;s.imageState_=o;s.size_=n;s.src_=r;s.tainted_;return s}e.prototype.isTainted_=function(){if(this.tainted_===undefined&&this.imageState_===ts.LOADED){if(!cs){cs=Object(Ut["a"])(1,1)}cs.drawImage(this.image_,0,0);try{cs.getImageData(0,0,1,1);this.tainted_=false}catch(t){cs=null;this.tainted_=true}}return this.tainted_===true};e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(V["a"].CHANGE)};e.prototype.handleImageError_=function(){this.imageState_=ts.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()};e.prototype.handleImageLoad_=function(){this.imageState_=ts.LOADED;if(this.size_){this.image_.width=this.size_[0];this.image_.height=this.size_[1]}else{this.size_=[this.image_.width,this.image_.height]}this.unlistenImage_();this.dispatchChangeEvent_()};e.prototype.getImage=function(t){this.replaceColor_(t);return this.canvas_[t]?this.canvas_[t]:this.image_};e.prototype.getPixelRatio=function(t){this.replaceColor_(t);return this.canvas_[t]?t:1};e.prototype.getImageState=function(){return this.imageState_};e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_){if(this.isTainted_()){var t=this.size_[0];var e=this.size_[1];var r=Object(Ut["a"])(t,e);r.fillRect(0,0,t,e);this.hitDetectionImage_=r.canvas}else{this.hitDetectionImage_=this.image_}}return this.hitDetectionImage_};e.prototype.getSize=function(){return this.size_};e.prototype.getSrc=function(){return this.src_};e.prototype.load=function(){if(this.imageState_==ts.IDLE){this.imageState_=ts.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=us(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.replaceColor_=function(t){if(!this.color_||this.canvas_[t]||this.imageState_!==ts.LOADED){return}var e=document.createElement("canvas");this.canvas_[t]=e;e.width=Math.ceil(this.image_.width*t);e.height=Math.ceil(this.image_.height*t);var r=e.getContext("2d");r.scale(t,t);r.drawImage(this.image_,0,0);r.globalCompositeOperation="multiply";if(r.globalCompositeOperation==="multiply"||this.isTainted_()){r.fillStyle=L(this.color_);r.fillRect(0,0,e.width/t,e.height/t);r.globalCompositeOperation="destination-in";r.drawImage(this.image_,0,0)}else{var n=r.getImageData(0,0,e.width,e.height);var i=n.data;var o=this.color_[0]/255;var a=this.color_[1]/255;var s=this.color_[2]/255;var u=this.color_[3];for(var l=0,h=i.length;l<h;l+=4){i[l]*=o;i[l+1]*=a;i[l+2]*=s;i[l+3]*=u}r.putImageData(n,0,0)}};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(kt["a"]);function ps(t,e,r,n,i,o){var a=Y.get(e,n,o);if(!a){a=new fs(t,e,r,n,i,o);Y.set(e,n,o,a)}return a}var ds=fs;var vs=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var _s=function(t){vs(e,t);function e(e){var r=this;var n=e||{};var i=n.opacity!==undefined?n.opacity:1;var o=n.rotation!==undefined?n.rotation:0;var a=n.scale!==undefined?n.scale:1;var u=n.rotateWithView!==undefined?n.rotateWithView:false;r=t.call(this,{opacity:i,rotation:o,scale:a,displacement:n.displacement!==undefined?n.displacement:[0,0],rotateWithView:u})||this;r.anchor_=n.anchor!==undefined?n.anchor:[.5,.5];r.normalizedAnchor_=null;r.anchorOrigin_=n.anchorOrigin!==undefined?n.anchorOrigin:$a.TOP_LEFT;r.anchorXUnits_=n.anchorXUnits!==undefined?n.anchorXUnits:Qa.FRACTION;r.anchorYUnits_=n.anchorYUnits!==undefined?n.anchorYUnits:Qa.FRACTION;r.crossOrigin_=n.crossOrigin!==undefined?n.crossOrigin:null;var h=n.img!==undefined?n.img:null;var c=n.imgSize!==undefined?n.imgSize:null;var f=n.src;Object(l["a"])(!(f!==undefined&&h),4);Object(l["a"])(!h||h&&c,5);if((f===undefined||f.length===0)&&h){f=h.src||Object(s["c"])(h)}Object(l["a"])(f!==undefined&&f.length>0,6);var p=n.src!==undefined?ts.IDLE:ts.LOADED;r.color_=n.color!==undefined?N(n.color):null;r.iconImage_=ps(h,f,c,r.crossOrigin_,p,r.color_);r.offset_=n.offset!==undefined?n.offset:[0,0];r.offsetOrigin_=n.offsetOrigin!==undefined?n.offsetOrigin:$a.TOP_LEFT;r.origin_=null;r.size_=n.size!==undefined?n.size:null;return r}e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||undefined,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():undefined,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})};e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if(this.anchorXUnits_==Qa.FRACTION||this.anchorYUnits_==Qa.FRACTION){if(!e){return null}t=this.anchor_.slice();if(this.anchorXUnits_==Qa.FRACTION){t[0]*=e[0]}if(this.anchorYUnits_==Qa.FRACTION){t[1]*=e[1]}}if(this.anchorOrigin_!=$a.TOP_LEFT){if(!e){return null}if(t===this.anchor_){t=this.anchor_.slice()}if(this.anchorOrigin_==$a.TOP_RIGHT||this.anchorOrigin_==$a.BOTTOM_RIGHT){t[0]=-t[0]+e[0]}if(this.anchorOrigin_==$a.BOTTOM_LEFT||this.anchorOrigin_==$a.BOTTOM_RIGHT){t[1]=-t[1]+e[1]}}this.normalizedAnchor_=t}var r=this.getDisplacement();return[t[0]-r[0],t[1]+r[1]]};e.prototype.setAnchor=function(t){this.anchor_=t;this.normalizedAnchor_=null};e.prototype.getColor=function(){return this.color_};e.prototype.getImage=function(t){return this.iconImage_.getImage(t)};e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)};e.prototype.getImageSize=function(){return this.iconImage_.getSize()};e.prototype.getImageState=function(){return this.iconImage_.getImageState()};e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()};e.prototype.getOrigin=function(){if(this.origin_){return this.origin_}var t=this.offset_;if(this.offsetOrigin_!=$a.TOP_LEFT){var e=this.getSize();var r=this.iconImage_.getSize();if(!e||!r){return null}t=t.slice();if(this.offsetOrigin_==$a.TOP_RIGHT||this.offsetOrigin_==$a.BOTTOM_RIGHT){t[0]=r[0]-e[0]-t[0]}if(this.offsetOrigin_==$a.BOTTOM_LEFT||this.offsetOrigin_==$a.BOTTOM_RIGHT){t[1]=r[1]-e[1]-t[1]}}this.origin_=t;return this.origin_};e.prototype.getSrc=function(){return this.iconImage_.getSrc()};e.prototype.getSize=function(){return!this.size_?this.iconImage_.getSize():this.size_};e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(V["a"].CHANGE,t)};e.prototype.load=function(){this.iconImage_.load()};e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(V["a"].CHANGE,t)};return e}(rs);var gs=_s;function ys(t){if(Array.isArray(t)){return G(t)}else{return t}}var ms=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Es=function(t){ms(e,t);function e(e){var r=this;var n=e.rotateWithView!==undefined?e.rotateWithView:false;r=t.call(this,{opacity:1,rotateWithView:n,rotation:e.rotation!==undefined?e.rotation:0,scale:e.scale!==undefined?e.scale:1,displacement:e.displacement!==undefined?e.displacement:[0,0]})||this;r.canvas_=undefined;r.hitDetectionCanvas_=null;r.fill_=e.fill!==undefined?e.fill:null;r.origin_=[0,0];r.points_=e.points;r.radius_=e.radius!==undefined?e.radius:e.radius1;r.radius2_=e.radius2;r.angle_=e.angle!==undefined?e.angle:0;r.stroke_=e.stroke!==undefined?e.stroke:null;r.size_=null;r.renderOptions_=null;r.render();return r}e.prototype.clone=function(){var t=this.getScale();var r=new e({fill:this.getFill()?this.getFill().clone():undefined,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():undefined,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});r.setOpacity(this.getOpacity());return r};e.prototype.getAnchor=function(){var t=this.size_;if(!t){return null}var e=this.getDisplacement();return[t[0]/2-e[0],t[1]/2+e[1]]};e.prototype.getAngle=function(){return this.angle_};e.prototype.getFill=function(){return this.fill_};e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionCanvas_){this.createHitDetectionCanvas_(this.renderOptions_)}return this.hitDetectionCanvas_};e.prototype.getImage=function(t){var e=this.canvas_[t];if(!e){var r=this.renderOptions_;var n=Object(Ut["a"])(r.size*t,r.size*t);this.draw_(r,n,t);e=n.canvas;this.canvas_[t]=e}return e};e.prototype.getPixelRatio=function(t){return t};e.prototype.getImageSize=function(){return this.size_};e.prototype.getImageState=function(){return ts.LOADED};e.prototype.getOrigin=function(){return this.origin_};e.prototype.getPoints=function(){return this.points_};e.prototype.getRadius=function(){return this.radius_};e.prototype.getRadius2=function(){return this.radius2_};e.prototype.getSize=function(){return this.size_};e.prototype.getStroke=function(){return this.stroke_};e.prototype.listenImageChange=function(t){};e.prototype.load=function(){};e.prototype.unlistenImageChange=function(t){};e.prototype.calculateLineJoinSize_=function(t,e,r){if(e===0||this.points_===Infinity||t!=="bevel"&&t!=="miter"){return e}var n=this.radius_;var i=this.radius2_===undefined?n:this.radius2_;if(n<i){var o=n;n=i;i=o}var a=this.radius2_===undefined?this.points_:this.points_*2;var s=2*Math.PI/a;var u=i*Math.sin(s);var l=Math.sqrt(i*i-u*u);var h=n-l;var c=Math.sqrt(u*u+h*h);var f=c/u;if(t==="miter"&&f<=r){return f*e}var p=e/2/f;var d=e/2*(h/c);var v=Math.sqrt((n+p)*(n+p)+d*d);var _=v-n;if(this.radius2_===undefined||t==="bevel"){return _*2}var g=n*Math.sin(s);var y=Math.sqrt(n*n-g*g);var m=i-y;var E=Math.sqrt(g*g+m*m);var O=E/g;if(O<=r){var b=O*e/2-i-n;return 2*Math.max(_,b)}return _*2};e.prototype.createRenderOptions=function(){var t=Xt;var e=0;var r=null;var n=0;var i;var o=0;if(this.stroke_){i=this.stroke_.getColor();if(i===null){i=Zt}i=ys(i);o=this.stroke_.getWidth();if(o===undefined){o=Qt}r=this.stroke_.getLineDash();n=this.stroke_.getLineDashOffset();t=this.stroke_.getLineJoin();if(t===undefined){t=Xt}e=this.stroke_.getMiterLimit();if(e===undefined){e=qt}}var a=this.calculateLineJoinSize_(t,o,e);var s=Math.max(this.radius_,this.radius2_||0);var u=Math.ceil(2*s+a);return{strokeStyle:i,strokeWidth:o,size:u,lineDash:r,lineDashOffset:n,lineJoin:t,miterLimit:e}};e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={};this.size_=[t,t]};e.prototype.draw_=function(t,e,r){e.scale(r,r);e.translate(t.size/2,t.size/2);this.createPath_(e);if(this.fill_){var n=this.fill_.getColor();if(n===null){n=zt}e.fillStyle=ys(n);e.fill()}if(this.stroke_){e.strokeStyle=t.strokeStyle;e.lineWidth=t.strokeWidth;if(e.setLineDash&&t.lineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.lineJoin=t.lineJoin;e.miterLimit=t.miterLimit;e.stroke()}};e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var e=this.fill_.getColor();var r=0;if(typeof e==="string"){e=N(e)}if(e===null){r=1}else if(Array.isArray(e)){r=e.length===4?e[3]:1}if(r===0){var n=Object(Ut["a"])(t.size,t.size);this.hitDetectionCanvas_=n.canvas;this.drawHitDetectionCanvas_(t,n)}}if(!this.hitDetectionCanvas_){this.hitDetectionCanvas_=this.getImage(1)}};e.prototype.createPath_=function(t){var e=this.points_;var r=this.radius_;if(e===Infinity){t.arc(0,0,r,0,2*Math.PI)}else{var n=this.radius2_===undefined?r:this.radius2_;if(this.radius2_!==undefined){e*=2}var i=this.angle_-Math.PI/2;var o=2*Math.PI/e;for(var a=0;a<e;a++){var s=i+a*o;var u=a%2===0?r:n;t.lineTo(u*Math.cos(s),u*Math.sin(s))}t.closePath()}};e.prototype.drawHitDetectionCanvas_=function(t,e){e.translate(t.size/2,t.size/2);this.createPath_(e);e.fillStyle=zt;e.fill();if(this.stroke_){e.strokeStyle=t.strokeStyle;e.lineWidth=t.strokeWidth;if(t.lineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.lineJoin=t.lineJoin;e.miterLimit=t.miterLimit;e.stroke()}};return e}(rs);var Os=Es;var bs=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var xs=function(t){bs(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{points:Infinity,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:n.scale!==undefined?n.scale:1,rotation:n.rotation!==undefined?n.rotation:0,rotateWithView:n.rotateWithView!==undefined?n.rotateWithView:false,displacement:n.displacement!==undefined?n.displacement:[0,0]})||this;return r}e.prototype.clone=function(){var t=this.getScale();var r=new e({fill:this.getFill()?this.getFill().clone():undefined,stroke:this.getStroke()?this.getStroke().clone():undefined,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});r.setOpacity(this.getOpacity());return r};e.prototype.setRadius=function(t){this.radius_=t;this.render()};return e}(Os);var ws=xs;var Ms=function(){function t(t){var e=t||{};this.color_=e.color!==undefined?e.color:null}t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||undefined})};t.prototype.getColor=function(){return this.color_};t.prototype.setColor=function(t){this.color_=t};return t}();var Ss=Ms;var Cs=function(){function t(t){var e=t||{};this.color_=e.color!==undefined?e.color:null;this.lineCap_=e.lineCap;this.lineDash_=e.lineDash!==undefined?e.lineDash:null;this.lineDashOffset_=e.lineDashOffset;this.lineJoin_=e.lineJoin;this.miterLimit_=e.miterLimit;this.width_=e.width}t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||undefined,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():undefined,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})};t.prototype.getColor=function(){return this.color_};t.prototype.getLineCap=function(){return this.lineCap_};t.prototype.getLineDash=function(){return this.lineDash_};t.prototype.getLineDashOffset=function(){return this.lineDashOffset_};t.prototype.getLineJoin=function(){return this.lineJoin_};t.prototype.getMiterLimit=function(){return this.miterLimit_};t.prototype.getWidth=function(){return this.width_};t.prototype.setColor=function(t){this.color_=t};t.prototype.setLineCap=function(t){this.lineCap_=t};t.prototype.setLineDash=function(t){this.lineDash_=t};t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t};t.prototype.setLineJoin=function(t){this.lineJoin_=t};t.prototype.setMiterLimit=function(t){this.miterLimit_=t};t.prototype.setWidth=function(t){this.width_=t};return t}();var Rs=Cs;var Ts=function(){function t(t){var e=t||{};this.geometry_=null;this.geometryFunction_=js;if(e.geometry!==undefined){this.setGeometry(e.geometry)}this.fill_=e.fill!==undefined?e.fill:null;this.image_=e.image!==undefined?e.image:null;this.renderer_=e.renderer!==undefined?e.renderer:null;this.hitDetectionRenderer_=e.hitDetectionRenderer!==undefined?e.hitDetectionRenderer:null;this.stroke_=e.stroke!==undefined?e.stroke:null;this.text_=e.text!==undefined?e.text:null;this.zIndex_=e.zIndex}t.prototype.clone=function(){var e=this.getGeometry();if(e&&typeof e==="object"){e=e.clone()}return new t({geometry:e,fill:this.getFill()?this.getFill().clone():undefined,image:this.getImage()?this.getImage().clone():undefined,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():undefined,text:this.getText()?this.getText().clone():undefined,zIndex:this.getZIndex()})};t.prototype.getRenderer=function(){return this.renderer_};t.prototype.setRenderer=function(t){this.renderer_=t};t.prototype.setHitDetectionRenderer=function(t){this.hitDetectionRenderer_=t};t.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_};t.prototype.getGeometry=function(){return this.geometry_};t.prototype.getGeometryFunction=function(){return this.geometryFunction_};t.prototype.getFill=function(){return this.fill_};t.prototype.setFill=function(t){this.fill_=t};t.prototype.getImage=function(){return this.image_};t.prototype.setImage=function(t){this.image_=t};t.prototype.getStroke=function(){return this.stroke_};t.prototype.setStroke=function(t){this.stroke_=t};t.prototype.getText=function(){return this.text_};t.prototype.setText=function(t){this.text_=t};t.prototype.getZIndex=function(){return this.zIndex_};t.prototype.setGeometry=function(t){if(typeof t==="function"){this.geometryFunction_=t}else if(typeof t==="string"){this.geometryFunction_=function(e){return e.get(t)}}else if(!t){this.geometryFunction_=js}else if(t!==undefined){this.geometryFunction_=function(){return t}}this.geometry_=t};t.prototype.setZIndex=function(t){this.zIndex_=t};return t}();function Is(t){var e;if(typeof t==="function"){e=t}else{var r;if(Array.isArray(t)){r=t}else{Object(l["a"])(typeof t.getZIndex==="function",41);var n=t;r=[n]}e=function(){return r}}return e}var Ps=null;function Ls(t,e){if(!Ps){var r=new Ss({color:"rgba(255,255,255,0.4)"});var n=new Rs({color:"#3399CC",width:1.25});Ps=[new Ts({image:new ws({fill:r,stroke:n,radius:5}),fill:r,stroke:n})]}return Ps}function As(){var t={};var e=[255,255,255,1];var r=[0,153,255,1];var n=3;t[Ue.POLYGON]=[new Ts({fill:new Ss({color:[255,255,255,.5]})})];t[Ue.MULTI_POLYGON]=t[Ue.POLYGON];t[Ue.LINE_STRING]=[new Ts({stroke:new Rs({color:e,width:n+2})}),new Ts({stroke:new Rs({color:r,width:n})})];t[Ue.MULTI_LINE_STRING]=t[Ue.LINE_STRING];t[Ue.CIRCLE]=t[Ue.POLYGON].concat(t[Ue.LINE_STRING]);t[Ue.POINT]=[new Ts({image:new ws({radius:n*2,fill:new Ss({color:r}),stroke:new Rs({color:e,width:n/2})}),zIndex:Infinity})];t[Ue.MULTI_POINT]=t[Ue.POINT];t[Ue.GEOMETRY_COLLECTION]=t[Ue.POLYGON].concat(t[Ue.LINE_STRING],t[Ue.POINT]);return t}function js(t){return t.getGeometry()}var Ns=Ts;var Fs=r(28);var Ds=r.n(Fs);var Gs=function(){function t(t){this.rbush_=new Ds.a(t);this.items_={}}t.prototype.insert=function(t,e){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(r);this.items_[Object(s["c"])(e)]=r};t.prototype.load=function(t,e){var r=new Array(e.length);for(var n=0,i=e.length;n<i;n++){var o=t[n];var a=e[n];var u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[n]=u;this.items_[Object(s["c"])(a)]=u}this.rbush_.load(r)};t.prototype.remove=function(t){var e=Object(s["c"])(t);var r=this.items_[e];delete this.items_[e];return this.rbush_.remove(r)!==null};t.prototype.update=function(t,e){var r=this.items_[Object(s["c"])(e)];var n=[r.minX,r.minY,r.maxX,r.maxY];if(!Object(R["o"])(n,t)){this.remove(e);this.insert(t,e)}};t.prototype.getAll=function(){var t=this.rbush_.all();return t.map((function(t){return t.value}))};t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};var r=this.rbush_.search(e);return r.map((function(t){return t.value}))};t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)};t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)};t.prototype.forEach_=function(t,e){var r;for(var n=0,i=t.length;n<i;n++){r=e(t[n]);if(r){return r}}return r};t.prototype.isEmpty=function(){return Object(K["d"])(this.items_)};t.prototype.clear=function(){this.rbush_.clear();this.items_={}};t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Object(R["k"])(e.minX,e.minY,e.maxX,e.maxY,t)};t.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(var e in t.items_){this.items_[e]=t.items_[e]}};return t}();var ks=Gs;var Us=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Bs=function(t){Us(e,t);function e(e){var r=t.call(this)||this;r.projection=jr(e.projection);r.attributions_=zs(e.attributions);r.attributionsCollapsible_=e.attributionsCollapsible!==undefined?e.attributionsCollapsible:true;r.loading=false;r.state_=e.state!==undefined?e.state:Z["a"].READY;r.wrapX_=e.wrapX!==undefined?e.wrapX:false;r.interpolate_=!!e.interpolate;r.viewResolver=null;r.viewRejector=null;var n=r;r.viewPromise_=new Promise((function(t,e){n.viewResolver=t;n.viewRejector=e}));return r}e.prototype.getAttributions=function(){return this.attributions_};e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_};e.prototype.getProjection=function(){return this.projection};e.prototype.getResolutions=function(){return Object(s["b"])()};e.prototype.getView=function(){return this.viewPromise_};e.prototype.getState=function(){return this.state_};e.prototype.getWrapX=function(){return this.wrapX_};e.prototype.getInterpolate=function(){return this.interpolate_};e.prototype.refresh=function(){this.changed()};e.prototype.setAttributions=function(t){this.attributions_=zs(t);this.changed()};e.prototype.setState=function(t){this.state_=t;this.changed()};return e}(Gt["a"]);function zs(t){if(!t){return null}if(Array.isArray(t)){return function(e){return t}}if(typeof t==="function"){return t}return function(e){return[t]}}var Ys=Bs;var Ws={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Vs(t,e){return[[-Infinity,-Infinity,Infinity,Infinity]]}function Xs(t,e){return[t]}function qs(t){return function(e,r,n){var i=t.getZForResolution(sn(r,n));var o=t.getTileRangeForExtentAndZ(on(e,n),i);var a=[];var s=[i,0,0];for(s[1]=o.minX;s[1]<=o.maxX;++s[1]){for(s[2]=o.minY;s[2]<=o.maxY;++s[2]){a.push(nn(t.getTileCoordExtent(s),n))}}return a}}var Zs={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};var Ks=false;function Hs(t,e,r,n,i,o,a){var s=new XMLHttpRequest;s.open("GET",typeof t==="function"?t(r,n,i):t,true);if(e.getType()==Zs.ARRAY_BUFFER){s.responseType="arraybuffer"}s.withCredentials=Ks;s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var n=e.getType();var u=void 0;if(n==Zs.JSON||n==Zs.TEXT){u=s.responseText}else if(n==Zs.XML){u=s.responseXML;if(!u){u=(new DOMParser).parseFromString(s.responseText,"application/xml")}}else if(n==Zs.ARRAY_BUFFER){u=s.response}if(u){o(e.readFeatures(u,{extent:r,featureProjection:i}),e.readProjection(u))}else{a()}}else{a()}};s.onerror=a;s.send()}function Js(t,e){return function(r,n,i,o,s){var u=this;Hs(t,e,r,n,i,(function(t,e){u.addFeatures(t);if(o!==undefined){o(t)}}),s?s:a["c"])}}function Qs(t){Ks=t}var $s=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var tu=function(t){$s(e,t);function e(e,r,n){var i=t.call(this,e)||this;i.feature=r;i.features=n;return i}return e}(wt["a"]);var eu=function(t){$s(e,t);function e(e){var r=this;var n=e||{};r=t.call(this,{attributions:n.attributions,interpolate:true,projection:undefined,state:Z["a"].READY,wrapX:n.wrapX!==undefined?n.wrapX:true})||this;r.on;r.once;r.un;r.loader_=a["c"];r.format_=n.format;r.overlaps_=n.overlaps===undefined?true:n.overlaps;r.url_=n.url;if(n.loader!==undefined){r.loader_=n.loader}else if(r.url_!==undefined){Object(l["a"])(r.format_,7);r.loader_=Js(r.url_,r.format_)}r.strategy_=n.strategy!==undefined?n.strategy:Vs;var i=n.useSpatialIndex!==undefined?n.useSpatialIndex:true;r.featuresRtree_=i?new ks:null;r.loadedExtentsRtree_=new ks;r.loadingExtentsCount_=0;r.nullGeometryFeatures_={};r.idIndex_={};r.uidIndex_={};r.featureChangeKeys_={};r.featuresCollection_=null;var o,s;if(Array.isArray(n.features)){s=n.features}else if(n.features){o=n.features;s=o.getArray()}if(!i&&o===undefined){o=new _e["a"](s)}if(s!==undefined){r.addFeaturesInternal(s)}if(o!==undefined){r.bindFeaturesCollection_(o)}return r}e.prototype.addFeature=function(t){this.addFeatureInternal(t);this.changed()};e.prototype.addFeatureInternal=function(t){var e=Object(s["c"])(t);if(!this.addToIndex_(e,t)){if(this.featuresCollection_){this.featuresCollection_.remove(t)}return}this.setupChangeEvents_(e,t);var r=t.getGeometry();if(r){var n=r.getExtent();if(this.featuresRtree_){this.featuresRtree_.insert(n,t)}}else{this.nullGeometryFeatures_[e]=t}this.dispatchEvent(new tu(Ws.ADDFEATURE,t))};e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Object(H["a"])(e,V["a"].CHANGE,this.handleFeatureChange_,this),Object(H["a"])(e,xt["a"].PROPERTYCHANGE,this.handleFeatureChange_,this)]};e.prototype.addToIndex_=function(t,e){var r=true;var n=e.getId();if(n!==undefined){if(!(n.toString()in this.idIndex_)){this.idIndex_[n.toString()]=e}else{r=false}}if(r){Object(l["a"])(!(t in this.uidIndex_),30);this.uidIndex_[t]=e}return r};e.prototype.addFeatures=function(t){this.addFeaturesInternal(t);this.changed()};e.prototype.addFeaturesInternal=function(t){var e=[];var r=[];var n=[];for(var i=0,o=t.length;i<o;i++){var a=t[i];var u=Object(s["c"])(a);if(this.addToIndex_(u,a)){r.push(a)}}for(var i=0,l=r.length;i<l;i++){var a=r[i];var u=Object(s["c"])(a);this.setupChangeEvents_(u,a);var h=a.getGeometry();if(h){var c=h.getExtent();e.push(c);n.push(a)}else{this.nullGeometryFeatures_[u]=a}}if(this.featuresRtree_){this.featuresRtree_.load(e,n)}for(var i=0,f=r.length;i<f;i++){this.dispatchEvent(new tu(Ws.ADDFEATURE,r[i]))}};e.prototype.bindFeaturesCollection_=function(t){var e=false;this.addEventListener(Ws.ADDFEATURE,(function(r){if(!e){e=true;t.push(r.feature);e=false}}));this.addEventListener(Ws.REMOVEFEATURE,(function(r){if(!e){e=true;t.remove(r.feature);e=false}}));t.addEventListener(ge["a"].ADD,function(t){if(!e){e=true;this.addFeature(t.element);e=false}}.bind(this));t.addEventListener(ge["a"].REMOVE,function(t){if(!e){e=true;this.removeFeature(t.element);e=false}}.bind(this));this.featuresCollection_=t};e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){var r=this.featureChangeKeys_[e];r.forEach(H["c"])}if(!this.featuresCollection_){this.featureChangeKeys_={};this.idIndex_={};this.uidIndex_={}}}else{if(this.featuresRtree_){var n=function(t){this.removeFeatureInternal(t)}.bind(this);this.featuresRtree_.forEach(n);for(var i in this.nullGeometryFeatures_){this.removeFeatureInternal(this.nullGeometryFeatures_[i])}}}if(this.featuresCollection_){this.featuresCollection_.clear()}if(this.featuresRtree_){this.featuresRtree_.clear()}this.nullGeometryFeatures_={};var o=new tu(Ws.CLEAR);this.dispatchEvent(o);this.changed()};e.prototype.forEachFeature=function(t){if(this.featuresRtree_){return this.featuresRtree_.forEach(t)}else if(this.featuresCollection_){this.featuresCollection_.forEach(t)}};e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,(function(r){var n=r.getGeometry();if(n.intersectsCoordinate(t)){return e(r)}else{return undefined}}))};e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_){return this.featuresRtree_.forEachInExtent(t,e)}else if(this.featuresCollection_){this.featuresCollection_.forEach(e)}};e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(r){var n=r.getGeometry();if(n.intersectsExtent(t)){var i=e(r);if(i){return i}}}))};e.prototype.getFeaturesCollection=function(){return this.featuresCollection_};e.prototype.getFeatures=function(){var t;if(this.featuresCollection_){t=this.featuresCollection_.getArray().slice(0)}else if(this.featuresRtree_){t=this.featuresRtree_.getAll();if(!Object(K["d"])(this.nullGeometryFeatures_)){Object(fn["c"])(t,Object(K["c"])(this.nullGeometryFeatures_))}}return t};e.prototype.getFeaturesAtCoordinate=function(t){var e=[];this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)}));return e};e.prototype.getFeaturesInExtent=function(t){if(this.featuresRtree_){return this.featuresRtree_.getInExtent(t)}else if(this.featuresCollection_){return this.featuresCollection_.getArray().slice(0)}else{return[]}};e.prototype.getClosestFeatureToCoordinate=function(t,e){var r=t[0];var n=t[1];var i=null;var o=[NaN,NaN];var s=Infinity;var u=[-Infinity,-Infinity,Infinity,Infinity];var l=e?e:a["b"];this.featuresRtree_.forEachInExtent(u,(function(t){if(l(t)){var e=t.getGeometry();var a=s;s=e.closestPointXY(r,n,o,s);if(s<a){i=t;var h=Math.sqrt(s);u[0]=r-h;u[1]=n-h;u[2]=r+h;u[3]=n+h}}}));return i};e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)};e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return e!==undefined?e:null};e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return e!==undefined?e:null};e.prototype.getFormat=function(){return this.format_};e.prototype.getOverlaps=function(){return this.overlaps_};e.prototype.getUrl=function(){return this.url_};e.prototype.handleFeatureChange_=function(t){var e=t.target;var r=Object(s["c"])(e);var n=e.getGeometry();if(!n){if(!(r in this.nullGeometryFeatures_)){if(this.featuresRtree_){this.featuresRtree_.remove(e)}this.nullGeometryFeatures_[r]=e}}else{var i=n.getExtent();if(r in this.nullGeometryFeatures_){delete this.nullGeometryFeatures_[r];if(this.featuresRtree_){this.featuresRtree_.insert(i,e)}}else{if(this.featuresRtree_){this.featuresRtree_.update(i,e)}}}var o=e.getId();if(o!==undefined){var a=o.toString();if(this.idIndex_[a]!==e){this.removeFromIdIndex_(e);this.idIndex_[a]=e}}else{this.removeFromIdIndex_(e);this.uidIndex_[r]=e}this.changed();this.dispatchEvent(new tu(Ws.CHANGEFEATURE,e))};e.prototype.hasFeature=function(t){var e=t.getId();if(e!==undefined){return e in this.idIndex_}else{return Object(s["c"])(t)in this.uidIndex_}};e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Object(K["d"])(this.nullGeometryFeatures_)};e.prototype.loadFeatures=function(t,e,r){var n=this.loadedExtentsRtree_;var i=this.strategy_(t,e,r);var o=function(t,o){var s=i[t];var u=n.forEachInExtent(s,(function(t){return Object(R["g"])(t.extent,s)}));if(!u){++a.loadingExtentsCount_;a.dispatchEvent(new tu(Ws.FEATURESLOADSTART));a.loader_.call(a,s,e,r,function(t){--this.loadingExtentsCount_;this.dispatchEvent(new tu(Ws.FEATURESLOADEND,undefined,t))}.bind(a),function(){--this.loadingExtentsCount_;this.dispatchEvent(new tu(Ws.FEATURESLOADERROR))}.bind(a));n.insert(s,{extent:s.slice()})}};var a=this;for(var s=0,u=i.length;s<u;++s){o(s,u)}this.loading=this.loader_.length<4?false:this.loadingExtentsCount_>0};e.prototype.refresh=function(){this.clear(true);this.loadedExtentsRtree_.clear();t.prototype.refresh.call(this)};e.prototype.removeLoadedExtent=function(t){var e=this.loadedExtentsRtree_;var r;e.forEachInExtent(t,(function(e){if(Object(R["o"])(e.extent,t)){r=e;return true}}));if(r){e.remove(r)}};e.prototype.removeFeature=function(t){if(!t){return}var e=Object(s["c"])(t);if(e in this.nullGeometryFeatures_){delete this.nullGeometryFeatures_[e]}else{if(this.featuresRtree_){this.featuresRtree_.remove(t)}}var r=this.removeFeatureInternal(t);if(r){this.changed()}};e.prototype.removeFeatureInternal=function(t){var e=Object(s["c"])(t);var r=this.featureChangeKeys_[e];if(!r){return}r.forEach(H["c"]);delete this.featureChangeKeys_[e];var n=t.getId();if(n!==undefined){delete this.idIndex_[n.toString()]}delete this.uidIndex_[e];this.dispatchEvent(new tu(Ws.REMOVEFEATURE,t));return t};e.prototype.removeFromIdIndex_=function(t){var e=false;for(var r in this.idIndex_){if(this.idIndex_[r]===t){delete this.idIndex_[r];e=true;break}}return e};e.prototype.setLoader=function(t){this.loader_=t};e.prototype.setUrl=function(t){Object(l["a"])(this.format_,7);this.url_=t;this.setLoader(Js(t,this.format_))};return e}(Ys);var ru=eu;var nu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var iu={RENDER_ORDER:"renderOrder"};var ou=function(t){nu(e,t);function e(e){var r=this;var n=e?e:{};var i=Object(K["a"])({},n);delete i.style;delete i.renderBuffer;delete i.updateWhileAnimating;delete i.updateWhileInteracting;r=t.call(this,i)||this;r.declutter_=n.declutter!==undefined?n.declutter:false;r.renderBuffer_=n.renderBuffer!==undefined?n.renderBuffer:100;r.style_=null;r.styleFunction_=undefined;r.setStyle(n.style);r.updateWhileAnimating_=n.updateWhileAnimating!==undefined?n.updateWhileAnimating:false;r.updateWhileInteracting_=n.updateWhileInteracting!==undefined?n.updateWhileInteracting:false;return r}e.prototype.getDeclutter=function(){return this.declutter_};e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)};e.prototype.getRenderBuffer=function(){return this.renderBuffer_};e.prototype.getRenderOrder=function(){return this.get(iu.RENDER_ORDER)};e.prototype.getStyle=function(){return this.style_};e.prototype.getStyleFunction=function(){return this.styleFunction_};e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_};e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_};e.prototype.renderDeclutter=function(t){if(!t.declutterTree){t.declutterTree=new Ds.a(9)}this.getRenderer().renderDeclutter(t)};e.prototype.setRenderOrder=function(t){this.set(iu.RENDER_ORDER,t)};e.prototype.setStyle=function(t){this.style_=t!==undefined?t:Ls;this.styleFunction_=t===null?undefined:Is(this.style_);this.changed()};return e}(tt);var au=ou;var su={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12};var uu=[su.FILL];var lu=[su.STROKE];var hu=[su.BEGIN_PATH];var cu=[su.CLOSE_PATH];var fu=su;var pu=r(15);var du=function(){function t(){}t.prototype.drawCustom=function(t,e,r,n){};t.prototype.drawGeometry=function(t){};t.prototype.setStyle=function(t){};t.prototype.drawCircle=function(t,e){};t.prototype.drawFeature=function(t,e){};t.prototype.drawGeometryCollection=function(t,e){};t.prototype.drawLineString=function(t,e){};t.prototype.drawMultiLineString=function(t,e){};t.prototype.drawMultiPoint=function(t,e){};t.prototype.drawMultiPolygon=function(t,e){};t.prototype.drawPoint=function(t,e){};t.prototype.drawPolygon=function(t,e){};t.prototype.drawText=function(t,e){};t.prototype.setFillStrokeStyle=function(t,e){};t.prototype.setImageStyle=function(t,e){};t.prototype.setTextStyle=function(t,e){};return t}();var vu=du;var _u=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var gu=function(t){_u(e,t);function e(e,r,n,i){var o=t.call(this)||this;o.tolerance=e;o.maxExtent=r;o.pixelRatio=i;o.maxLineWidth=0;o.resolution=n;o.beginGeometryInstruction1_=null;o.beginGeometryInstruction2_=null;o.bufferedMaxExtent_=null;o.instructions=[];o.coordinates=[];o.tmpCoordinate_=[];o.hitDetectionInstructions=[];o.state={};return o}e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return e==1?t:t.map((function(t){return t*e}))};e.prototype.appendFlatPointCoordinates=function(t,e){var r=this.getBufferedMaxExtent();var n=this.tmpCoordinate_;var i=this.coordinates;var o=i.length;for(var a=0,s=t.length;a<s;a+=e){n[0]=t[a];n[1]=t[a+1];if(Object(R["f"])(r,n)){i[o++]=n[0];i[o++]=n[1]}}return o};e.prototype.appendFlatLineCoordinates=function(t,e,r,n,i,o){var a=this.coordinates;var s=a.length;var u=this.getBufferedMaxExtent();if(o){e+=n}var l=t[e];var h=t[e+1];var c=this.tmpCoordinate_;var f=true;var p,d,v;for(p=e+n;p<r;p+=n){c[0]=t[p];c[1]=t[p+1];v=Object(R["i"])(u,c);if(v!==d){if(f){a[s++]=l;a[s++]=h;f=false}a[s++]=c[0];a[s++]=c[1]}else if(v===pu["a"].INTERSECTING){a[s++]=c[0];a[s++]=c[1];f=false}else{f=true}l=c[0];h=c[1];d=v}if(i&&f||p===e+n){a[s++]=l;a[s++]=h}return s};e.prototype.drawCustomCoordinates_=function(t,e,r,n,i){for(var o=0,a=r.length;o<a;++o){var s=r[o];var u=this.appendFlatLineCoordinates(t,e,s,n,false,false);i.push(u);e=s}return e};e.prototype.drawCustom=function(t,e,r,n){this.beginGeometry(t,e);var i=t.getType();var o=t.getStride();var a=this.coordinates.length;var s,u,l,h;var c;switch(i){case Ue.MULTI_POLYGON:s=t.getOrientedFlatCoordinates();h=[];var f=t.getEndss();c=0;for(var p=0,d=f.length;p<d;++p){var v=[];c=this.drawCustomCoordinates_(s,c,f[p],o,v);h.push(v)}this.instructions.push([fu.CUSTOM,a,h,t,r,hi]);this.hitDetectionInstructions.push([fu.CUSTOM,a,h,t,n||r,hi]);break;case Ue.POLYGON:case Ue.MULTI_LINE_STRING:l=[];s=i==Ue.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates();c=this.drawCustomCoordinates_(s,0,t.getEnds(),o,l);this.instructions.push([fu.CUSTOM,a,l,t,r,li]);this.hitDetectionInstructions.push([fu.CUSTOM,a,l,t,n||r,li]);break;case Ue.LINE_STRING:case Ue.CIRCLE:s=t.getFlatCoordinates();u=this.appendFlatLineCoordinates(s,0,s.length,o,false,false);this.instructions.push([fu.CUSTOM,a,u,t,r,ui]);this.hitDetectionInstructions.push([fu.CUSTOM,a,u,t,n||r,ui]);break;case Ue.MULTI_POINT:s=t.getFlatCoordinates();u=this.appendFlatPointCoordinates(s,o);if(u>a){this.instructions.push([fu.CUSTOM,a,u,t,r,ui]);this.hitDetectionInstructions.push([fu.CUSTOM,a,u,t,n||r,ui])}break;case Ue.POINT:s=t.getFlatCoordinates();this.coordinates.push(s[0],s[1]);u=this.coordinates.length;this.instructions.push([fu.CUSTOM,a,u,t,r]);this.hitDetectionInstructions.push([fu.CUSTOM,a,u,t,n||r]);break;default:}this.endGeometry(e)};e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[fu.BEGIN_GEOMETRY,e,0,t];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[fu.BEGIN_GEOMETRY,e,0,t];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)};e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}};e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var e;var r=t.length;var n;var i;var o=-1;for(e=0;e<r;++e){n=t[e];i=n[0];if(i==fu.END_GEOMETRY){o=e}else if(i==fu.BEGIN_GEOMETRY){n[2]=e;Object(fn["j"])(this.hitDetectionInstructions,o,e);o=-1}}};e.prototype.setFillStrokeStyle=function(t,e){var r=this.state;if(t){var n=t.getColor();r.fillStyle=ys(n?n:zt)}else{r.fillStyle=undefined}if(e){var i=e.getColor();r.strokeStyle=ys(i?i:Zt);var o=e.getLineCap();r.lineCap=o!==undefined?o:Yt;var a=e.getLineDash();r.lineDash=a?a.slice():Wt;var s=e.getLineDashOffset();r.lineDashOffset=s?s:Vt;var u=e.getLineJoin();r.lineJoin=u!==undefined?u:Xt;var l=e.getWidth();r.lineWidth=l!==undefined?l:Qt;var h=e.getMiterLimit();r.miterLimit=h!==undefined?h:qt;if(r.lineWidth>this.maxLineWidth){this.maxLineWidth=r.lineWidth;this.bufferedMaxExtent_=null}}else{r.strokeStyle=undefined;r.lineCap=undefined;r.lineDash=null;r.lineDashOffset=undefined;r.lineJoin=undefined;r.lineWidth=undefined;r.miterLimit=undefined}};e.prototype.createFill=function(t){var e=t.fillStyle;var r=[fu.SET_FILL_STYLE,e];if(typeof e!=="string"){r.push(true)}return r};e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))};e.prototype.createStroke=function(t){return[fu.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]};e.prototype.updateFillStyle=function(t,e){var r=t.fillStyle;if(typeof r!=="string"||t.currentFillStyle!=r){if(r!==undefined){this.instructions.push(e.call(this,t))}t.currentFillStyle=r}};e.prototype.updateStrokeStyle=function(t,e){var r=t.strokeStyle;var n=t.lineCap;var i=t.lineDash;var o=t.lineDashOffset;var a=t.lineJoin;var s=t.lineWidth;var u=t.miterLimit;if(t.currentStrokeStyle!=r||t.currentLineCap!=n||i!=t.currentLineDash&&!Object(fn["b"])(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=s||t.currentMiterLimit!=u){if(r!==undefined){e.call(this,t)}t.currentStrokeStyle=r;t.currentLineCap=n;t.currentLineDash=i;t.currentLineDashOffset=o;t.currentLineJoin=a;t.currentLineWidth=s;t.currentMiterLimit=u}};e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=null;var e=[fu.END_GEOMETRY,t];this.instructions.push(e);this.hitDetectionInstructions.push(e)};e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_){this.bufferedMaxExtent_=Object(R["d"])(this.maxExtent);if(this.maxLineWidth>0){var t=this.resolution*(this.maxLineWidth+1)/2;Object(R["c"])(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}}return this.bufferedMaxExtent_};return e}(vu);var yu=gu;var mu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Eu=function(t){mu(e,t);function e(e,r,n,i){var o=t.call(this,e,r,n,i)||this;o.hitDetectionImage_=null;o.image_=null;o.imagePixelRatio_=undefined;o.anchorX_=undefined;o.anchorY_=undefined;o.height_=undefined;o.opacity_=undefined;o.originX_=undefined;o.originY_=undefined;o.rotateWithView_=undefined;o.rotation_=undefined;o.scale_=undefined;o.width_=undefined;o.declutterImageWithText_=undefined;return o}e.prototype.drawPoint=function(t,e){if(!this.image_){return}this.beginGeometry(t,e);var r=t.getFlatCoordinates();var n=t.getStride();var i=this.coordinates.length;var o=this.appendFlatPointCoordinates(r,n);this.instructions.push([fu.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]);this.hitDetectionInstructions.push([fu.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]);this.endGeometry(e)};e.prototype.drawMultiPoint=function(t,e){if(!this.image_){return}this.beginGeometry(t,e);var r=t.getFlatCoordinates();var n=t.getStride();var i=this.coordinates.length;var o=this.appendFlatPointCoordinates(r,n);this.instructions.push([fu.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]);this.hitDetectionInstructions.push([fu.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]);this.endGeometry(e)};e.prototype.finish=function(){this.reverseHitDetectionInstructions();this.anchorX_=undefined;this.anchorY_=undefined;this.hitDetectionImage_=null;this.image_=null;this.imagePixelRatio_=undefined;this.height_=undefined;this.scale_=undefined;this.opacity_=undefined;this.originX_=undefined;this.originY_=undefined;this.rotateWithView_=undefined;this.rotation_=undefined;this.width_=undefined;return t.prototype.finish.call(this)};e.prototype.setImageStyle=function(t,e){var r=t.getAnchor();var n=t.getSize();var i=t.getHitDetectionImage();var o=t.getImage(this.pixelRatio);var a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio);this.anchorX_=r[0];this.anchorY_=r[1];this.hitDetectionImage_=i;this.image_=o;this.height_=n[1];this.opacity_=t.getOpacity();this.originX_=a[0]*this.imagePixelRatio_;this.originY_=a[1]*this.imagePixelRatio_;this.rotateWithView_=t.getRotateWithView();this.rotation_=t.getRotation();this.scale_=t.getScaleArray();this.width_=n[0];this.declutterImageWithText_=e};return e}(yu);var Ou=Eu;var bu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var xu=function(t){bu(e,t);function e(e,r,n,i){return t.call(this,e,r,n,i)||this}e.prototype.drawFlatCoordinates_=function(t,e,r,n){var i=this.coordinates.length;var o=this.appendFlatLineCoordinates(t,e,r,n,false,false);var a=[fu.MOVE_TO_LINE_TO,i,o];this.instructions.push(a);this.hitDetectionInstructions.push(a);return r};e.prototype.drawLineString=function(t,e){var r=this.state;var n=r.strokeStyle;var i=r.lineWidth;if(n===undefined||i===undefined){return}this.updateStrokeStyle(r,this.applyStroke);this.beginGeometry(t,e);this.hitDetectionInstructions.push([fu.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Wt,Vt],hu);var o=t.getFlatCoordinates();var a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a);this.hitDetectionInstructions.push(lu);this.endGeometry(e)};e.prototype.drawMultiLineString=function(t,e){var r=this.state;var n=r.strokeStyle;var i=r.lineWidth;if(n===undefined||i===undefined){return}this.updateStrokeStyle(r,this.applyStroke);this.beginGeometry(t,e);this.hitDetectionInstructions.push([fu.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],hu);var o=t.getEnds();var a=t.getFlatCoordinates();var s=t.getStride();var u=0;for(var l=0,h=o.length;l<h;++l){u=this.drawFlatCoordinates_(a,u,o[l],s)}this.hitDetectionInstructions.push(lu);this.endGeometry(e)};e.prototype.finish=function(){var e=this.state;if(e.lastStroke!=undefined&&e.lastStroke!=this.coordinates.length){this.instructions.push(lu)}this.reverseHitDetectionInstructions();this.state=null;return t.prototype.finish.call(this)};e.prototype.applyStroke=function(e){if(e.lastStroke!=undefined&&e.lastStroke!=this.coordinates.length){this.instructions.push(lu);e.lastStroke=this.coordinates.length}e.lastStroke=0;t.prototype.applyStroke.call(this,e);this.instructions.push(hu)};return e}(yu);var wu=xu;var Mu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Su=function(t){Mu(e,t);function e(e,r,n,i){return t.call(this,e,r,n,i)||this}e.prototype.drawFlatCoordinatess_=function(t,e,r,n){var i=this.state;var o=i.fillStyle!==undefined;var a=i.strokeStyle!==undefined;var s=r.length;this.instructions.push(hu);this.hitDetectionInstructions.push(hu);for(var u=0;u<s;++u){var l=r[u];var h=this.coordinates.length;var c=this.appendFlatLineCoordinates(t,e,l,n,true,!a);var f=[fu.MOVE_TO_LINE_TO,h,c];this.instructions.push(f);this.hitDetectionInstructions.push(f);if(a){this.instructions.push(cu);this.hitDetectionInstructions.push(cu)}e=l}if(o){this.instructions.push(uu);this.hitDetectionInstructions.push(uu)}if(a){this.instructions.push(lu);this.hitDetectionInstructions.push(lu)}return e};e.prototype.drawCircle=function(t,e){var r=this.state;var n=r.fillStyle;var i=r.strokeStyle;if(n===undefined&&i===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(r.fillStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_FILL_STYLE,zt])}if(r.strokeStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset])}var o=t.getFlatCoordinates();var a=t.getStride();var s=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,false,false);var u=[fu.CIRCLE,s];this.instructions.push(hu,u);this.hitDetectionInstructions.push(hu,u);if(r.fillStyle!==undefined){this.instructions.push(uu);this.hitDetectionInstructions.push(uu)}if(r.strokeStyle!==undefined){this.instructions.push(lu);this.hitDetectionInstructions.push(lu)}this.endGeometry(e)};e.prototype.drawPolygon=function(t,e){var r=this.state;var n=r.fillStyle;var i=r.strokeStyle;if(n===undefined&&i===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(r.fillStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_FILL_STYLE,zt])}if(r.strokeStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset])}var o=t.getEnds();var a=t.getOrientedFlatCoordinates();var s=t.getStride();this.drawFlatCoordinatess_(a,0,o,s);this.endGeometry(e)};e.prototype.drawMultiPolygon=function(t,e){var r=this.state;var n=r.fillStyle;var i=r.strokeStyle;if(n===undefined&&i===undefined){return}this.setFillStrokeStyles_();this.beginGeometry(t,e);if(r.fillStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_FILL_STYLE,zt])}if(r.strokeStyle!==undefined){this.hitDetectionInstructions.push([fu.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset])}var o=t.getEndss();var a=t.getOrientedFlatCoordinates();var s=t.getStride();var u=0;for(var l=0,h=o.length;l<h;++l){u=this.drawFlatCoordinatess_(a,u,o[l],s)}this.endGeometry(e)};e.prototype.finish=function(){this.reverseHitDetectionInstructions();this.state=null;var e=this.tolerance;if(e!==0){var r=this.coordinates;for(var n=0,i=r.length;n<i;++n){r[n]=ii(r[n],e)}}return t.prototype.finish.call(this)};e.prototype.setFillStrokeStyles_=function(){var t=this.state;var e=t.fillStyle;if(e!==undefined){this.updateFillStyle(t,this.createFill)}if(t.strokeStyle!==undefined){this.updateStrokeStyle(t,this.applyStroke)}};return e}(yu);var Cu=Su;var Ru={POINT:"point",LINE:"line"};function Tu(t,e,r,n,i){var o=r;var a=r;var s=0;var u=0;var l=r;var h,c,f,p,d,v,_,g,y,m;for(c=r;c<n;c+=i){var E=e[c];var O=e[c+1];if(d!==undefined){y=E-d;m=O-v;p=Math.sqrt(y*y+m*m);if(_!==undefined){u+=f;h=Math.acos((_*y+g*m)/(f*p));if(h>t){if(u>s){s=u;o=l;a=c}u=0;l=c-i}}f=p;_=y;g=m}d=E;v=O}u+=p;return u>s?[l,c]:[o,a]}var Iu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Pu={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};var Lu=function(t){Iu(e,t);function e(e,r,n,i){var o=t.call(this,e,r,n,i)||this;o.labels_=null;o.text_="";o.textOffsetX_=0;o.textOffsetY_=0;o.textRotateWithView_=undefined;o.textRotation_=0;o.textFillState_=null;o.fillStates={};o.textStrokeState_=null;o.strokeStates={};o.textState_={};o.textStates={};o.textKey_="";o.fillKey_="";o.strokeKey_="";o.declutterImageWithText_=undefined;return o}e.prototype.finish=function(){var e=t.prototype.finish.call(this);e.textStates=this.textStates;e.fillStates=this.fillStates;e.strokeStates=this.strokeStates;return e};e.prototype.drawText=function(t,e){var r=this.textFillState_;var n=this.textStrokeState_;var i=this.textState_;if(this.text_===""||!i||!r&&!n){return}var o=this.coordinates;var a=o.length;var s=t.getType();var u=null;var l=t.getStride();if(i.placement===Ru.LINE&&(s==Ue.LINE_STRING||s==Ue.MULTI_LINE_STRING||s==Ue.POLYGON||s==Ue.MULTI_POLYGON)){if(!Object(R["E"])(this.getBufferedMaxExtent(),t.getExtent())){return}var h=void 0;u=t.getFlatCoordinates();if(s==Ue.LINE_STRING){h=[u.length]}else if(s==Ue.MULTI_LINE_STRING){h=t.getEnds()}else if(s==Ue.POLYGON){h=t.getEnds().slice(0,1)}else if(s==Ue.MULTI_POLYGON){var c=t.getEndss();h=[];for(var f=0,p=c.length;f<p;++f){h.push(c[f][0])}}this.beginGeometry(t,e);var d=i.textAlign;var v=0;var _=void 0;for(var g=0,y=h.length;g<y;++g){if(d==undefined){var m=Tu(i.maxAngle,u,v,h[g],l);v=m[0];_=m[1]}else{_=h[g]}for(var f=v;f<_;f+=l){o.push(u[f],u[f+1])}var E=o.length;v=h[g];this.drawChars_(a,E);a=E}this.endGeometry(e)}else{var O=i.overflow?null:[];switch(s){case Ue.POINT:case Ue.MULTI_POINT:u=t.getFlatCoordinates();break;case Ue.LINE_STRING:u=t.getFlatMidpoint();break;case Ue.CIRCLE:u=t.getCenter();break;case Ue.MULTI_LINE_STRING:u=t.getFlatMidpoints();l=2;break;case Ue.POLYGON:u=t.getFlatInteriorPoint();if(!i.overflow){O.push(u[2]/this.resolution)}l=3;break;case Ue.MULTI_POLYGON:var b=t.getFlatInteriorPoints();u=[];for(var f=0,p=b.length;f<p;f+=3){if(!i.overflow){O.push(b[f+2]/this.resolution)}u.push(b[f],b[f+1])}if(u.length===0){return}l=2;break;default:}var E=this.appendFlatPointCoordinates(u,l);if(E===a){return}if(O&&(E-a)/2!==u.length/l){var x=a/2;O=O.filter((function(t,e){var r=o[(x+e)*2]===u[e*l]&&o[(x+e)*2+1]===u[e*l+1];if(!r){--x}return r}))}this.saveTextStates_();if(i.backgroundFill||i.backgroundStroke){this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke);if(i.backgroundFill){this.updateFillStyle(this.state,this.createFill);this.hitDetectionInstructions.push(this.createFill(this.state))}if(i.backgroundStroke){this.updateStrokeStyle(this.state,this.applyStroke);this.hitDetectionInstructions.push(this.createStroke(this.state))}}this.beginGeometry(t,e);var w=i.padding;if(w!=Jt&&(i.scale[0]<0||i.scale[1]<0)){var M=i.padding[0];var S=i.padding[1];var C=i.padding[2];var T=i.padding[3];if(i.scale[0]<0){S=-S;T=-T}if(i.scale[1]<0){M=-M;C=-C}w=[M,S,C,T]}var I=this.pixelRatio;this.instructions.push([fu.DRAW_IMAGE,a,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,w==Jt?Jt:w.map((function(t){return t*I})),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,O]);var P=1/I;this.hitDetectionInstructions.push([fu.DRAW_IMAGE,a,E,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[P,P],NaN,this.declutterImageWithText_,w,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,O]);this.endGeometry(e)}};e.prototype.saveTextStates_=function(){var t=this.textStrokeState_;var e=this.textState_;var r=this.textFillState_;var n=this.strokeKey_;if(t){if(!(n in this.strokeStates)){this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}}}var i=this.textKey_;if(!(i in this.textStates)){this.textStates[i]={font:e.font,textAlign:e.textAlign||Kt,textBaseline:e.textBaseline||Ht,scale:e.scale}}var o=this.fillKey_;if(r){if(!(o in this.fillStates)){this.fillStates[o]={fillStyle:r.fillStyle}}}};e.prototype.drawChars_=function(t,e){var r=this.textStrokeState_;var n=this.textState_;var i=this.strokeKey_;var o=this.textKey_;var a=this.fillKey_;this.saveTextStates_();var s=this.pixelRatio;var u=Pu[n.textBaseline];var l=this.textOffsetY_*s;var h=this.text_;var c=r?r.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([fu.DRAW_CHARS,t,e,u,n.overflow,a,n.maxAngle,s,l,i,c*s,h,o,1]);this.hitDetectionInstructions.push([fu.DRAW_CHARS,t,e,u,n.overflow,a,n.maxAngle,1,l,i,c,h,o,1/s])};e.prototype.setTextStyle=function(t,e){var r,n,i;if(!t){this.text_=""}else{var o=t.getFill();if(!o){n=null;this.textFillState_=n}else{n=this.textFillState_;if(!n){n={};this.textFillState_=n}n.fillStyle=ys(o.getColor()||zt)}var a=t.getStroke();if(!a){i=null;this.textStrokeState_=i}else{i=this.textStrokeState_;if(!i){i={};this.textStrokeState_=i}var u=a.getLineDash();var l=a.getLineDashOffset();var h=a.getWidth();var c=a.getMiterLimit();i.lineCap=a.getLineCap()||Yt;i.lineDash=u?u.slice():Wt;i.lineDashOffset=l===undefined?Vt:l;i.lineJoin=a.getLineJoin()||Xt;i.lineWidth=h===undefined?Qt:h;i.miterLimit=c===undefined?qt:c;i.strokeStyle=ys(a.getColor()||Zt)}r=this.textState_;var f=t.getFont()||Bt;ie(f);var p=t.getScaleArray();r.overflow=t.getOverflow();r.font=f;r.maxAngle=t.getMaxAngle();r.placement=t.getPlacement();r.textAlign=t.getTextAlign();r.textBaseline=t.getTextBaseline()||Ht;r.backgroundFill=t.getBackgroundFill();r.backgroundStroke=t.getBackgroundStroke();r.padding=t.getPadding()||Jt;r.scale=p===undefined?[1,1]:p;var d=t.getOffsetX();var v=t.getOffsetY();var _=t.getRotateWithView();var g=t.getRotation();this.text_=t.getText()||"";this.textOffsetX_=d===undefined?0:d;this.textOffsetY_=v===undefined?0:v;this.textRotateWithView_=_===undefined?false:_;this.textRotation_=g===undefined?0:g;this.strokeKey_=i?(typeof i.strokeStyle=="string"?i.strokeStyle:Object(s["c"])(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"";this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.textBaseline||"?");this.fillKey_=n?typeof n.fillStyle=="string"?n.fillStyle:"|"+Object(s["c"])(n.fillStyle):""}this.declutterImageWithText_=e};return e}(yu);var Au=Lu;var ju={Circle:Cu,Default:yu,Image:Ou,LineString:wu,Polygon:Cu,Text:Au};var Nu=function(){function t(t,e,r,n){this.tolerance_=t;this.maxExtent_=e;this.pixelRatio_=n;this.resolution_=r;this.buildersByZIndex_={}}t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var r=this.buildersByZIndex_[e];for(var n in r){var i=r[n].finish();t[e][n]=i}}return t};t.prototype.getBuilder=function(t,e){var r=t!==undefined?t.toString():"0";var n=this.buildersByZIndex_[r];if(n===undefined){n={};this.buildersByZIndex_[r]=n}var i=n[e];if(i===undefined){var o=ju[e];i=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_);n[e]=i}return i};return t}();var Fu=Nu;var Du=r(25);var Gu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ku=function(t){Gu(e,t);function e(e){var r=t.call(this)||this;r.boundHandleImageChange_=r.handleImageChange_.bind(r);r.layer_=e;r.declutterExecutorGroup=null;return r}e.prototype.getFeatures=function(t){return Object(s["b"])()};e.prototype.prepareFrame=function(t){return Object(s["b"])()};e.prototype.renderFrame=function(t,e){return Object(s["b"])()};e.prototype.loadedTileCallback=function(t,e,r){if(!t[e]){t[e]={}}t[e][r.tileCoord.toString()]=r;return undefined};e.prototype.createLoadedTileFinder=function(t,e,r){return function(n,i){var o=this.loadedTileCallback.bind(this,r,n);return t.forEachLoadedTile(e,n,i,o)}.bind(this)};e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){return undefined};e.prototype.getDataAtPixel=function(t,e,r){return null};e.prototype.getLayer=function(){return this.layer_};e.prototype.handleFontsChanged=function(){};e.prototype.handleImageChange_=function(t){var e=t.target;if(e.getState()===ts.LOADED){this.renderIfReadyAndVisible()}};e.prototype.loadImage=function(t){var e=t.getState();if(e!=ts.LOADED&&e!=ts.ERROR){t.addEventListener(V["a"].CHANGE,this.boundHandleImageChange_)}if(e==ts.IDLE){t.load();e=t.getState()}return e==ts.LOADED};e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();if(t.getVisible()&&t.getSourceState()==Z["a"].READY){t.changed()}};return e}(Du["default"]);var Uu=ku;var Bu=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var zu=function(t){Bu(e,t);function e(e){var r=t.call(this,e)||this;r.container=null;r.renderedResolution;r.tempTransform=c();r.pixelTransform=c();r.inversePixelTransform=c();r.context=null;r.containerReused=false;r.pixelContext_=null;return r}e.prototype.getBackground=function(t){var e=this.getLayer();var r=e.getBackground();if(typeof r==="function"){r=r(t.viewState.resolution)}return r||undefined};e.prototype.useContainer=function(t,e,r,n){var i=this.getLayer().getClassName();var o,a;if(t&&t.className===i&&t.style.opacity===""&&r===1&&(!n||t.style.backgroundColor&&Object(fn["b"])(N(t.style.backgroundColor),N(n)))){var s=t.firstElementChild;if(s instanceof HTMLCanvasElement){a=s.getContext("2d")}}if(a&&a.canvas.style.transform===e){this.container=t;this.context=a;this.containerReused=true}else if(this.containerReused){this.container=null;this.context=null;this.containerReused=false}if(!this.container){o=document.createElement("div");o.className=i;var u=o.style;u.position="absolute";u.width="100%";u.height="100%";if(n){u.backgroundColor=n}a=Object(Ut["a"])();var s=a.canvas;o.appendChild(s);u=s.style;u.position="absolute";u.left="0";u.transformOrigin="top left";this.container=o;this.context=a}};e.prototype.clipUnrotated=function(t,e,r){var n=Object(R["B"])(r);var i=Object(R["C"])(r);var o=Object(R["v"])(r);var a=Object(R["u"])(r);_(e.coordinateToPixelTransform,n);_(e.coordinateToPixelTransform,i);_(e.coordinateToPixelTransform,o);_(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;_(s,n);_(s,i);_(s,o);_(s,a);t.save();t.beginPath();t.moveTo(Math.round(n[0]),Math.round(n[1]));t.lineTo(Math.round(i[0]),Math.round(i[1]));t.lineTo(Math.round(o[0]),Math.round(o[1]));t.lineTo(Math.round(a[0]),Math.round(a[1]));t.clip()};e.prototype.dispatchRenderEvent_=function(t,e,r){var n=this.getLayer();if(n.hasListener(t)){var i=new Ct(t,this.inversePixelTransform,r,e);n.dispatchEvent(i)}};e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(q.PRERENDER,t,e)};e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(q.POSTRENDER,t,e)};e.prototype.getRenderTransform=function(t,e,r,n,i,o,a){var s=i/2;var u=o/2;var l=n/e;var h=-l;var c=-t[0]+a;var f=-t[1];return O(this.tempTransform,s,u,l,h,-r,c,f)};e.prototype.getDataAtPixel=function(t,e,r){var n=_(this.inversePixelTransform,t.slice());var i=this.context;var o=this.getLayer();var a=o.getExtent();if(a){var s=_(e.pixelToCoordinateTransform,t.slice());if(!Object(R["f"])(a,s)){return null}}var u=Math.round(n[0]);var l=Math.round(n[1]);var h=this.pixelContext_;if(!h){var c=document.createElement("canvas");c.width=1;c.height=1;h=c.getContext("2d");this.pixelContext_=h}h.clearRect(0,0,1,1);var f;try{h.drawImage(i.canvas,u,l,1,1,0,0,1,1);f=h.getImageData(0,0,1,1).data}catch(t){if(t.name==="SecurityError"){this.pixelContext_=null;return new Uint8Array}return f}if(f[3]===0){return null}return f};return e}(Uu);var Yu=zu;var Wu={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function Vu(t,e,r,n,i,o,a,s,u,l,h,c){var f=t[e];var p=t[e+1];var d=0;var v=0;var _=0;var g=0;function y(){d=f;v=p;e+=n;f=t[e];p=t[e+1];g+=_;_=Math.sqrt((f-d)*(f-d)+(p-v)*(p-v))}do{y()}while(e<r-n&&g+_<o);var m=_===0?0:(o-g)/_;var E=Object(T["e"])(d,f,m);var O=Object(T["e"])(v,p,m);var b=e-n;var x=g;var w=o+s*u(l,i,h);while(e<r-n&&g+_<w){y()}m=_===0?0:(w-g)/_;var M=Object(T["e"])(d,f,m);var S=Object(T["e"])(v,p,m);var C;if(c){var R=[E,O,M,S];Tn(R,0,4,2,c,R,R);C=R[0]>R[2]}else{C=E>M}var I=Math.PI;var P=[];var L=b+n===e;e=b;_=0;g=x;f=t[e];p=t[e+1];var A;if(L){y();A=Math.atan2(p-v,f-d);if(C){A+=A>0?-I:I}var j=(M+E)/2;var N=(S+O)/2;P[0]=[j,N,(w-o)/2,A,i];return P}for(var F=0,D=i.length;F<D;){y();var G=Math.atan2(p-v,f-d);if(C){G+=G>0?-I:I}if(A!==undefined){var k=G-A;k+=k>I?-2*I:k<-I?2*I:0;if(Math.abs(k)>a){return null}}A=G;var U=F;var B=0;for(;F<D;++F){var z=C?D-F-1:F;var Y=s*u(l,i[z],h);if(e+n<r&&g+_<o+B+Y/2){break}B+=Y}if(F===U){continue}var W=C?i.substring(D-U,D-F):i.substring(U,F);m=_===0?0:(o+B/2-g)/_;var j=Object(T["e"])(d,f,m);var N=Object(T["e"])(v,p,m);P.push([j,N,B/2,G,W]);o+=B}return P}function Xu(t,e,r,n){var i=t[e];var o=t[e+1];var a=0;for(var s=e+n;s<r;s+=n){var u=t[s];var l=t[s+1];a+=Math.sqrt((u-i)*(u-i)+(l-o)*(l-o));i=u;o=l}return a}function qu(t,e,r,n){var i=Xu(t,e,r,n);var o=t[r-n]-t[e];var a=t[r-n+1]-t[e+1];i+=Math.sqrt(o*o+a*a);return i}var Zu=Object(R["j"])();var Ku=[];var Hu=[];var Ju=[];var Qu=[];function $u(t){return t[3].declutterBox}var tl=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function el(t,e){if((e==="start"||e==="end")&&!tl.test(t)){e=e==="start"?"left":"right"}return Pu[e]}var rl=function(){function t(t,e,r,n){this.overlaps=r;this.pixelRatio=e;this.resolution=t;this.alignFill_;this.instructions=n.instructions;this.coordinates=n.coordinates;this.coordinateCache_={};this.renderedTransform_=c();this.hitDetectionInstructions=n.hitDetectionInstructions;this.pixelCoordinates_=null;this.viewRotation_=0;this.fillStates=n.fillStates||{};this.strokeStates=n.strokeStates||{};this.textStates=n.textStates||{};this.widths_={};this.labels_={}}t.prototype.createLabel=function(t,e,r,n){var i=t+e+r+n;if(this.labels_[i]){return this.labels_[i]}var o=n?this.strokeStates[n]:null;var a=r?this.fillStates[r]:null;var s=this.textStates[e];var l=this.pixelRatio;var h=[s.scale[0]*l,s.scale[1]*l];var c=el(t,s.textAlign||Kt);var f=n&&o.lineWidth?o.lineWidth:0;var p=t.split("\n");var d=p.length;var v=[];var _=le(s.font,p,v);var g=oe(s.font);var y=g*d;var m=_+f;var E=[];var O=(m+2)*h[0];var b=(y+f)*h[1];var x={width:O<0?Math.floor(O):Math.ceil(O),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:E};if(h[0]!=1||h[1]!=1){E.push("scale",h)}E.push("font",s.font);if(n){E.push("strokeStyle",o.strokeStyle);E.push("lineWidth",f);E.push("lineCap",o.lineCap);E.push("lineJoin",o.lineJoin);E.push("miterLimit",o.miterLimit);var w=u["g"]?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;if(w.prototype.setLineDash){E.push("setLineDash",[o.lineDash]);E.push("lineDashOffset",o.lineDashOffset)}}if(r){E.push("fillStyle",a.fillStyle)}E.push("textBaseline","middle");E.push("textAlign","center");var M=.5-c;var S=c*m+M*f;var C;if(n){for(C=0;C<d;++C){E.push("strokeText",[p[C],S+M*v[C],.5*(f+g)+C*g])}}if(r){for(C=0;C<d;++C){E.push("fillText",[p[C],S+M*v[C],.5*(f+g)+C*g])}}this.labels_[i]=x;return x};t.prototype.replayTextBackground_=function(t,e,r,n,i,o,a){t.beginPath();t.moveTo.apply(t,e);t.lineTo.apply(t,r);t.lineTo.apply(t,n);t.lineTo.apply(t,i);t.lineTo.apply(t,e);if(o){this.alignFill_=o[2];this.fill_(t)}if(a){this.setStrokeStyle_(t,a);t.stroke()}};t.prototype.calculateImageOrLabelDimensions_=function(t,e,r,n,i,o,a,s,u,l,h,f,p,d,v,g){a*=f[0];s*=f[1];var y=r-a;var m=n-s;var E=i+u>t?t-u:i;var b=o+l>e?e-l:o;var x=d[3]+E*f[0]+d[1];var w=d[0]+b*f[1]+d[2];var M=y-d[3];var S=m-d[0];if(v||h!==0){Ku[0]=M;Qu[0]=M;Ku[1]=S;Hu[1]=S;Hu[0]=M+x;Ju[0]=Hu[0];Ju[1]=S+w;Qu[1]=Ju[1]}var C;if(h!==0){C=O(c(),r,n,1,1,h,-r,-n);_(C,Ku);_(C,Hu);_(C,Ju);_(C,Qu);Object(R["k"])(Math.min(Ku[0],Hu[0],Ju[0],Qu[0]),Math.min(Ku[1],Hu[1],Ju[1],Qu[1]),Math.max(Ku[0],Hu[0],Ju[0],Qu[0]),Math.max(Ku[1],Hu[1],Ju[1],Qu[1]),Zu)}else{Object(R["k"])(Math.min(M,M+x),Math.min(S,S+w),Math.max(M,M+x),Math.max(S,S+w),Zu)}if(p){y=Math.round(y);m=Math.round(m)}return{drawImageX:y,drawImageY:m,drawImageW:E,drawImageH:b,originX:u,originY:l,declutterBox:{minX:Zu[0],minY:Zu[1],maxX:Zu[2],maxY:Zu[3],value:g},canvasTransform:C,scale:f}};t.prototype.replayImageOrLabel_=function(t,e,r,n,i,o,a){var s=!!(o||a);var u=n.declutterBox;var l=t.canvas;var h=a?a[2]*n.scale[0]/2:0;var c=u.minX-h<=l.width/e&&u.maxX+h>=0&&u.minY-h<=l.height/e&&u.maxY+h>=0;if(c){if(s){this.replayTextBackground_(t,Ku,Hu,Ju,Qu,o,a)}ce(t,n.canvasTransform,i,r,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)}return true};t.prototype.fill_=function(t){if(this.alignFill_){var e=_(this.renderedTransform_,[0,0]);var r=512*this.pixelRatio;t.save();t.translate(e[0]%r,e[1]%r);t.rotate(this.viewRotation_)}t.fill();if(this.alignFill_){t.restore()}};t.prototype.setStrokeStyle_=function(t,e){t["strokeStyle"]=e[1];t.lineWidth=e[2];t.lineCap=e[3];t.lineJoin=e[4];t.miterLimit=e[5];if(t.setLineDash){t.lineDashOffset=e[7];t.setLineDash(e[6])}};t.prototype.drawLabelWithPointPlacement_=function(t,e,r,n){var i=this.textStates[e];var o=this.createLabel(t,e,n,r);var a=this.strokeStates[r];var s=this.pixelRatio;var u=el(t,i.textAlign||Kt);var l=Pu[i.textBaseline||Ht];var h=a&&a.lineWidth?a.lineWidth:0;var c=o.width/s-2*i.scale[0];var f=u*c+2*(.5-u)*h;var p=l*o.height/s+2*(.5-l)*h;return{label:o,anchorX:f,anchorY:p}};t.prototype.execute_=function(t,e,r,n,i,o,a,s){var u;if(this.pixelCoordinates_&&Object(fn["b"])(r,this.renderedTransform_)){u=this.pixelCoordinates_}else{if(!this.pixelCoordinates_){this.pixelCoordinates_=[]}u=Rn(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_);v(this.renderedTransform_,r)}var l=0;var h=n.length;var c=0;var f;var p,d,_,g,y,m,E,O,b,x,w;var M=0;var S=0;var C=null;var T=null;var I=this.coordinateCache_;var P=this.viewRotation_;var L=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12;var A={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P};var j=this.instructions!=n||this.overlaps?0:200;var N;var F,D,G;while(l<h){var k=n[l];var U=k[0];switch(U){case fu.BEGIN_GEOMETRY:N=k[1];G=k[3];if(!N.getGeometry()){l=k[2]}else if(a!==undefined&&!Object(R["E"])(a,G.getExtent())){l=k[2]+1}else{++l}break;case fu.BEGIN_PATH:if(M>j){this.fill_(t);M=0}if(S>j){t.stroke();S=0}if(!M&&!S){t.beginPath();_=NaN;g=NaN}++l;break;case fu.CIRCLE:c=k[1];var B=u[c];var z=u[c+1];var Y=u[c+2];var W=u[c+3];var V=Y-B;var X=W-z;var q=Math.sqrt(V*V+X*X);t.moveTo(B+q,z);t.arc(B,z,q,0,2*Math.PI,true);++l;break;case fu.CLOSE_PATH:t.closePath();++l;break;case fu.CUSTOM:c=k[1];f=k[2];var Z=k[3];var K=k[4];var H=k.length==6?k[5]:undefined;A.geometry=Z;A.feature=N;if(!(l in I)){I[l]=[]}var J=I[l];if(H){H(u,c,f,2,J)}else{J[0]=u[c];J[1]=u[c+1];J.length=2}K(J,A);++l;break;case fu.DRAW_IMAGE:c=k[1];f=k[2];E=k[3];p=k[4];d=k[5];var Q=k[6];var $=k[7];var tt=k[8];var et=k[9];var rt=k[10];var nt=k[11];var it=k[12];var ot=k[13];var at=k[14];if(!E&&k.length>=19){O=k[18];b=k[19];x=k[20];w=k[21];var st=this.drawLabelWithPointPlacement_(O,b,x,w);E=st.label;k[3]=E;var ut=k[22];p=(st.anchorX-ut)*this.pixelRatio;k[4]=p;var lt=k[23];d=(st.anchorY-lt)*this.pixelRatio;k[5]=d;Q=E.height;k[6]=Q;ot=E.width;k[13]=ot}var ht=void 0;if(k.length>24){ht=k[24]}var ct=void 0,ft=void 0,pt=void 0;if(k.length>16){ct=k[15];ft=k[16];pt=k[17]}else{ct=Jt;ft=false;pt=false}if(rt&&L){nt+=P}else if(!rt&&!L){nt-=P}var dt=0;for(;c<f;c+=2){if(ht&&ht[dt++]<ot/this.pixelRatio){continue}var vt=this.calculateImageOrLabelDimensions_(E.width,E.height,u[c],u[c+1],ot,Q,p,d,tt,et,nt,it,i,ct,ft||pt,N);var _t=[t,e,E,vt,$,ft?C:null,pt?T:null];var gt=void 0;var yt=void 0;if(s&&at){var mt=f-c;if(!at[mt]){at[mt]=_t;continue}gt=at[mt];delete at[mt];yt=$u(gt);if(s.collides(yt)){continue}}if(s&&s.collides(vt.declutterBox)){continue}if(gt){if(s){s.insert(yt)}this.replayImageOrLabel_.apply(this,gt)}if(s){s.insert(vt.declutterBox)}this.replayImageOrLabel_.apply(this,_t)}++l;break;case fu.DRAW_CHARS:var Et=k[1];var Ot=k[2];var bt=k[3];var xt=k[4];w=k[5];var wt=k[6];var Mt=k[7];var St=k[8];x=k[9];var Ct=k[10];O=k[11];b=k[12];var Rt=[k[13],k[13]];var Tt=this.textStates[b];var It=Tt.font;var Pt=[Tt.scale[0]*Mt,Tt.scale[1]*Mt];var Lt=void 0;if(It in this.widths_){Lt=this.widths_[It]}else{Lt={};this.widths_[It]=Lt}var At=Xu(u,Et,Ot,2);var jt=Math.abs(Pt[0])*ue(It,O,Lt);if(xt||jt<=At){var Nt=this.textStates[b].textAlign;var Ft=(At-jt)*Pu[Nt];var Dt=Vu(u,Et,Ot,2,O,Ft,wt,Math.abs(Pt[0]),ue,It,Lt,L?0:this.viewRotation_);t:if(Dt){var Gt=[];var kt=void 0,Ut=void 0,Bt=void 0,zt=void 0,Yt=void 0;if(x){for(kt=0,Ut=Dt.length;kt<Ut;++kt){Yt=Dt[kt];Bt=Yt[4];zt=this.createLabel(Bt,b,"",x);p=Yt[2]+(Pt[0]<0?-Ct:Ct);d=bt*zt.height+(.5-bt)*2*Ct*Pt[1]/Pt[0]-St;var vt=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Yt[0],Yt[1],zt.width,zt.height,p,d,0,0,Yt[3],Rt,false,Jt,false,N);if(s&&s.collides(vt.declutterBox)){break t}Gt.push([t,e,zt,vt,1,null,null])}}if(w){for(kt=0,Ut=Dt.length;kt<Ut;++kt){Yt=Dt[kt];Bt=Yt[4];zt=this.createLabel(Bt,b,w,"");p=Yt[2];d=bt*zt.height-St;var vt=this.calculateImageOrLabelDimensions_(zt.width,zt.height,Yt[0],Yt[1],zt.width,zt.height,p,d,0,0,Yt[3],Rt,false,Jt,false,N);if(s&&s.collides(vt.declutterBox)){break t}Gt.push([t,e,zt,vt,1,null,null])}}if(s){s.load(Gt.map($u))}for(var Wt=0,Vt=Gt.length;Wt<Vt;++Wt){this.replayImageOrLabel_.apply(this,Gt[Wt])}}}++l;break;case fu.END_GEOMETRY:if(o!==undefined){N=k[1];var Xt=o(N,G);if(Xt){return Xt}}++l;break;case fu.FILL:if(j){M++}else{this.fill_(t)}++l;break;case fu.MOVE_TO_LINE_TO:c=k[1];f=k[2];F=u[c];D=u[c+1];y=F+.5|0;m=D+.5|0;if(y!==_||m!==g){t.moveTo(F,D);_=y;g=m}for(c+=2;c<f;c+=2){F=u[c];D=u[c+1];y=F+.5|0;m=D+.5|0;if(c==f-2||y!==_||m!==g){t.lineTo(F,D);_=y;g=m}}++l;break;case fu.SET_FILL_STYLE:C=k;this.alignFill_=k[2];if(M){this.fill_(t);M=0;if(S){t.stroke();S=0}}t.fillStyle=k[1];++l;break;case fu.SET_STROKE_STYLE:T=k;if(S){t.stroke();S=0}this.setStrokeStyle_(t,k);++l;break;case fu.STROKE:if(j){S++}else{t.stroke()}++l;break;default:++l;break}}if(M){this.fill_(t)}if(S){t.stroke()}return undefined};t.prototype.execute=function(t,e,r,n,i,o){this.viewRotation_=n;this.execute_(t,e,r,this.instructions,i,undefined,undefined,o)};t.prototype.executeHitDetection=function(t,e,r,n,i){this.viewRotation_=r;return this.execute_(t,1,e,this.hitDetectionInstructions,true,n,i)};return t}();var nl=rl;var il=[Wu.POLYGON,Wu.CIRCLE,Wu.LINE_STRING,Wu.IMAGE,Wu.TEXT,Wu.DEFAULT];var ol=function(){function t(t,e,r,n,i,o){this.maxExtent_=t;this.overlaps_=n;this.pixelRatio_=r;this.resolution_=e;this.renderBuffer_=o;this.executorsByZIndex_={};this.hitDetectionContext_=null;this.hitDetectionTransform_=c();this.createExecutors_(i)}t.prototype.clip=function(t,e){var r=this.getClipCoords(e);t.beginPath();t.moveTo(r[0],r[1]);t.lineTo(r[2],r[3]);t.lineTo(r[4],r[5]);t.lineTo(r[6],r[7]);t.clip()};t.prototype.createExecutors_=function(t){for(var e in t){var r=this.executorsByZIndex_[e];if(r===undefined){r={};this.executorsByZIndex_[e]=r}var n=t[e];for(var i in n){var o=n[i];r[i]=new nl(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}};t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_){var r=this.executorsByZIndex_[e];for(var n=0,i=t.length;n<i;++n){if(t[n]in r){return true}}}return false};t.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i,o){n=Math.round(n);var a=n*2+1;var s=O(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-r,-t[0],-t[1]);var u=!this.hitDetectionContext_;if(u){this.hitDetectionContext_=Object(Ut["a"])(a,a)}var l=this.hitDetectionContext_;if(l.canvas.width!==a||l.canvas.height!==a){l.canvas.width=a;l.canvas.height=a}else if(!u){l.clearRect(0,0,a,a)}var h;if(this.renderBuffer_!==undefined){h=Object(R["j"])();Object(R["q"])(h,t);Object(R["c"])(h,e*(this.renderBuffer_+n),h)}var c=sl(n);var f;function p(t,e){var r=l.getImageData(0,0,a,a).data;for(var s=0,u=c.length;s<u;s++){if(r[c[s]]>0){if(!o||f!==Wu.IMAGE&&f!==Wu.TEXT||o.indexOf(t)!==-1){var h=(c[s]-3)/4;var p=n-h%a;var d=n-(h/a|0);var v=i(t,e,p*p+d*d);if(v){return v}}l.clearRect(0,0,a,a);break}}return undefined}var d=Object.keys(this.executorsByZIndex_).map(Number);d.sort(fn["i"]);var v,_,g,y,m;for(v=d.length-1;v>=0;--v){var E=d[v].toString();g=this.executorsByZIndex_[E];for(_=il.length-1;_>=0;--_){f=il[_];y=g[f];if(y!==undefined){m=y.executeHitDetection(l,s,r,p,h);if(m){return m}}}}return undefined};t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e){return null}var r=e[0];var n=e[1];var i=e[2];var o=e[3];var a=[r,n,r,o,i,o,i,n];Rn(a,0,8,2,t,a);return a};t.prototype.isEmpty=function(){return Object(K["d"])(this.executorsByZIndex_)};t.prototype.execute=function(t,e,r,n,i,o,a){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(fn["i"]);if(this.maxExtent_){t.save();this.clip(t,r)}var u=o?o:il;var l,h,c,f,p,d;if(a){s.reverse()}for(l=0,h=s.length;l<h;++l){var v=s[l].toString();p=this.executorsByZIndex_[v];for(c=0,f=u.length;c<f;++c){var _=u[c];d=p[_];if(d!==undefined){d.execute(t,e,r,n,i,a)}}}if(this.maxExtent_){t.restore()}};return t}();var al={};function sl(t){if(al[t]!==undefined){return al[t]}var e=t*2+1;var r=t*t;var n=new Array(r+1);for(var i=0;i<=t;++i){for(var o=0;o<=t;++o){var a=i*i+o*o;if(a>r){break}var s=n[a];if(!s){s=[];n[a]=s}s.push(((t+i)*e+(t+o))*4+3);if(i>0){s.push(((t-i)*e+(t+o))*4+3)}if(o>0){s.push(((t+i)*e+(t-o))*4+3);if(i>0){s.push(((t-i)*e+(t-o))*4+3)}}}}var u=[];for(var i=0,l=n.length;i<l;++i){if(n[i]){u.push.apply(u,n[i])}}al[t]=u;return u}var ul=ol;var ll=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var hl=function(t){ll(e,t);function e(e,r,n,i,o,a,s){var u=t.call(this)||this;u.context_=e;u.pixelRatio_=r;u.extent_=n;u.transform_=i;u.viewRotation_=o;u.squaredTolerance_=a;u.userTransform_=s;u.contextFillState_=null;u.contextStrokeState_=null;u.contextTextState_=null;u.fillState_=null;u.strokeState_=null;u.image_=null;u.imageAnchorX_=0;u.imageAnchorY_=0;u.imageHeight_=0;u.imageOpacity_=0;u.imageOriginX_=0;u.imageOriginY_=0;u.imageRotateWithView_=false;u.imageRotation_=0;u.imageScale_=[0,0];u.imageWidth_=0;u.text_="";u.textOffsetX_=0;u.textOffsetY_=0;u.textRotateWithView_=false;u.textRotation_=0;u.textScale_=[0,0];u.textFillState_=null;u.textStrokeState_=null;u.textState_=null;u.pixelCoordinates_=[];u.tmpLocalTransform_=c();return u}e.prototype.drawImages_=function(t,e,r,n){if(!this.image_){return}var i=Rn(t,e,r,n,this.transform_,this.pixelCoordinates_);var o=this.context_;var a=this.tmpLocalTransform_;var s=o.globalAlpha;if(this.imageOpacity_!=1){o.globalAlpha=s*this.imageOpacity_}var u=this.imageRotation_;if(this.imageRotateWithView_){u+=this.viewRotation_}for(var l=0,h=i.length;l<h;l+=2){var c=i[l]-this.imageAnchorX_;var f=i[l+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var p=c+this.imageAnchorX_;var d=f+this.imageAnchorY_;O(a,p,d,1,1,u,-p,-d);o.setTransform.apply(o,a);o.translate(p,d);o.scale(this.imageScale_[0],this.imageScale_[1]);o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_);o.setTransform(1,0,0,1,0,0)}else{o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,f,this.imageWidth_,this.imageHeight_)}}if(this.imageOpacity_!=1){o.globalAlpha=s}};e.prototype.drawText_=function(t,e,r,n){if(!this.textState_||this.text_===""){return}if(this.textFillState_){this.setContextFillState_(this.textFillState_)}if(this.textStrokeState_){this.setContextStrokeState_(this.textStrokeState_)}this.setContextTextState_(this.textState_);var i=Rn(t,e,r,n,this.transform_,this.pixelCoordinates_);var o=this.context_;var a=this.textRotation_;if(this.textRotateWithView_){a+=this.viewRotation_}for(;e<r;e+=n){var s=i[e]+this.textOffsetX_;var u=i[e+1]+this.textOffsetY_;if(a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var l=O(this.tmpLocalTransform_,s,u,1,1,a,-s,-u);o.setTransform.apply(o,l);o.translate(s,u);o.scale(this.textScale_[0],this.textScale_[1]);if(this.textStrokeState_){o.strokeText(this.text_,0,0)}if(this.textFillState_){o.fillText(this.text_,0,0)}o.setTransform(1,0,0,1,0,0)}else{if(this.textStrokeState_){o.strokeText(this.text_,s,u)}if(this.textFillState_){o.fillText(this.text_,s,u)}}}};e.prototype.moveToLineTo_=function(t,e,r,n,i){var o=this.context_;var a=Rn(t,e,r,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var s=a.length;if(i){s-=2}for(var u=2;u<s;u+=2){o.lineTo(a[u],a[u+1])}if(i){o.closePath()}return r};e.prototype.drawRings_=function(t,e,r,n){for(var i=0,o=r.length;i<o;++i){e=this.moveToLineTo_(t,e,r[i],n,true)}return e};e.prototype.drawCircle=function(t){if(!Object(R["E"])(this.extent_,t.getExtent())){return}if(this.fillState_||this.strokeState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=Un(t,this.transform_,this.pixelCoordinates_);var r=e[2]-e[0];var n=e[3]-e[1];var i=Math.sqrt(r*r+n*n);var o=this.context_;o.beginPath();o.arc(e[0],e[1],i,0,2*Math.PI);if(this.fillState_){o.fill()}if(this.strokeState_){o.stroke()}}if(this.text_!==""){this.drawText_(t.getCenter(),0,2,2)}};e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke());this.setImageStyle(t.getImage());this.setTextStyle(t.getText())};e.prototype.setTransform=function(t){this.transform_=t};e.prototype.drawGeometry=function(t){var e=t.getType();switch(e){case Ue.POINT:this.drawPoint(t);break;case Ue.LINE_STRING:this.drawLineString(t);break;case Ue.POLYGON:this.drawPolygon(t);break;case Ue.MULTI_POINT:this.drawMultiPoint(t);break;case Ue.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case Ue.MULTI_POLYGON:this.drawMultiPolygon(t);break;case Ue.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case Ue.CIRCLE:this.drawCircle(t);break;default:}};e.prototype.drawFeature=function(t,e){var r=e.getGeometryFunction()(t);if(!r||!Object(R["E"])(this.extent_,r.getExtent())){return}this.setStyle(e);this.drawGeometry(r)};e.prototype.drawGeometryCollection=function(t){var e=t.getGeometriesArray();for(var r=0,n=e.length;r<n;++r){this.drawGeometry(e[r])}};e.prototype.drawPoint=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getFlatCoordinates();var r=t.getStride();if(this.image_){this.drawImages_(e,0,e.length,r)}if(this.text_!==""){this.drawText_(e,0,e.length,r)}};e.prototype.drawMultiPoint=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getFlatCoordinates();var r=t.getStride();if(this.image_){this.drawImages_(e,0,e.length,r)}if(this.text_!==""){this.drawText_(e,0,e.length,r)}};e.prototype.drawLineString=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!Object(R["E"])(this.extent_,t.getExtent())){return}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_;var r=t.getFlatCoordinates();e.beginPath();this.moveToLineTo_(r,0,r.length,t.getStride(),false);e.stroke()}if(this.text_!==""){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}};e.prototype.drawMultiLineString=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}var e=t.getExtent();if(!Object(R["E"])(this.extent_,e)){return}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_;var n=t.getFlatCoordinates();var i=0;var o=t.getEnds();var a=t.getStride();r.beginPath();for(var s=0,u=o.length;s<u;++s){i=this.moveToLineTo_(n,i,o[s],a,false)}r.stroke()}if(this.text_!==""){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}};e.prototype.drawPolygon=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!Object(R["E"])(this.extent_,t.getExtent())){return}if(this.strokeState_||this.fillState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=this.context_;e.beginPath();this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride());if(this.fillState_){e.fill()}if(this.strokeState_){e.stroke()}}if(this.text_!==""){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}};e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_){t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)}if(!Object(R["E"])(this.extent_,t.getExtent())){return}if(this.strokeState_||this.fillState_){if(this.fillState_){this.setContextFillState_(this.fillState_)}if(this.strokeState_){this.setContextStrokeState_(this.strokeState_)}var e=this.context_;var r=t.getOrientedFlatCoordinates();var n=0;var i=t.getEndss();var o=t.getStride();e.beginPath();for(var a=0,s=i.length;a<s;++a){var u=i[a];n=this.drawRings_(r,n,u,o)}if(this.fillState_){e.fill()}if(this.strokeState_){e.stroke()}}if(this.text_!==""){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}};e.prototype.setContextFillState_=function(t){var e=this.context_;var r=this.contextFillState_;if(!r){e.fillStyle=t.fillStyle;this.contextFillState_={fillStyle:t.fillStyle}}else{if(r.fillStyle!=t.fillStyle){r.fillStyle=t.fillStyle;e.fillStyle=t.fillStyle}}};e.prototype.setContextStrokeState_=function(t){var e=this.context_;var r=this.contextStrokeState_;if(!r){e.lineCap=t.lineCap;if(e.setLineDash){e.setLineDash(t.lineDash);e.lineDashOffset=t.lineDashOffset}e.lineJoin=t.lineJoin;e.lineWidth=t.lineWidth;e.miterLimit=t.miterLimit;e.strokeStyle=t.strokeStyle;this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle}}else{if(r.lineCap!=t.lineCap){r.lineCap=t.lineCap;e.lineCap=t.lineCap}if(e.setLineDash){if(!Object(fn["b"])(r.lineDash,t.lineDash)){e.setLineDash(r.lineDash=t.lineDash)}if(r.lineDashOffset!=t.lineDashOffset){r.lineDashOffset=t.lineDashOffset;e.lineDashOffset=t.lineDashOffset}}if(r.lineJoin!=t.lineJoin){r.lineJoin=t.lineJoin;e.lineJoin=t.lineJoin}if(r.lineWidth!=t.lineWidth){r.lineWidth=t.lineWidth;e.lineWidth=t.lineWidth}if(r.miterLimit!=t.miterLimit){r.miterLimit=t.miterLimit;e.miterLimit=t.miterLimit}if(r.strokeStyle!=t.strokeStyle){r.strokeStyle=t.strokeStyle;e.strokeStyle=t.strokeStyle}}};e.prototype.setContextTextState_=function(t){var e=this.context_;var r=this.contextTextState_;var n=t.textAlign?t.textAlign:Kt;if(!r){e.font=t.font;e.textAlign=n;e.textBaseline=t.textBaseline;this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline}}else{if(r.font!=t.font){r.font=t.font;e.font=t.font}if(r.textAlign!=n){r.textAlign=n;e.textAlign=n}if(r.textBaseline!=t.textBaseline){r.textBaseline=t.textBaseline;e.textBaseline=t.textBaseline}}};e.prototype.setFillStrokeStyle=function(t,e){var r=this;if(!t){this.fillState_=null}else{var n=t.getColor();this.fillState_={fillStyle:ys(n?n:zt)}}if(!e){this.strokeState_=null}else{var i=e.getColor();var o=e.getLineCap();var a=e.getLineDash();var s=e.getLineDashOffset();var u=e.getLineJoin();var l=e.getWidth();var h=e.getMiterLimit();var c=a?a:Wt;this.strokeState_={lineCap:o!==undefined?o:Yt,lineDash:this.pixelRatio_===1?c:c.map((function(t){return t*r.pixelRatio_})),lineDashOffset:(s?s:Vt)*this.pixelRatio_,lineJoin:u!==undefined?u:Xt,lineWidth:(l!==undefined?l:Qt)*this.pixelRatio_,miterLimit:h!==undefined?h:qt,strokeStyle:ys(i?i:Zt)}}};e.prototype.setImageStyle=function(t){var e;if(!t||!(e=t.getSize())){this.image_=null;return}var r=t.getAnchor();var n=t.getOrigin();this.image_=t.getImage(this.pixelRatio_);this.imageAnchorX_=r[0]*this.pixelRatio_;this.imageAnchorY_=r[1]*this.pixelRatio_;this.imageHeight_=e[1]*this.pixelRatio_;this.imageOpacity_=t.getOpacity();this.imageOriginX_=n[0];this.imageOriginY_=n[1];this.imageRotateWithView_=t.getRotateWithView();this.imageRotation_=t.getRotation();this.imageScale_=t.getScaleArray();this.imageWidth_=e[0]*this.pixelRatio_};e.prototype.setTextStyle=function(t){if(!t){this.text_=""}else{var e=t.getFill();if(!e){this.textFillState_=null}else{var r=e.getColor();this.textFillState_={fillStyle:ys(r?r:zt)}}var n=t.getStroke();if(!n){this.textStrokeState_=null}else{var i=n.getColor();var o=n.getLineCap();var a=n.getLineDash();var s=n.getLineDashOffset();var u=n.getLineJoin();var l=n.getWidth();var h=n.getMiterLimit();this.textStrokeState_={lineCap:o!==undefined?o:Yt,lineDash:a?a:Wt,lineDashOffset:s?s:Vt,lineJoin:u!==undefined?u:Xt,lineWidth:l!==undefined?l:Qt,miterLimit:h!==undefined?h:qt,strokeStyle:ys(i?i:Zt)}}var c=t.getFont();var f=t.getOffsetX();var p=t.getOffsetY();var d=t.getRotateWithView();var v=t.getRotation();var _=t.getScaleArray();var g=t.getText();var y=t.getTextAlign();var m=t.getTextBaseline();this.textState_={font:c!==undefined?c:Bt,textAlign:y!==undefined?y:Kt,textBaseline:m!==undefined?m:Ht};this.text_=g!==undefined?g:"";this.textOffsetX_=f!==undefined?this.pixelRatio_*f:0;this.textOffsetY_=p!==undefined?this.pixelRatio_*p:0;this.textRotateWithView_=d!==undefined?d:false;this.textRotation_=v!==undefined?v:0;this.textScale_=[this.pixelRatio_*_[0],this.pixelRatio_*_[1]]}};return e}(vu);var cl=hl;var fl=.5;function pl(t,e,r,n,i,o,a){var s=t[0]*fl;var u=t[1]*fl;var l=Object(Ut["a"])(s,u);l.imageSmoothingEnabled=false;var h=l.canvas;var c=new cl(l,fl,i,null,a);var f=r.length;var p=Math.floor((256*256*256-1)/f);var d={};for(var v=1;v<=f;++v){var _=r[v-1];var g=_.getStyleFunction()||n;if(!n){continue}var y=g(_,o);if(!y){continue}if(!Array.isArray(y)){y=[y]}var m=v*p;var E="#"+("000000"+m.toString(16)).slice(-6);for(var O=0,b=y.length;O<b;++O){var x=y[O];var w=x.getGeometryFunction()(_);if(!w||!Object(R["E"])(i,w.getExtent())){continue}var M=x.clone();var S=M.getFill();if(S){S.setColor(E)}var C=M.getStroke();if(C){C.setColor(E);C.setLineDash(null)}M.setText(undefined);var T=x.getImage();if(T&&T.getOpacity()!==0){var I=T.getImageSize();if(!I){continue}var P=Object(Ut["a"])(I[0],I[1],undefined,{alpha:false});var L=P.canvas;P.fillStyle=E;P.fillRect(0,0,L.width,L.height);M.setImage(new gs({img:L,imgSize:I,anchor:T.getAnchor(),anchorXUnits:Qa.PIXELS,anchorYUnits:Qa.PIXELS,offset:T.getOrigin(),opacity:1,size:T.getSize(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}var A=M.getZIndex()||0;var j=d[A];if(!j){j={};d[A]=j;j[Ue.POLYGON]=[];j[Ue.CIRCLE]=[];j[Ue.LINE_STRING]=[];j[Ue.POINT]=[]}j[w.getType().replace("Multi","")].push(w,M)}}var N=Object.keys(d).map(Number).sort(fn["i"]);for(var v=0,F=N.length;v<F;++v){var j=d[N[v]];for(var D in j){var G=j[D];for(var O=0,b=G.length;O<b;O+=2){c.setStyle(G[O+1]);for(var k=0,U=e.length;k<U;++k){c.setTransform(e[k]);c.drawGeometry(G[O])}}}}return l.getImageData(0,0,h.width,h.height)}function dl(t,e,r){var n=[];if(r){var i=Math.floor(Math.round(t[0])*fl);var o=Math.floor(Math.round(t[1])*fl);var a=(Object(T["b"])(i,0,r.width-1)+Object(T["b"])(o,0,r.height-1)*r.width)*4;var s=r.data[a];var u=r.data[a+1];var l=r.data[a+2];var h=l+256*(u+256*s);var c=Math.floor((256*256*256-1)/e.length);if(h&&h%c===0){n.push(e[h/c-1])}}return n}var vl=.5;var _l={Point:Rl,LineString:Ml,Polygon:Il,MultiPoint:Tl,MultiLineString:Sl,MultiPolygon:Cl,GeometryCollection:wl,Circle:El};function gl(t,e){return parseInt(Object(s["c"])(t),10)-parseInt(Object(s["c"])(e),10)}function yl(t,e){var r=ml(t,e);return r*r}function ml(t,e){return vl*t/e}function El(t,e,r,n,i){var o=r.getFill();var a=r.getStroke();if(o||a){var s=t.getBuilder(r.getZIndex(),Wu.CIRCLE);s.setFillStrokeStyle(o,a);s.drawCircle(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);l.setTextStyle(u);l.drawText(e,n)}}function Ol(t,e,r,n,i,o,a){var s=false;var u=r.getImage();if(u){var l=u.getImageState();if(l==ts.LOADED||l==ts.ERROR){u.unlistenImageChange(i)}else{if(l==ts.IDLE){u.load()}l=u.getImageState();u.listenImageChange(i);s=true}}bl(t,e,r,n,o,a);return s}function bl(t,e,r,n,i,o){var a=r.getGeometryFunction()(e);if(!a){return}var s=a.simplifyTransformed(n,i);var u=r.getRenderer();if(u){xl(t,s,r,e)}else{var l=_l[s.getType()];l(t,s,r,e,o)}}function xl(t,e,r,n){if(e.getType()==Ue.GEOMETRY_COLLECTION){var i=e.getGeometries();for(var o=0,a=i.length;o<a;++o){xl(t,i[o],r,n)}return}var s=t.getBuilder(r.getZIndex(),Wu.DEFAULT);s.drawCustom(e,n,r.getRenderer(),r.getHitDetectionRenderer())}function wl(t,e,r,n,i){var o=e.getGeometriesArray();var a,s;for(a=0,s=o.length;a<s;++a){var u=_l[o[a].getType()];u(t,o[a],r,n,i)}}function Ml(t,e,r,n,i){var o=r.getStroke();if(o){var a=t.getBuilder(r.getZIndex(),Wu.LINE_STRING);a.setFillStrokeStyle(null,o);a.drawLineString(e,n)}var s=r.getText();if(s&&s.getText()){var u=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);u.setTextStyle(s);u.drawText(e,n)}}function Sl(t,e,r,n,i){var o=r.getStroke();if(o){var a=t.getBuilder(r.getZIndex(),Wu.LINE_STRING);a.setFillStrokeStyle(null,o);a.drawMultiLineString(e,n)}var s=r.getText();if(s&&s.getText()){var u=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);u.setTextStyle(s);u.drawText(e,n)}}function Cl(t,e,r,n,i){var o=r.getFill();var a=r.getStroke();if(a||o){var s=t.getBuilder(r.getZIndex(),Wu.POLYGON);s.setFillStrokeStyle(o,a);s.drawMultiPolygon(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);l.setTextStyle(u);l.drawText(e,n)}}function Rl(t,e,r,n,i){var o=r.getImage();var a=r.getText();var s;if(i){t=i;s=o&&a&&a.getText()?{}:undefined}if(o){if(o.getImageState()!=ts.LOADED){return}var u=t.getBuilder(r.getZIndex(),Wu.IMAGE);u.setImageStyle(o,s);u.drawPoint(e,n)}if(a&&a.getText()){var l=t.getBuilder(r.getZIndex(),Wu.TEXT);l.setTextStyle(a,s);l.drawText(e,n)}}function Tl(t,e,r,n,i){var o=r.getImage();var a=r.getText();var s;if(i){t=i;s=o&&a&&a.getText()?{}:undefined}if(o){if(o.getImageState()!=ts.LOADED){return}var u=t.getBuilder(r.getZIndex(),Wu.IMAGE);u.setImageStyle(o,s);u.drawMultiPoint(e,n)}if(a&&a.getText()){var l=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);l.setTextStyle(a,s);l.drawText(e,n)}}function Il(t,e,r,n,i){var o=r.getFill();var a=r.getStroke();if(o||a){var s=t.getBuilder(r.getZIndex(),Wu.POLYGON);s.setFillStrokeStyle(o,a);s.drawPolygon(e,n)}var u=r.getText();if(u&&u.getText()){var l=(i||t).getBuilder(r.getZIndex(),Wu.TEXT);l.setTextStyle(u);l.drawText(e,n)}}var Pl=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ll=function(t){Pl(e,t);function e(e){var r=t.call(this,e)||this;r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r);r.animatingOrInteracting_;r.dirty_=false;r.hitDetectionImageData_=null;r.renderedFeatures_=null;r.renderedRevision_=-1;r.renderedResolution_=NaN;r.renderedExtent_=Object(R["j"])();r.wrappedRenderedExtent_=Object(R["j"])();r.renderedRotation_;r.renderedCenter_=null;r.renderedProjection_=null;r.renderedRenderOrder_=null;r.replayGroup_=null;r.replayGroupChanged=true;r.declutterExecutorGroup=null;r.clipping=true;return r}e.prototype.renderWorlds=function(t,e,r){var n=e.extent;var i=e.viewState;var o=i.center;var a=i.resolution;var s=i.projection;var u=i.rotation;var l=s.getExtent();var h=this.getLayer().getSource();var c=e.pixelRatio;var f=e.viewHints;var p=!(f[Xe.ANIMATING]||f[Xe.INTERACTING]);var d=this.context;var v=Math.round(e.size[0]*c);var _=Math.round(e.size[1]*c);var g=h.getWrapX()&&s.canWrapX();var y=g?Object(R["D"])(l):null;var m=g?Math.ceil((n[2]-l[2])/y)+1:1;var E=g?Math.floor((n[0]-l[0])/y):0;do{var O=this.getRenderTransform(o,a,u,c,v,_,E*y);t.execute(d,1,O,u,p,undefined,r)}while(++E<m)};e.prototype.renderDeclutter=function(t){if(this.declutterExecutorGroup){this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)}};e.prototype.renderFrame=function(t,e){var r=t.pixelRatio;var n=t.layerStatesArray[t.layerIndex];m(this.pixelTransform,1/r,1/r);w(this.inversePixelTransform,this.pixelTransform);var i=C(this.pixelTransform);this.useContainer(e,i,n.opacity,this.getBackground(t));var o=this.context;var a=o.canvas;var s=this.replayGroup_;var u=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!u||u.isEmpty())){return null}var l=Math.round(t.size[0]*r);var h=Math.round(t.size[1]*r);if(a.width!=l||a.height!=h){a.width=l;a.height=h;if(a.style.transform!==i){a.style.transform=i}}else if(!this.containerReused){o.clearRect(0,0,l,h)}this.preRender(o,t);var c=t.viewState;var f=c.projection;var p=false;var d=true;if(n.extent&&this.clipping){var v=on(n.extent,f);d=Object(R["E"])(v,t.extent);p=d&&!Object(R["g"])(v,t.extent);if(p){this.clipUnrotated(o,t,v)}}if(d){this.renderWorlds(s,t)}if(p){o.restore()}this.postRender(o,t);var _=Dt(n.opacity);var g=this.container;if(_!==g.style.opacity){g.style.opacity=_}if(this.renderedRotation_!==c.rotation){this.renderedRotation_=c.rotation;this.hitDetectionImageData_=null}return this.container};e.prototype.getFeatures=function(t){return new Promise(function(e){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];_(this.pixelTransform,r);var n=this.renderedCenter_;var i=this.renderedResolution_;var o=this.renderedRotation_;var a=this.renderedProjection_;var s=this.wrappedRenderedExtent_;var u=this.getLayer();var l=[];var h=r[0]*fl;var c=r[1]*fl;l.push(this.getRenderTransform(n,i,o,fl,h,c,0).slice());var f=u.getSource();var p=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!Object(R["g"])(p,s)){var d=s[0];var v=Object(R["D"])(p);var g=0;var y=void 0;while(d<p[0]){--g;y=v*g;l.push(this.getRenderTransform(n,i,o,fl,h,c,y).slice());d+=v}g=0;d=s[2];while(d>p[2]){++g;y=v*g;l.push(this.getRenderTransform(n,i,o,fl,h,c,y).slice());d-=v}}this.hitDetectionImageData_=pl(r,l,this.renderedFeatures_,u.getStyleFunction(),s,i,o)}e(dl(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))};e.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){var o=this;if(!this.replayGroup_){return undefined}var a=e.viewState.resolution;var u=e.viewState.rotation;var l=this.getLayer();var h={};var c=function(t,e,r){var o=Object(s["c"])(t);var a=h[o];if(!a){if(r===0){h[o]=true;return n(t,l,e)}i.push(h[o]={feature:t,layer:l,geometry:e,distanceSq:r,callback:n})}else if(a!==true&&r<a.distanceSq){if(r===0){h[o]=true;i.splice(i.lastIndexOf(a),1);return n(t,l,e)}a.geometry=e;a.distanceSq=r}return undefined};var f;var p=[this.replayGroup_];if(this.declutterExecutorGroup){p.push(this.declutterExecutorGroup)}p.some((function(n){return f=n.forEachFeatureAtCoordinate(t,a,u,r,c,n===o.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((function(t){return t.value})):null)}));return f};e.prototype.handleFontsChanged=function(){var t=this.getLayer();if(t.getVisible()&&this.replayGroup_){t.changed()}};e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()};e.prototype.prepareFrame=function(t){var e=this.getLayer();var r=e.getSource();if(!r){return false}var n=t.viewHints[Xe.ANIMATING];var i=t.viewHints[Xe.INTERACTING];var o=e.getUpdateWhileAnimating();var a=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&n||!a&&i){this.animatingOrInteracting_=true;return true}this.animatingOrInteracting_=false;var s=t.extent;var u=t.viewState;var l=u.projection;var h=u.resolution;var c=t.pixelRatio;var f=e.getRevision();var p=e.getRenderBuffer();var d=e.getRenderOrder();if(d===undefined){d=gl}var v=u.center.slice();var _=Object(R["c"])(s,p*h);var g=_.slice();var y=[_.slice()];var m=l.getExtent();if(r.getWrapX()&&l.canWrapX()&&!Object(R["g"])(m,t.extent)){var E=Object(R["D"])(m);var O=Math.max(Object(R["D"])(_)/2,E);_[0]=m[0]-O;_[2]=m[2]+O;gt(v,l);var b=Object(R["J"])(y[0],l);if(b[0]<m[0]&&b[2]<m[2]){y.push([b[0]+E,b[1],b[2]+E,b[3]])}else if(b[0]>m[0]&&b[2]>m[2]){y.push([b[0]-E,b[1],b[2]-E,b[3]])}}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==f&&this.renderedRenderOrder_==d&&Object(R["g"])(this.wrappedRenderedExtent_,_)){if(!Object(fn["b"])(this.renderedExtent_,g)){this.hitDetectionImageData_=null;this.renderedExtent_=g}this.renderedCenter_=v;this.replayGroupChanged=false;return true}this.replayGroup_=null;this.dirty_=false;var x=new Fu(ml(h,c),_,h,c);var w;if(this.getLayer().getDeclutter()){w=new Fu(ml(h,c),_,h,c)}var M=$r();var S;if(M){for(var C=0,T=y.length;C<T;++C){var I=y[C];var P=nn(I,l);r.loadFeatures(P,an(h,l),M)}S=Vr(M,l)}else{for(var C=0,T=y.length;C<T;++C){r.loadFeatures(y[C],h,l)}}var L=yl(h,c);var A=function(t){var r;var n=t.getStyleFunction()||e.getStyleFunction();if(n){r=n(t,h)}if(r){var i=this.renderFeature(t,L,r,x,S,w);this.dirty_=this.dirty_||i}}.bind(this);var j=nn(_,l);var N=r.getFeaturesInExtent(j);if(d){N.sort(d)}for(var C=0,T=N.length;C<T;++C){A(N[C])}this.renderedFeatures_=N;var F=x.finish();var D=new ul(_,h,c,r.getOverlaps(),F,e.getRenderBuffer());if(w){this.declutterExecutorGroup=new ul(_,h,c,r.getOverlaps(),w.finish(),e.getRenderBuffer())}this.renderedResolution_=h;this.renderedRevision_=f;this.renderedRenderOrder_=d;this.renderedExtent_=g;this.wrappedRenderedExtent_=_;this.renderedCenter_=v;this.renderedProjection_=l;this.replayGroup_=D;this.hitDetectionImageData_=null;this.replayGroupChanged=true;return true};e.prototype.renderFeature=function(t,e,r,n,i,o){if(!r){return false}var a=false;if(Array.isArray(r)){for(var s=0,u=r.length;s<u;++s){a=Ol(n,t,r[s],e,this.boundHandleStyleImageChange_,i,o)||a}}else{a=Ol(n,t,r,e,this.boundHandleStyleImageChange_,i,o)}return a};return e}(Yu);var Al=Ll;var jl=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Nl=function(t){jl(e,t);function e(e){return t.call(this,e)||this}e.prototype.createRenderer=function(){return new Al(this)};return e}(au);var Fl=Nl;var Dl=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Gl={SELECT:"select"};var kl=function(t){Dl(e,t);function e(e,r,n,i){var o=t.call(this,e)||this;o.selected=r;o.deselected=n;o.mapBrowserEvent=i;return o}return e}(wt["a"]);var Ul={};var Bl=function(t){Dl(e,t);function e(e){var r=t.call(this)||this;r.on;r.once;r.un;var n=e?e:{};r.boundAddFeature_=r.addFeature_.bind(r);r.boundRemoveFeature_=r.removeFeature_.bind(r);r.condition_=n.condition?n.condition:qo;r.addCondition_=n.addCondition?n.addCondition:Vo;r.removeCondition_=n.removeCondition?n.removeCondition:Vo;r.toggleCondition_=n.toggleCondition?n.toggleCondition:Jo;r.multi_=n.multi?n.multi:false;r.filter_=n.filter?n.filter:a["b"];r.hitTolerance_=n.hitTolerance?n.hitTolerance:0;r.style_=n.style!==undefined?n.style:zl();r.features_=n.features||new _e["a"];var i;if(n.layers){if(typeof n.layers==="function"){i=n.layers}else{var o=n.layers;i=function(t){return Object(fn["f"])(o,t)}}}else{i=a["b"]}r.layerFilter_=i;r.featureLayerAssociation_={};return r}e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[Object(s["c"])(t)]=e};e.prototype.getFeatures=function(){return this.features_};e.prototype.getHitTolerance=function(){return this.hitTolerance_};e.prototype.getLayer=function(t){return this.featureLayerAssociation_[Object(s["c"])(t)]};e.prototype.setHitTolerance=function(t){this.hitTolerance_=t};e.prototype.setMap=function(e){var r=this.getMap();if(r&&this.style_){this.features_.forEach(this.restorePreviousStyle_.bind(this))}t.prototype.setMap.call(this,e);if(e){this.features_.addEventListener(ge["a"].ADD,this.boundAddFeature_);this.features_.addEventListener(ge["a"].REMOVE,this.boundRemoveFeature_);if(this.style_){this.features_.forEach(this.applySelectedStyle_.bind(this))}}else{this.features_.removeEventListener(ge["a"].ADD,this.boundAddFeature_);this.features_.removeEventListener(ge["a"].REMOVE,this.boundRemoveFeature_)}};e.prototype.addFeature_=function(t){var e=t.element;if(this.style_){this.applySelectedStyle_(e)}if(!this.getLayer(e)){var r=this.getMap().getAllLayers().find((function(t){if(t instanceof Fl&&t.getSource()&&t.getSource().hasFeature(e)){return t}}));if(r){this.addFeatureLayerAssociation_(e,r)}}};e.prototype.removeFeature_=function(t){var e=t.element;if(this.style_){this.restorePreviousStyle_(e)}};e.prototype.getStyle=function(){return this.style_};e.prototype.applySelectedStyle_=function(t){var e=Object(s["c"])(t);if(!(e in Ul)){Ul[e]=t.getStyle()}t.setStyle(this.style_)};e.prototype.restorePreviousStyle_=function(t){var r=this.getMap().getInteractions().getArray();for(var n=r.length-1;n>=0;--n){var i=r[n];if(i!==this&&i instanceof e&&i.getStyle()&&i.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(i.getStyle());return}}var o=Object(s["c"])(t);t.setStyle(Ul[o]);delete Ul[o]};e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[Object(s["c"])(t)]};e.prototype.handleEvent=function(t){if(!this.condition_(t)){return true}var e=this.addCondition_(t);var r=this.removeCondition_(t);var n=this.toggleCondition_(t);var i=!e&&!r&&!n;var o=t.map;var a=this.getFeatures();var s=[];var u=[];if(i){Object(K["b"])(this.featureLayerAssociation_);o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e)){this.addFeatureLayerAssociation_(t,e);u.push(t);return!this.multi_}}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=a.getLength()-1;l>=0;--l){var h=a.item(l);var c=u.indexOf(h);if(c>-1){u.splice(c,1)}else{a.remove(h);s.push(h)}}if(u.length!==0){a.extend(u)}}else{o.forEachFeatureAtPixel(t.pixel,function(t,i){if(this.filter_(t,i)){if((e||n)&&!Object(fn["f"])(a.getArray(),t)){this.addFeatureLayerAssociation_(t,i);u.push(t)}else if((r||n)&&Object(fn["f"])(a.getArray(),t)){s.push(t);this.removeFeatureLayerAssociation_(t)}return!this.multi_}}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var f=s.length-1;f>=0;--f){a.remove(s[f])}a.extend(u)}if(u.length>0||s.length>0){this.dispatchEvent(new kl(Gl.SELECT,u,s,t))}return true};return e}(Ro);function zl(){var t=As();Object(fn["c"])(t[Ue.POLYGON],t[Ue.LINE_STRING]);Object(fn["c"])(t[Ue.GEOMETRY_COLLECTION],t[Ue.LINE_STRING]);return function(e){if(!e.getGeometry()){return null}return t[e.getGeometry().getType()]}}var Yl=Bl;var Wl=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Vl="projection";var Xl="coordinateFormat";var ql=function(t){Wl(e,t);function e(e){var r=this;var n=e?e:{};var i=document.createElement("div");i.className=n.className!==undefined?n.className:"ol-mouse-position";r=t.call(this,{element:i,render:n.render,target:n.target})||this;r.on;r.once;r.un;r.addChangeListener(Vl,r.handleProjectionChanged_);if(n.coordinateFormat){r.setCoordinateFormat(n.coordinateFormat)}if(n.projection){r.setProjection(n.projection)}var o=true;var a="&#160;";if("undefinedHTML"in n){if(n.undefinedHTML!==undefined){a=n.undefinedHTML}o=!!a}else if("placeholder"in n){if(n.placeholder===false){o=false}else{a=String(n.placeholder)}}r.placeholder_=a;r.renderOnMouseOut_=o;r.renderedHTML_=i.innerHTML;r.mapProjection_=null;r.transform_=null;return r}e.prototype.handleProjectionChanged_=function(){this.transform_=null};e.prototype.getCoordinateFormat=function(){return this.get(Xl)};e.prototype.getProjection=function(){return this.get(Vl)};e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))};e.prototype.handleMouseOut=function(t){this.updateHTML_(null)};e.prototype.setMap=function(e){t.prototype.setMap.call(this,e);if(e){var r=e.getViewport();this.listenerKeys.push(Object(H["a"])(r,Se.POINTERMOVE,this.handleMouseMove,this));if(this.renderOnMouseOut_){this.listenerKeys.push(Object(H["a"])(r,Se.POINTEROUT,this.handleMouseOut,this))}this.updateHTML_(null)}};e.prototype.setCoordinateFormat=function(t){this.set(Xl,t)};e.prototype.setProjection=function(t){this.set(Vl,jr(t))};e.prototype.updateHTML_=function(t){var e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();if(r){this.transform_=Vr(this.mapProjection_,r)}else{this.transform_=Pr}}var n=this.getMap();var i=n.getCoordinateFromPixelInternal(t);if(i){var o=$r();if(o){this.transform_=Vr(this.mapProjection_,o)}this.transform_(i,i);var a=this.getCoordinateFormat();if(a){e=a(i)}else{e=i.toString()}}}if(!this.renderedHTML_||e!==this.renderedHTML_){this.element.innerHTML=e;this.renderedHTML_=e}};e.prototype.render=function(t){var e=t.frameState;if(!e){this.mapProjection_=null}else{if(this.mapProjection_!=e.viewState.projection){this.mapProjection_=e.viewState.projection;this.transform_=null}}};return e}(co["default"]);var Zl=ql;var Kl=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Hl="units";var Jl={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};var Ql=[1,2,5];var $l=25.4/.28;var th=function(t){Kl(e,t);function e(e){var r=this;var n=e?e:{};var i=n.className!==undefined?n.className:n.bar?"ol-scale-bar":"ol-scale-line";r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;r.on;r.once;r.un;r.innerElement_=document.createElement("div");r.innerElement_.className=i+"-inner";r.element.className=i+" "+It;r.element.appendChild(r.innerElement_);r.viewState_=null;r.minWidth_=n.minWidth!==undefined?n.minWidth:64;r.renderedVisible_=false;r.renderedWidth_=undefined;r.renderedHTML_="";r.addChangeListener(Hl,r.handleUnitsChanged_);r.setUnits(n.units||Jl.METRIC);r.scaleBar_=n.bar||false;r.scaleBarSteps_=n.steps||4;r.scaleBarText_=n.text||false;r.dpi_=n.dpi||undefined;return r}e.prototype.getUnits=function(){return this.get(Hl)};e.prototype.handleUnitsChanged_=function(){this.updateElement_()};e.prototype.setUnits=function(t){this.set(Hl,t)};e.prototype.setDpi=function(t){this.dpi_=t};e.prototype.updateElement_=function(){var t=this.viewState_;if(!t){if(this.renderedVisible_){this.element.style.display="none";this.renderedVisible_=false}return}var e=t.center;var r=t.projection;var n=this.getUnits();var i=n==Jl.DEGREES?Ve.DEGREES:Ve.METERS;var o=Nr(r,t.resolution,e,i);var a=this.minWidth_*(this.dpi_||$l)/$l;var s=a*o;var u="";if(n==Jl.DEGREES){var h=We[Ve.DEGREES];s*=h;if(s<h/60){u="″";o*=3600}else if(s<h){u="′";o*=60}else{u="°"}}else if(n==Jl.IMPERIAL){if(s<.9144){u="in";o/=.0254}else if(s<1609.344){u="ft";o/=.3048}else{u="mi";o/=1609.344}}else if(n==Jl.NAUTICAL){o/=1852;u="nm"}else if(n==Jl.METRIC){if(s<.001){u="μm";o*=1e6}else if(s<1){u="mm";o*=1e3}else if(s<1e3){u="m"}else{u="km";o/=1e3}}else if(n==Jl.US){if(s<.9144){u="in";o*=39.37}else if(s<1609.344){u="ft";o/=.30480061}else{u="mi";o/=1609.3472}}else{Object(l["a"])(false,33)}var c=3*Math.floor(Math.log(a*o)/Math.log(10));var f,p,d;while(true){d=Math.floor(c/3);var v=Math.pow(10,d);f=Ql[(c%3+3)%3]*v;p=Math.round(f/o);if(isNaN(p)){this.element.style.display="none";this.renderedVisible_=false;return}else if(p>=a){break}++c}var _;if(this.scaleBar_){_=this.createScaleBar(p,f,u)}else{_=f.toFixed(d<0?-d:0)+" "+u}if(this.renderedHTML_!=_){this.innerElement_.innerHTML=_;this.renderedHTML_=_}if(this.renderedWidth_!=p){this.innerElement_.style.width=p+"px";this.renderedWidth_=p}if(!this.renderedVisible_){this.element.style.display="";this.renderedVisible_=true}};e.prototype.createScaleBar=function(t,e,r){var n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString();var i=[];var o=t/this.scaleBarSteps_;var a="#ffffff";for(var s=0;s<this.scaleBarSteps_;s++){if(s===0){i.push(this.createMarker("absolute",s))}i.push("<div>"+"<div "+'class="ol-scale-singlebar" '+"style="+'"width: '+o+"px;"+"background-color: "+a+';"'+">"+"</div>"+this.createMarker("relative",s)+(s%2===0||this.scaleBarSteps_===2?this.createStepText(s,t,false,e,r):"")+"</div>");if(s===this.scaleBarSteps_-1){{}i.push(this.createStepText(s+1,t,true,e,r))}if(a==="#ffffff"){a="#000000"}else{a="#ffffff"}}var u;if(this.scaleBarText_){u="<div "+'class="ol-scale-text" '+'style="width: '+t+'px;">'+n+"</div>"}else{u=""}var l="<div "+'style="display: flex;">'+u+i.join("")+"</div>";return l};e.prototype.createMarker=function(t,e){var r=t==="absolute"?3:-10;return"<div "+'class="ol-scale-step-marker" '+'style="position: '+t+";"+"top: "+r+'px;"'+"></div>"};e.prototype.createStepText=function(t,e,r,n,i){var o=t===0?0:Math.round(n/this.scaleBarSteps_*t*100)/100;var a=o+(t===0?"":" "+i);var s=t===0?-3:e/this.scaleBarSteps_*-1;var u=t===0?0:e/this.scaleBarSteps_*2;return"<div "+'class="ol-scale-step-text" '+'style="'+"margin-left: "+s+"px;"+"text-align: "+(t===0?"left":"center")+"; "+"min-width: "+u+"px;"+"left: "+(r?e+"px":"unset")+';"'+">"+a+"</div>"};e.prototype.getScaleForResolution=function(){var t=Nr(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,Ve.METERS);var e=this.dpi_||$l;var r=1e3/25.4;return parseFloat(t.toString())*r*e};e.prototype.render=function(t){var e=t.frameState;if(!e){this.viewState_=null}else{this.viewState_=e.viewState}this.updateElement_()};return e}(co["default"]);var eh=th;var rh=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var nh=.75;var ih=.1;var oh=function(t){rh(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.createRenderer=function(){return new ve(this)};return e}(ho);var ah=function(t){rh(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;r.boundHandleRotationChanged_=r.handleRotationChanged_.bind(r);r.collapsed_=n.collapsed!==undefined?n.collapsed:true;r.collapsible_=n.collapsible!==undefined?n.collapsible:true;if(!r.collapsible_){r.collapsed_=false}r.rotateWithView_=n.rotateWithView!==undefined?n.rotateWithView:false;r.viewExtent_=undefined;var i=n.className!==undefined?n.className:"ol-overviewmap";var o=n.tipLabel!==undefined?n.tipLabel:"Overview map";var a=n.collapseLabel!==undefined?n.collapseLabel:"‹";if(typeof a==="string"){r.collapseLabel_=document.createElement("span");r.collapseLabel_.textContent=a}else{r.collapseLabel_=a}var s=n.label!==undefined?n.label:"›";if(typeof s==="string"){r.label_=document.createElement("span");r.label_.textContent=s}else{r.label_=s}var u=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;var l=document.createElement("button");l.setAttribute("type","button");l.title=o;l.appendChild(u);l.addEventListener(V["a"].CLICK,r.handleClick_.bind(r),false);r.ovmapDiv_=document.createElement("div");r.ovmapDiv_.className="ol-overviewmap-map";r.view_=n.view;r.ovmap_=new oh({view:n.view});var h=r.ovmap_;if(n.layers){n.layers.forEach((function(t){h.addLayer(t)}))}var c=document.createElement("div");c.className="ol-overviewmap-box";c.style.boxSizing="border-box";r.boxOverlay_=new Ja({position:[0,0],positioning:qa.CENTER_CENTER,element:c});r.ovmap_.addOverlay(r.boxOverlay_);var f=i+" "+It+" "+Lt+(r.collapsed_&&r.collapsible_?" "+At:"")+(r.collapsible_?"":" ol-uncollapsible");var p=r.element;p.className=f;p.appendChild(r.ovmapDiv_);p.appendChild(l);var d=r;var v=r.boxOverlay_;var _=r.boxOverlay_.getElement();var g=function(t){return{clientX:t.clientX,clientY:t.clientY}};var y=function(t){var e=g(t);var r=h.getEventCoordinateInternal(e);v.setPosition(r)};var m=function(t){var e=h.getEventCoordinateInternal(t);d.getMap().getView().setCenterInternal(e);window.removeEventListener("mousemove",y);window.removeEventListener("mouseup",m)};_.addEventListener("mousedown",(function(){window.addEventListener("mousemove",y);window.addEventListener("mouseup",m)}));return r}e.prototype.setMap=function(e){var r=this.getMap();if(e===r){return}if(r){var n=r.getView();if(n){this.unbindView_(n)}this.ovmap_.setTarget(null)}t.prototype.setMap.call(this,e);if(e){this.ovmap_.setTarget(this.ovmapDiv_);this.listenerKeys.push(Object(H["a"])(e,xt["a"].PROPERTYCHANGE,this.handleMapPropertyChange_,this));var i=e.getView();if(i){this.bindView_(i);if(i.isDef()){this.ovmap_.updateSize();this.resetExtent_()}}if(!this.ovmap_.isRendered()){this.updateBoxAfterOvmapIsRendered_()}}};e.prototype.handleMapPropertyChange_=function(t){if(t.key===Pe.VIEW){var e=t.oldValue;if(e){this.unbindView_(e)}var r=this.getMap().getView();this.bindView_(r)}else if(!this.ovmap_.isRendered()&&(t.key===Pe.TARGET||t.key===Pe.SIZE)){this.ovmap_.updateSize()}};e.prototype.bindView_=function(t){if(!this.view_){var e=new to({projection:t.getProjection()});this.ovmap_.setView(e)}t.addChangeListener(qe.ROTATION,this.boundHandleRotationChanged_);this.handleRotationChanged_()};e.prototype.unbindView_=function(t){t.removeChangeListener(qe.ROTATION,this.boundHandleRotationChanged_)};e.prototype.handleRotationChanged_=function(){if(this.rotateWithView_){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}};e.prototype.validateExtent_=function(){var t=this.getMap();var e=this.ovmap_;if(!t.isRendered()||!e.isRendered()){return}var r=t.getSize();var n=t.getView();var i=n.calculateExtentInternal(r);if(this.viewExtent_&&Object(R["o"])(i,this.viewExtent_)){return}this.viewExtent_=i;var o=e.getSize();var a=e.getView();var s=a.calculateExtentInternal(o);var u=e.getPixelFromCoordinateInternal(Object(R["B"])(i));var l=e.getPixelFromCoordinateInternal(Object(R["v"])(i));var h=Math.abs(u[0]-l[0]);var c=Math.abs(u[1]-l[1]);var f=o[0];var p=o[1];if(h<f*ih||c<p*ih||h>f*nh||c>p*nh){this.resetExtent_()}else if(!Object(R["g"])(s,i)){this.recenter_()}};e.prototype.resetExtent_=function(){if(nh===0||ih===0){return}var t=this.getMap();var e=this.ovmap_;var r=t.getSize();var n=t.getView();var i=n.calculateExtentInternal(r);var o=e.getView();var a=Math.log(nh/ih)/Math.LN2;var s=1/(Math.pow(2,a/2)*ih);Object(R["I"])(i,s);o.fitInternal(zi(i))};e.prototype.recenter_=function(){var t=this.getMap();var e=this.ovmap_;var r=t.getView();var n=e.getView();n.setCenterInternal(r.getCenterInternal())};e.prototype.updateBox_=function(){var t=this.getMap();var e=this.ovmap_;if(!t.isRendered()||!e.isRendered()){return}var r=t.getSize();var n=t.getView();var i=e.getView();var o=this.rotateWithView_?0:-n.getRotation();var a=this.boxOverlay_;var s=this.boxOverlay_.getElement();var u=n.getCenterInternal();var l=n.getResolution();var h=i.getResolution();var c=r[0]*l/h;var f=r[1]*l/h;a.setPosition(u);if(s){s.style.width=c+"px";s.style.height=f+"px";var p="rotate("+o+"rad)";s.style.transform=p}};e.prototype.updateBoxAfterOvmapIsRendered_=function(){if(this.ovmapPostrenderKey_){return}this.ovmapPostrenderKey_=Object(H["b"])(this.ovmap_,Ie["a"].POSTRENDER,(function(t){delete this.ovmapPostrenderKey_;this.updateBox_()}),this)};e.prototype.handleClick_=function(t){t.preventDefault();this.handleToggle_()};e.prototype.handleToggle_=function(){this.element.classList.toggle(At);if(this.collapsed_){Object(Ut["g"])(this.collapseLabel_,this.label_)}else{Object(Ut["g"])(this.label_,this.collapseLabel_)}this.collapsed_=!this.collapsed_;var t=this.ovmap_;if(!this.collapsed_){if(t.isRendered()){this.viewExtent_=undefined;t.render();return}t.updateSize();this.resetExtent_();this.updateBoxAfterOvmapIsRendered_()}};e.prototype.getCollapsible=function(){return this.collapsible_};e.prototype.setCollapsible=function(t){if(this.collapsible_===t){return}this.collapsible_=t;this.element.classList.toggle("ol-uncollapsible");if(!t&&this.collapsed_){this.handleToggle_()}};e.prototype.setCollapsed=function(t){if(!this.collapsible_||this.collapsed_===t){return}this.handleToggle_()};e.prototype.getCollapsed=function(){return this.collapsed_};e.prototype.getRotateWithView=function(){return this.rotateWithView_};e.prototype.setRotateWithView=function(t){if(this.rotateWithView_===t){return}this.rotateWithView_=t;if(this.getMap().getView().getRotation()!==0){if(this.rotateWithView_){this.handleRotationChanged_()}else{this.ovmap_.getView().setRotation(0)}this.viewExtent_=undefined;this.validateExtent_();this.updateBox_()}};e.prototype.getOverviewMap=function(){return this.ovmap_};e.prototype.render=function(t){this.validateExtent_();this.updateBox_()};return e}(co["default"]);var sh=ah;function uh(t){var e=Object.keys(t.defs);var r=e.length;var n,i;for(n=0;n<r;++n){var o=e[n];if(!jr(o)){var a=t.defs(o);var s=a.units;if(!s&&a.projName==="longlat"){s=Ve.DEGREES}Lr(new Je({code:o,axisOrientation:a.axis,metersPerUnit:a.to_meter,units:s}))}}for(n=0;n<r;++n){var u=e[n];var l=jr(u);for(i=0;i<r;++i){var h=e[i];var c=jr(h);if(!br(u,h)){if(t.defs[u]===t.defs[h]){Fr([l,c])}else{var f=t(u,h);Br(l,c,un(l,c,f.forward),un(c,l,f.inverse))}}}}}var lh=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");t.WGS84=t["EPSG:4326"];t["EPSG:3785"]=t["EPSG:3857"];t.GOOGLE=t["EPSG:3857"];t["EPSG:900913"]=t["EPSG:3857"];t["EPSG:102113"]=t["EPSG:3857"]};var hh=1;var ch=2;var fh=3;var ph=4;var dh=5;var vh=6378137;var _h=6356752.314;var gh=.0066943799901413165;var yh=484813681109536e-20;var mh=Math.PI/2;var Eh=.16666666666666666;var Oh=.04722222222222222;var bh=.022156084656084655;var xh=1e-10;var wh=.017453292519943295;var Mh=57.29577951308232;var Sh=Math.PI/4;var Ch=Math.PI*2;var Rh=3.14159265359;var Th={};Th.greenwich=0;Th.lisbon=-9.131906111111;Th.paris=2.337229166667;Th.bogota=-74.080916666667;Th.madrid=-3.687938888889;Th.rome=12.452333333333;Th.bern=7.439583333333;Th.jakarta=106.807719444444;Th.ferro=-17.666666666667;Th.brussels=4.367975;Th.stockholm=18.058277777778;Th.athens=23.7163375;Th.oslo=10.722916666667;var Ih={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Ph=/[\s_\-\/\(\)]/g;function Lh(t,e){if(t[e]){return t[e]}var r=Object.keys(t);var n=e.toLowerCase().replace(Ph,"");var i=-1;var o,a;while(++i<r.length){o=r[i];a=o.toLowerCase().replace(Ph,"");if(a===n){return t[o]}}}var Ah=function(t){var e={};var r=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var r=e.split("=");r.push(true);t[r[0].toLowerCase()]=r[1];return t}),{});var n,i,o;var a={proj:"projName",datum:"datumCode",rf:function(t){e.rf=parseFloat(t)},lat_0:function(t){e.lat0=t*wh},lat_1:function(t){e.lat1=t*wh},lat_2:function(t){e.lat2=t*wh},lat_ts:function(t){e.lat_ts=t*wh},lon_0:function(t){e.long0=t*wh},lon_1:function(t){e.long1=t*wh},lon_2:function(t){e.long2=t*wh},alpha:function(t){e.alpha=parseFloat(t)*wh},gamma:function(t){e.rectified_grid_angle=parseFloat(t)},lonc:function(t){e.longc=t*wh},x_0:function(t){e.x0=parseFloat(t)},y_0:function(t){e.y0=parseFloat(t)},k_0:function(t){e.k0=parseFloat(t)},k:function(t){e.k0=parseFloat(t)},a:function(t){e.a=parseFloat(t)},b:function(t){e.b=parseFloat(t)},r_a:function(){e.R_A=true},zone:function(t){e.zone=parseInt(t,10)},south:function(){e.utmSouth=true},towgs84:function(t){e.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){e.to_meter=parseFloat(t)},units:function(t){e.units=t;var r=Lh(Ih,t);if(r){e.to_meter=r.to_meter}},from_greenwich:function(t){e.from_greenwich=t*wh},pm:function(t){var r=Lh(Th,t);e.from_greenwich=(r?r:parseFloat(t))*wh},nadgrids:function(t){if(t==="@null"){e.datumCode="none"}else{e.nadgrids=t}},axis:function(t){var r="ewnsud";if(t.length===3&&r.indexOf(t.substr(0,1))!==-1&&r.indexOf(t.substr(1,1))!==-1&&r.indexOf(t.substr(2,1))!==-1){e.axis=t}},approx:function(){e.approx=true}};for(n in r){i=r[n];if(n in a){o=a[n];if(typeof o==="function"){o(i)}else{e[o]=i}}else{e[n]=i}}if(typeof e.datumCode==="string"&&e.datumCode!=="WGS84"){e.datumCode=e.datumCode.toLowerCase()}return e};var jh=qh;var Nh=1;var Fh=2;var Dh=3;var Gh=4;var kh=5;var Uh=-1;var Bh=/\s/;var zh=/[A-Za-z]/;var Yh=/[A-Za-z84_]/;var Wh=/[,\]]/;var Vh=/[\d\.E\-\+]/;function Xh(t){if(typeof t!=="string"){throw new Error("not a string")}this.text=t.trim();this.level=0;this.place=0;this.root=null;this.stack=[];this.currentObject=null;this.state=Nh}Xh.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==Gh){while(Bh.test(t)){if(this.place>=this.text.length){return}t=this.text[this.place++]}}switch(this.state){case Nh:return this.neutral(t);case Fh:return this.keyword(t);case Gh:return this.quoted(t);case kh:return this.afterquote(t);case Dh:return this.number(t);case Uh:return}};Xh.prototype.afterquote=function(t){if(t==='"'){this.word+='"';this.state=Gh;return}if(Wh.test(t)){this.word=this.word.trim();this.afterItem(t);return}throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)};Xh.prototype.afterItem=function(t){if(t===","){if(this.word!==null){this.currentObject.push(this.word)}this.word=null;this.state=Nh;return}if(t==="]"){this.level--;if(this.word!==null){this.currentObject.push(this.word);this.word=null}this.state=Nh;this.currentObject=this.stack.pop();if(!this.currentObject){this.state=Uh}return}};Xh.prototype.number=function(t){if(Vh.test(t)){this.word+=t;return}if(Wh.test(t)){this.word=parseFloat(this.word);this.afterItem(t);return}throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)};Xh.prototype.quoted=function(t){if(t==='"'){this.state=kh;return}this.word+=t;return};Xh.prototype.keyword=function(t){if(Yh.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word);this.level++;if(this.root===null){this.root=e}else{this.currentObject.push(e)}this.stack.push(this.currentObject);this.currentObject=e;this.state=Nh;return}if(Wh.test(t)){this.afterItem(t);return}throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place)};Xh.prototype.neutral=function(t){if(zh.test(t)){this.word=t;this.state=Fh;return}if(t==='"'){this.word="";this.state=Gh;return}if(Vh.test(t)){this.word=t;this.state=Dh;return}if(Wh.test(t)){this.afterItem(t);return}throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place)};Xh.prototype.output=function(){while(this.place<this.text.length){this.readCharicter()}if(this.state===Uh){return this.root}throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function qh(t){var e=new Xh(t);return e.output()}function Zh(t,e,r){if(Array.isArray(e)){r.unshift(e);e=null}var n=e?{}:t;var i=r.reduce((function(t,e){Kh(e,t);return t}),n);if(e){t[e]=i}}function Kh(t,e){if(!Array.isArray(t)){e[t]=true;return}var r=t.shift();if(r==="PARAMETER"){r=t.shift()}if(t.length===1){if(Array.isArray(t[0])){e[r]={};Kh(t[0],e[r]);return}e[r]=t[0];return}if(!t.length){e[r]=true;return}if(r==="TOWGS84"){e[r]=t;return}if(r==="AXIS"){if(!(r in e)){e[r]=[]}e[r].push(t);return}if(!Array.isArray(r)){e[r]={}}var n;switch(r){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[r]={name:t[0].toLowerCase(),convert:t[1]};if(t.length===3){Kh(t[2],e[r])}return;case"SPHEROID":case"ELLIPSOID":e[r]={name:t[0],a:t[1],rf:t[2]};if(t.length===4){Kh(t[3],e[r])}return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":t[0]=["name",t[0]];Zh(e,r,t);return;default:n=-1;while(++n<t.length){if(!Array.isArray(t[n])){return Kh(t,e[r])}}return Zh(e,r,t)}}var Hh=.017453292519943295;function Jh(t,e){var r=e[0];var n=e[1];if(!(r in t)&&n in t){t[r]=t[n];if(e.length===3){t[r]=e[2](t[r])}}}function Qh(t){return t*Hh}function $h(t){if(t.type==="GEOGCS"){t.projName="longlat"}else if(t.type==="LOCAL_CS"){t.projName="identity";t.local=true}else{if(typeof t.PROJECTION==="object"){t.projName=Object.keys(t.PROJECTION)[0]}else{t.projName=t.PROJECTION}}if(t.AXIS){var e="";for(var r=0,n=t.AXIS.length;r<n;++r){var i=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];if(i[0].indexOf("north")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="north"){e+="n"}else if(i[0].indexOf("south")!==-1||(i[0]==="y"||i[0]==="lat")&&i[1]==="south"){e+="s"}else if(i[0].indexOf("east")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="east"){e+="e"}else if(i[0].indexOf("west")!==-1||(i[0]==="x"||i[0]==="lon")&&i[1]==="west"){e+="w"}}if(e.length===2){e+="u"}if(e.length===3){t.axis=e}}if(t.UNIT){t.units=t.UNIT.name.toLowerCase();if(t.units==="metre"){t.units="meter"}if(t.UNIT.convert){if(t.type==="GEOGCS"){if(t.DATUM&&t.DATUM.SPHEROID){t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a}}else{t.to_meter=t.UNIT.convert}}}var o=t.GEOGCS;if(t.type==="GEOGCS"){o=t}if(o){if(o.DATUM){t.datumCode=o.DATUM.name.toLowerCase()}else{t.datumCode=o.name.toLowerCase()}if(t.datumCode.slice(0,2)==="d_"){t.datumCode=t.datumCode.slice(2)}if(t.datumCode==="new_zealand_geodetic_datum_1949"||t.datumCode==="new_zealand_1949"){t.datumCode="nzgd49"}if(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984"){if(t.PROJECTION==="Mercator_Auxiliary_Sphere"){t.sphere=true}t.datumCode="wgs84"}if(t.datumCode.slice(-6)==="_ferro"){t.datumCode=t.datumCode.slice(0,-6)}if(t.datumCode.slice(-8)==="_jakarta"){t.datumCode=t.datumCode.slice(0,-8)}if(~t.datumCode.indexOf("belge")){t.datumCode="rnb72"}if(o.DATUM&&o.DATUM.SPHEROID){t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk");if(t.ellps.toLowerCase().slice(0,13)==="international"){t.ellps="intl"}t.a=o.DATUM.SPHEROID.a;t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)}if(o.DATUM&&o.DATUM.TOWGS84){t.datum_params=o.DATUM.TOWGS84}if(~t.datumCode.indexOf("osgb_1936")){t.datumCode="osgb36"}if(~t.datumCode.indexOf("osni_1952")){t.datumCode="osni52"}if(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965")){t.datumCode="ire65"}if(t.datumCode==="ch1903+"){t.datumCode="ch1903"}if(~t.datumCode.indexOf("israel")){t.datumCode="isr93"}}if(t.b&&!isFinite(t.b)){t.b=t.a}function a(e){var r=t.to_meter||1;return e*r}var s=function(e){return Jh(t,e)};var u=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Qh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Qh],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Qh],["lat0","latitude_of_origin",Qh],["lat0","standard_parallel_1",Qh],["lat1","standard_parallel_1",Qh],["lat2","standard_parallel_2",Qh],["azimuth","Azimuth"],["alpha","azimuth",Qh],["srsCode","name"]];u.forEach(s);if(!t.long0&&t.longc&&(t.projName==="Albers_Conic_Equal_Area"||t.projName==="Lambert_Azimuthal_Equal_Area")){t.long0=t.longc}if(!t.lat_ts&&t.lat1&&(t.projName==="Stereographic_South_Pole"||t.projName==="Polar Stereographic (variant B)")){t.lat0=Qh(t.lat1>0?90:-90);t.lat_ts=t.lat1}}var tc=function(t){var e=jh(t);var r=e.shift();var n=e.shift();e.unshift(["name",n]);e.unshift(["type",r]);var i={};Kh(e,i);$h(i);return i};function ec(t){var e=this;if(arguments.length===2){var r=arguments[1];if(typeof r==="string"){if(r.charAt(0)==="+"){ec[t]=Ah(arguments[1])}else{ec[t]=tc(arguments[1])}}else{ec[t]=r}}else if(arguments.length===1){if(Array.isArray(t)){return t.map((function(t){if(Array.isArray(t)){ec.apply(e,t)}else{ec(t)}}))}else if(typeof t==="string"){if(t in ec){return ec[t]}}else if("EPSG"in t){ec["EPSG:"+t.EPSG]=t}else if("ESRI"in t){ec["ESRI:"+t.ESRI]=t}else if("IAU2000"in t){ec["IAU2000:"+t.IAU2000]=t}else{console.log(t)}return}}lh(ec);var rc=ec;function nc(t){return typeof t==="string"}function ic(t){return t in rc}var oc=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function ac(t){return oc.some((function(e){return t.indexOf(e)>-1}))}var sc=["3857","900913","3785","102113"];function uc(t){var e=Lh(t,"authority");if(!e){return}var r=Lh(e,"epsg");return r&&sc.indexOf(r)>-1}function lc(t){var e=Lh(t,"extension");if(!e){return}return Lh(e,"proj4")}function hc(t){return t[0]==="+"}function cc(t){if(nc(t)){if(ic(t)){return rc[t]}if(ac(t)){var e=tc(t);if(uc(e)){return rc["EPSG:3857"]}var r=lc(e);if(r){return Ah(r)}return e}if(hc(t)){return Ah(t)}}else{return t}}var fc=cc;var pc=function(t,e){t=t||{};var r,n;if(!e){return t}for(n in e){r=e[n];if(r!==undefined){t[n]=r}}return t};var dc=function(t,e,r){var n=t*e;return r/Math.sqrt(1-n*n)};var vc=function(t){return t<0?-1:1};var _c=function(t){return Math.abs(t)<=Rh?t:t-vc(t)*Ch};var gc=function(t,e,r){var n=t*r;var i=.5*t;n=Math.pow((1-n)/(1+n),i);return Math.tan(.5*(mh-e))/n};var yc=function(t,e){var r=.5*t;var n,i;var o=mh-2*Math.atan(e);for(var a=0;a<=15;a++){n=t*Math.sin(o);i=mh-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-o;o+=i;if(Math.abs(i)<=1e-10){return o}}return-9999};function mc(){var t=this.b/this.a;this.es=1-t*t;if(!("x0"in this)){this.x0=0}if(!("y0"in this)){this.y0=0}this.e=Math.sqrt(this.es);if(this.lat_ts){if(this.sphere){this.k0=Math.cos(this.lat_ts)}else{this.k0=dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}}else{if(!this.k0){if(this.k){this.k0=this.k}else{this.k0=1}}}}function Ec(t){var e=t.x;var r=t.y;if(r*Mh>90&&r*Mh<-90&&e*Mh>180&&e*Mh<-180){return null}var n,i;if(Math.abs(Math.abs(r)-mh)<=xh){return null}else{if(this.sphere){n=this.x0+this.a*this.k0*_c(e-this.long0);i=this.y0+this.a*this.k0*Math.log(Math.tan(Sh+.5*r))}else{var o=Math.sin(r);var a=gc(this.e,r,o);n=this.x0+this.a*this.k0*_c(e-this.long0);i=this.y0-this.a*this.k0*Math.log(a)}t.x=n;t.y=i;return t}}function Oc(t){var e=t.x-this.x0;var r=t.y-this.y0;var n,i;if(this.sphere){i=mh-2*Math.atan(Math.exp(-r/(this.a*this.k0)))}else{var o=Math.exp(-r/(this.a*this.k0));i=yc(this.e,o);if(i===-9999){return null}}n=_c(this.long0+e/(this.a*this.k0));t.x=n;t.y=i;return t}var bc=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];var xc={init:mc,forward:Ec,inverse:Oc,names:bc};function wc(){}function Mc(t){return t}var Sc=["longlat","identity"];var Cc={init:wc,forward:Mc,inverse:Mc,names:Sc};var Rc=[xc,Cc];var Tc={};var Ic=[];function Pc(t,e){var r=Ic.length;if(!t.names){console.log(e);return true}Ic[r]=t;t.names.forEach((function(t){Tc[t.toLowerCase()]=r}));return this}function Lc(t){if(!t){return false}var e=t.toLowerCase();if(typeof Tc[e]!=="undefined"&&Ic[Tc[e]]){return Ic[Tc[e]]}}function Ac(){Rc.forEach(Pc)}var jc={start:Ac,add:Pc,get:Lc};var Nc={};Nc.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Nc.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Nc.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Nc.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Nc.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};Nc.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Nc.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Nc.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};Nc.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Nc.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Nc.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Nc.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};Nc.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Nc.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};Nc.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};Nc.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};Nc.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Nc.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Nc.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};Nc.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};Nc.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};Nc.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};Nc.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};Nc.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Nc.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Nc.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Nc.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Nc.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Nc.hough={a:6378270,rf:297,ellipseName:"Hough"};Nc.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Nc.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Nc.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Nc.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Nc.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};Nc.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Nc.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Nc.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};Nc.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};Nc.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Nc.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Nc.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Fc=Nc.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Nc.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Dc(t,e,r,n){var i=t*t;var o=e*e;var a=(i-o)/i;var s=0;if(n){t*=1-a*(Eh+a*(Oh+a*bh));i=t*t;a=0}else{s=Math.sqrt(a)}var u=(i-o)/o;return{es:a,e:s,ep2:u}}function Gc(t,e,r,n,i){if(!t){var o=Lh(Nc,n);if(!o){o=Fc}t=o.a;e=o.b;r=o.rf}if(r&&!e){e=(1-1/r)*t}if(r===0||Math.abs(t-e)<xh){i=true;e=t}return{a:t,b:e,rf:r,sphere:i}}var kc={};kc.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};kc.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};kc.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};kc.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};kc.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};kc.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};kc.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};kc.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};kc.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};kc.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};kc.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};kc.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};kc.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};kc.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};kc.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};kc.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};kc.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function Uc(t,e,r,n,i,o,a){var s={};if(t===undefined||t==="none"){s.datum_type=dh}else{s.datum_type=ph}if(e){s.datum_params=e.map(parseFloat);if(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0){s.datum_type=hh}if(s.datum_params.length>3){if(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0){s.datum_type=ch;s.datum_params[3]*=yh;s.datum_params[4]*=yh;s.datum_params[5]*=yh;s.datum_params[6]=s.datum_params[6]/1e6+1}}}if(a){s.datum_type=fh;s.grids=a}s.a=r;s.b=n;s.es=i;s.ep2=o;return s}var Bc=Uc;var zc={};function Yc(t,e){var r=new DataView(e);var n=qc(r);var i=Zc(r,n);if(i.nSubgrids>1){console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored")}var o=Hc(r,i,n);var a={header:i,subgrids:o};zc[t]=a;return a}function Wc(t){if(t===undefined){return null}var e=t.split(",");return e.map(Vc)}function Vc(t){if(t.length===0){return null}var e=t[0]==="@";if(e){t=t.slice(1)}if(t==="null"){return{name:"null",mandatory:!e,grid:null,isNull:true}}return{name:t,mandatory:!e,grid:zc[t]||null,isNull:false}}function Xc(t){return t/3600*Math.PI/180}function qc(t){var e=t.getInt32(8,false);if(e===11){return false}e=t.getInt32(8,true);if(e!==11){console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian")}return true}function Zc(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Kc(t,56,56+8).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function Kc(t,e,r){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,r)))}function Hc(t,e,r){var n=176;var i=[];for(var o=0;o<e.nSubgrids;o++){var a=Qc(t,n,r);var s=$c(t,n,a,r);var u=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval);var l=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);i.push({ll:[Xc(a.lowerLongitude),Xc(a.lowerLatitude)],del:[Xc(a.longitudeInterval),Xc(a.latitudeInterval)],lim:[u,l],count:a.gridNodeCount,cvs:Jc(s)})}return i}function Jc(t){return t.map((function(t){return[Xc(t.longitudeShift),Xc(t.latitudeShift)]}))}function Qc(t,e,r){return{name:Kc(t,e+8,e+16).trim(),parent:Kc(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,r),upperLatitude:t.getFloat64(e+88,r),lowerLongitude:t.getFloat64(e+104,r),upperLongitude:t.getFloat64(e+120,r),latitudeInterval:t.getFloat64(e+136,r),longitudeInterval:t.getFloat64(e+152,r),gridNodeCount:t.getInt32(e+168,r)}}function $c(t,e,r,n){var i=e+176;var o=16;var a=[];for(var s=0;s<r.gridNodeCount;s++){var u={latitudeShift:t.getFloat32(i+s*o,n),longitudeShift:t.getFloat32(i+s*o+4,n),latitudeAccuracy:t.getFloat32(i+s*o+8,n),longitudeAccuracy:t.getFloat32(i+s*o+12,n)};a.push(u)}return a}function tf(t,e){if(!(this instanceof tf)){return new tf(t)}e=e||function(t){if(t){throw t}};var r=fc(t);if(typeof r!=="object"){e(t);return}var n=tf.projections.get(r.projName);if(!n){e(t);return}if(r.datumCode&&r.datumCode!=="none"){var i=Lh(kc,r.datumCode);if(i){r.datum_params=r.datum_params||(i.towgs84?i.towgs84.split(","):null);r.ellps=i.ellipse;r.datumName=i.datumName?i.datumName:r.datumCode}}r.k0=r.k0||1;r.axis=r.axis||"enu";r.ellps=r.ellps||"wgs84";r.lat1=r.lat1||r.lat0;var o=Gc(r.a,r.b,r.rf,r.ellps,r.sphere);var a=Dc(o.a,o.b,o.rf,r.R_A);var s=Wc(r.nadgrids);var u=r.datum||Bc(r.datumCode,r.datum_params,o.a,o.b,a.es,a.ep2,s);pc(this,r);pc(this,n);this.a=o.a;this.b=o.b;this.rf=o.rf;this.sphere=o.sphere;this.es=a.es;this.e=a.e;this.ep2=a.ep2;this.datum=u;this.init();e(null,this)}tf.projections=jc;tf.projections.start();var ef=tf;function rf(t,e){if(t.datum_type!==e.datum_type){return false}else if(t.a!==e.a||Math.abs(t.es-e.es)>5e-11){return false}else if(t.datum_type===hh){return t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]}else if(t.datum_type===ch){return t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]}else{return true}}function nf(t,e,r){var n=t.x;var i=t.y;var o=t.z?t.z:0;var a;var s;var u;var l;if(i<-mh&&i>-1.001*mh){i=-mh}else if(i>mh&&i<1.001*mh){i=mh}else if(i<-mh){return{x:-Infinity,y:-Infinity,z:t.z}}else if(i>mh){return{x:Infinity,y:Infinity,z:t.z}}if(n>Math.PI){n-=2*Math.PI}s=Math.sin(i);l=Math.cos(i);u=s*s;a=r/Math.sqrt(1-e*u);return{x:(a+o)*l*Math.cos(n),y:(a+o)*l*Math.sin(n),z:(a*(1-e)+o)*s}}function of(t,e,r,n){var i=1e-12;var o=i*i;var a=30;var s;var u;var l;var h;var c;var f;var p;var d;var v;var _;var g;var y;var m;var E=t.x;var O=t.y;var b=t.z?t.z:0;var x;var w;var M;s=Math.sqrt(E*E+O*O);u=Math.sqrt(E*E+O*O+b*b);if(s/r<i){x=0;if(u/r<i){w=mh;M=-n;return{x:t.x,y:t.y,z:t.z}}}else{x=Math.atan2(O,E)}l=b/u;h=s/u;c=1/Math.sqrt(1-e*(2-e)*h*h);d=h*(1-e)*c;v=l*c;m=0;do{m++;p=r/Math.sqrt(1-e*v*v);M=s*d+b*v-p*(1-e*v*v);f=e*p/(p+M);c=1/Math.sqrt(1-f*(2-f)*h*h);_=h*(1-f)*c;g=l*c;y=g*d-_*v;d=_;v=g}while(y*y>o&&m<a);w=Math.atan(g/Math.abs(_));return{x:x,y:w,z:M}}function af(t,e,r){if(e===hh){return{x:t.x+r[0],y:t.y+r[1],z:t.z+r[2]}}else if(e===ch){var n=r[0];var i=r[1];var o=r[2];var a=r[3];var s=r[4];var u=r[5];var l=r[6];return{x:l*(t.x-u*t.y+s*t.z)+n,y:l*(u*t.x+t.y-a*t.z)+i,z:l*(-s*t.x+a*t.y+t.z)+o}}}function sf(t,e,r){if(e===hh){return{x:t.x-r[0],y:t.y-r[1],z:t.z-r[2]}}else if(e===ch){var n=r[0];var i=r[1];var o=r[2];var a=r[3];var s=r[4];var u=r[5];var l=r[6];var h=(t.x-n)/l;var c=(t.y-i)/l;var f=(t.z-o)/l;return{x:h+u*c-s*f,y:-u*h+c+a*f,z:s*h-a*c+f}}}function uf(t){return t===hh||t===ch}var lf=function(t,e,r){if(rf(t,e)){return r}if(t.datum_type===dh||e.datum_type===dh){return r}var n=t.a;var i=t.es;if(t.datum_type===fh){var o=hf(t,false,r);if(o!==0){return undefined}n=vh;i=gh}var a=e.a;var s=e.b;var u=e.es;if(e.datum_type===fh){a=vh;s=_h;u=gh}if(i===u&&n===a&&!uf(t.datum_type)&&!uf(e.datum_type)){return r}r=nf(r,i,n);if(uf(t.datum_type)){r=af(r,t.datum_type,t.datum_params)}if(uf(e.datum_type)){r=sf(r,e.datum_type,e.datum_params)}r=of(r,u,a,s);if(e.datum_type===fh){var l=hf(e,true,r);if(l!==0){return undefined}}return r};function hf(t,e,r){if(t.grids===null||t.grids.length===0){console.log("Grid shift grids not found");return-1}var n={x:-r.x,y:r.y};var i={x:Number.NaN,y:Number.NaN};var o=false;var a=[];for(var s=0;s<t.grids.length;s++){var u=t.grids[s];a.push(u.name);if(u.isNull){i=n;break}o=u.mandatory;if(u.grid===null){if(u.mandatory){console.log("Unable to find mandatory grid '"+u.name+"'");return-1}continue}var l=u.grid.subgrids[0];var h=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4;var c=l.ll[0]-h;var f=l.ll[1]-h;var p=l.ll[0]+(l.lim[0]-1)*l.del[0]+h;var d=l.ll[1]+(l.lim[1]-1)*l.del[1]+h;if(f>n.y||c>n.x||d<n.y||p<n.x){continue}i=cf(n,e,l);if(!isNaN(i.x)){break}}if(isNaN(i.x)){console.log("Failed to find a grid shift table for location '"+-n.x*Mh+" "+n.y*Mh+" tried: '"+a+"'");return-1}r.x=-i.x;r.y=i.y;return 0}function cf(t,e,r){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x)){return n}var i={x:t.x,y:t.y};i.x-=r.ll[0];i.y-=r.ll[1];i.x=_c(i.x-Math.PI)+Math.PI;var o=ff(i,r);if(e){if(isNaN(o.x)){return n}o.x=i.x-o.x;o.y=i.y-o.y;var a=9,s=1e-12;var u,l;do{l=ff(o,r);if(isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}u={x:i.x-(l.x+o.x),y:i.y-(l.y+o.y)};o.x+=u.x;o.y+=u.y}while(a--&&Math.abs(u.x)>s&&Math.abs(u.y)>s);if(a<0){console.log("Inverse grid shift iterator failed to converge.");return n}n.x=_c(o.x+r.ll[0]);n.y=o.y+r.ll[1]}else{if(!isNaN(o.x)){n.x=t.x+o.x;n.y=t.y+o.y}}return n}function ff(t,e){var r={x:t.x/e.del[0],y:t.y/e.del[1]};var n={x:Math.floor(r.x),y:Math.floor(r.y)};var i={x:r.x-1*n.x,y:r.y-1*n.y};var o={x:Number.NaN,y:Number.NaN};var a;if(n.x<0||n.x>=e.lim[0]){return o}if(n.y<0||n.y>=e.lim[1]){return o}a=n.y*e.lim[0]+n.x;var s={x:e.cvs[a][0],y:e.cvs[a][1]};a++;var u={x:e.cvs[a][0],y:e.cvs[a][1]};a+=e.lim[0];var l={x:e.cvs[a][0],y:e.cvs[a][1]};a--;var h={x:e.cvs[a][0],y:e.cvs[a][1]};var c=i.x*i.y,f=i.x*(1-i.y),p=(1-i.x)*(1-i.y),d=(1-i.x)*i.y;o.x=p*s.x+f*u.x+d*h.x+c*l.x;o.y=p*s.y+f*u.y+d*h.y+c*l.y;return o}var pf=function(t,e,r){var n=r.x,i=r.y,o=r.z||0;var a,s,u;var l={};for(u=0;u<3;u++){if(e&&u===2&&r.z===undefined){continue}if(u===0){a=n;if("ew".indexOf(t.axis[u])!==-1){s="x"}else{s="y"}}else if(u===1){a=i;if("ns".indexOf(t.axis[u])!==-1){s="y"}else{s="x"}}else{a=o;s="z"}switch(t.axis[u]){case"e":l[s]=a;break;case"w":l[s]=-a;break;case"n":l[s]=a;break;case"s":l[s]=-a;break;case"u":if(r[s]!==undefined){l.z=a}break;case"d":if(r[s]!==undefined){l.z=-a}break;default:return null}}return l};var df=function(t){var e={x:t[0],y:t[1]};if(t.length>2){e.z=t[2]}if(t.length>3){e.m=t[3]}return e};var vf=function(t){_f(t.x);_f(t.y)};function _f(t){if(typeof Number.isFinite==="function"){if(Number.isFinite(t)){return}throw new TypeError("coordinates must be finite numbers")}if(typeof t!=="number"||t!==t||!isFinite(t)){throw new TypeError("coordinates must be finite numbers")}}function gf(t,e){return(t.datum.datum_type===hh||t.datum.datum_type===ch)&&e.datumCode!=="WGS84"||(e.datum.datum_type===hh||e.datum.datum_type===ch)&&t.datumCode!=="WGS84"}function yf(t,e,r,n){var i;if(Array.isArray(r)){r=df(r)}vf(r);if(t.datum&&e.datum&&gf(t,e)){i=new ef("WGS84");r=yf(t,i,r,n);t=i}if(n&&t.axis!=="enu"){r=pf(t,false,r)}if(t.projName==="longlat"){r={x:r.x*wh,y:r.y*wh,z:r.z||0}}else{if(t.to_meter){r={x:r.x*t.to_meter,y:r.y*t.to_meter,z:r.z||0}}r=t.inverse(r);if(!r){return}}if(t.from_greenwich){r.x+=t.from_greenwich}r=lf(t.datum,e.datum,r);if(!r){return}if(e.from_greenwich){r={x:r.x-e.from_greenwich,y:r.y,z:r.z||0}}if(e.projName==="longlat"){r={x:r.x*Mh,y:r.y*Mh,z:r.z||0}}else{r=e.forward(r);if(e.to_meter){r={x:r.x/e.to_meter,y:r.y/e.to_meter,z:r.z||0}}}if(n&&e.axis!=="enu"){return pf(e,true,r)}return r}var mf=ef("WGS84");function Ef(t,e,r,n){var i,o,a;if(Array.isArray(r)){i=yf(t,e,r,n)||{x:NaN,y:NaN};if(r.length>2){if(typeof t.name!=="undefined"&&t.name==="geocent"||typeof e.name!=="undefined"&&e.name==="geocent"){if(typeof i.z==="number"){return[i.x,i.y,i.z].concat(r.splice(3))}else{return[i.x,i.y,r[2]].concat(r.splice(3))}}else{return[i.x,i.y].concat(r.splice(2))}}else{return[i.x,i.y]}}else{o=yf(t,e,r,n);a=Object.keys(r);if(a.length===2){return o}a.forEach((function(n){if(typeof t.name!=="undefined"&&t.name==="geocent"||typeof e.name!=="undefined"&&e.name==="geocent"){if(n==="x"||n==="y"||n==="z"){return}}else{if(n==="x"||n==="y"){return}}o[n]=r[n]}));return o}}function Of(t){if(t instanceof ef){return t}if(t.oProj){return t.oProj}return ef(t)}function bf(t,e,r){t=Of(t);var n=false;var i;if(typeof e==="undefined"){e=t;t=mf;n=true}else if(typeof e.x!=="undefined"||Array.isArray(e)){r=e;e=t;t=mf;n=true}e=Of(e);if(r){return Ef(t,e,r)}else{i={forward:function(r,n){return Ef(t,e,r,n)},inverse:function(r,n){return Ef(e,t,r,n)}};if(n){i.oProj=e}return i}}var xf=bf;var wf=6;var Mf="AJSAJS";var Sf="AFAFAF";var Cf=65;var Rf=73;var Tf=79;var If=86;var Pf=90;var Lf={forward:Af,inverse:jf,toPoint:Nf};function Af(t,e){e=e||5;return Bf(Gf({lat:t[1],lon:t[0]}),e)}function jf(t){var e=kf(Vf(t.toUpperCase()));if(e.lat&&e.lon){return[e.lon,e.lat,e.lon,e.lat]}return[e.left,e.bottom,e.right,e.top]}function Nf(t){var e=kf(Vf(t.toUpperCase()));if(e.lat&&e.lon){return[e.lon,e.lat]}return[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Ff(t){return t*(Math.PI/180)}function Df(t){return 180*(t/Math.PI)}function Gf(t){var e=t.lat;var r=t.lon;var n=6378137;var i=.00669438;var o=.9996;var a;var s;var u,l,h,c,f;var p=Ff(e);var d=Ff(r);var v;var _;_=Math.floor((r+180)/6)+1;if(r===180){_=60}if(e>=56&&e<64&&r>=3&&r<12){_=32}if(e>=72&&e<84){if(r>=0&&r<9){_=31}else if(r>=9&&r<21){_=33}else if(r>=21&&r<33){_=35}else if(r>=33&&r<42){_=37}}a=(_-1)*6-180+3;v=Ff(a);s=i/(1-i);u=n/Math.sqrt(1-i*Math.sin(p)*Math.sin(p));l=Math.tan(p)*Math.tan(p);h=s*Math.cos(p)*Math.cos(p);c=Math.cos(p)*(d-v);f=n*((1-i/4-3*i*i/64-5*i*i*i/256)*p-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*p)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*p)-35*i*i*i/3072*Math.sin(6*p));var g=o*u*(c+(1-l+h)*c*c*c/6+(5-18*l+l*l+72*h-58*s)*c*c*c*c*c/120)+5e5;var y=o*(f+u*Math.tan(p)*(c*c/2+(5-l+9*h+4*h*h)*c*c*c*c/24+(61-58*l+l*l+600*h-330*s)*c*c*c*c*c*c/720));if(e<0){y+=1e7}return{northing:Math.round(y),easting:Math.round(g),zoneNumber:_,zoneLetter:Uf(e)}}function kf(t){var e=t.northing;var r=t.easting;var n=t.zoneLetter;var i=t.zoneNumber;if(i<0||i>60){return null}var o=.9996;var a=6378137;var s=.00669438;var u;var l=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s));var h,c,f,p,d,v;var _;var g,y;var m=r-5e5;var E=e;if(n<"N"){E-=1e7}_=(i-1)*6-180+3;u=s/(1-s);v=E/o;g=v/(a*(1-s/4-3*s*s/64-5*s*s*s/256));y=g+(3*l/2-27*l*l*l/32)*Math.sin(2*g)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*g)+151*l*l*l/96*Math.sin(6*g);h=a/Math.sqrt(1-s*Math.sin(y)*Math.sin(y));c=Math.tan(y)*Math.tan(y);f=u*Math.cos(y)*Math.cos(y);p=a*(1-s)/Math.pow(1-s*Math.sin(y)*Math.sin(y),1.5);d=m/(h*o);var O=y-h*Math.tan(y)/p*(d*d/2-(5+3*c+10*f-4*f*f-9*u)*d*d*d*d/24+(61+90*c+298*f+45*c*c-252*u-3*f*f)*d*d*d*d*d*d/720);O=Df(O);var b=(d-(1+2*c+f)*d*d*d/6+(5-2*f+28*c-3*f*f+8*u+24*c*c)*d*d*d*d*d/120)/Math.cos(y);b=_+Df(b);var x;if(t.accuracy){var w=kf({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:w.lat,right:w.lon,bottom:O,left:b}}else{x={lat:O,lon:b}}return x}function Uf(t){var e="Z";if(84>=t&&t>=72){e="X"}else if(72>t&&t>=64){e="W"}else if(64>t&&t>=56){e="V"}else if(56>t&&t>=48){e="U"}else if(48>t&&t>=40){e="T"}else if(40>t&&t>=32){e="S"}else if(32>t&&t>=24){e="R"}else if(24>t&&t>=16){e="Q"}else if(16>t&&t>=8){e="P"}else if(8>t&&t>=0){e="N"}else if(0>t&&t>=-8){e="M"}else if(-8>t&&t>=-16){e="L"}else if(-16>t&&t>=-24){e="K"}else if(-24>t&&t>=-32){e="J"}else if(-32>t&&t>=-40){e="H"}else if(-40>t&&t>=-48){e="G"}else if(-48>t&&t>=-56){e="F"}else if(-56>t&&t>=-64){e="E"}else if(-64>t&&t>=-72){e="D"}else if(-72>t&&t>=-80){e="C"}return e}function Bf(t,e){var r="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+zf(t.easting,t.northing,t.zoneNumber)+r.substr(r.length-5,e)+n.substr(n.length-5,e)}function zf(t,e,r){var n=Yf(r);var i=Math.floor(t/1e5);var o=Math.floor(e/1e5)%20;return Wf(i,o,n)}function Yf(t){var e=t%wf;if(e===0){e=wf}return e}function Wf(t,e,r){var n=r-1;var i=Mf.charCodeAt(n);var o=Sf.charCodeAt(n);var a=i+t-1;var s=o+e;var u=false;if(a>Pf){a=a-Pf+Cf-1;u=true}if(a===Rf||i<Rf&&a>Rf||(a>Rf||i<Rf)&&u){a++}if(a===Tf||i<Tf&&a>Tf||(a>Tf||i<Tf)&&u){a++;if(a===Rf){a++}}if(a>Pf){a=a-Pf+Cf-1}if(s>If){s=s-If+Cf-1;u=true}else{u=false}if(s===Rf||o<Rf&&s>Rf||(s>Rf||o<Rf)&&u){s++}if(s===Tf||o<Tf&&s>Tf||(s>Tf||o<Tf)&&u){s++;if(s===Rf){s++}}if(s>If){s=s-If+Cf-1}var l=String.fromCharCode(a)+String.fromCharCode(s);return l}function Vf(t){if(t&&t.length===0){throw"MGRSPoint coverting from nothing"}var e=t.length;var r=null;var n="";var i;var o=0;while(!/[A-Z]/.test(i=t.charAt(o))){if(o>=2){throw"MGRSPoint bad conversion from: "+t}n+=i;o++}var a=parseInt(n,10);if(o===0||o+3>e){throw"MGRSPoint bad conversion from: "+t}var s=t.charAt(o++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O"){throw"MGRSPoint zone letter "+s+" not handled: "+t}r=t.substring(o,o+=2);var u=Yf(a);var l=Xf(r.charAt(0),u);var h=qf(r.charAt(1),u);while(h<Zf(s)){h+=2e6}var c=e-o;if(c%2!==0){throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t}var f=c/2;var p=0;var d=0;var v,_,g,y,m;if(f>0){v=1e5/Math.pow(10,f);_=t.substring(o,o+f);p=parseFloat(_)*v;g=t.substring(o+f);d=parseFloat(g)*v}y=p+l;m=d+h;return{easting:y,northing:m,zoneLetter:s,zoneNumber:a,accuracy:v}}function Xf(t,e){var r=Mf.charCodeAt(e-1);var n=1e5;var i=false;while(r!==t.charCodeAt(0)){r++;if(r===Rf){r++}if(r===Tf){r++}if(r>Pf){if(i){throw"Bad character: "+t}r=Cf;i=true}n+=1e5}return n}function qf(t,e){if(t>"V"){throw"MGRSPoint given invalid Northing "+t}var r=Sf.charCodeAt(e-1);var n=0;var i=false;while(r!==t.charCodeAt(0)){r++;if(r===Rf){r++}if(r===Tf){r++}if(r>If){if(i){throw"Bad character: "+t}r=Cf;i=true}n+=1e5}return n}function Zf(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0){return e}else{throw"Invalid zone letter: "+t}}function Kf(t,e,r){if(!(this instanceof Kf)){return new Kf(t,e,r)}if(Array.isArray(t)){this.x=t[0];this.y=t[1];this.z=t[2]||0}else if(typeof t==="object"){this.x=t.x;this.y=t.y;this.z=t.z||0}else if(typeof t==="string"&&typeof e==="undefined"){var n=t.split(",");this.x=parseFloat(n[0],10);this.y=parseFloat(n[1],10);this.z=parseFloat(n[2],10)||0}else{this.x=t;this.y=e;this.z=r||0}console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Kf.fromMGRS=function(t){return new Kf(Nf(t))};Kf.prototype.toMGRS=function(t){return Af([this.x,this.y],t)};var Hf=Kf;var Jf=1;var Qf=.25;var $f=.046875;var tp=.01953125;var ep=.01068115234375;var rp=.75;var np=.46875;var ip=.013020833333333334;var op=.007120768229166667;var ap=.3645833333333333;var sp=.005696614583333333;var up=.3076171875;var lp=function(t){var e=[];e[0]=Jf-t*(Qf+t*($f+t*(tp+t*ep)));e[1]=t*(rp-t*($f+t*(tp+t*ep)));var r=t*t;e[2]=r*(np-t*(ip+t*op));r*=t;e[3]=r*(ap-t*sp);e[4]=r*t*up;return e};var hp=function(t,e,r,n){r*=e;e*=e;return n[0]*t-r*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))};var cp=20;var fp=function(t,e,r){var n=1/(1-e);var i=t;for(var o=cp;o;--o){var a=Math.sin(i);var s=1-e*a*a;s=(hp(i,a,Math.cos(i),r)-t)*(s*Math.sqrt(s))*n;i-=s;if(Math.abs(s)<xh){return i}}return i};function pp(){this.x0=this.x0!==undefined?this.x0:0;this.y0=this.y0!==undefined?this.y0:0;this.long0=this.long0!==undefined?this.long0:0;this.lat0=this.lat0!==undefined?this.lat0:0;if(this.es){this.en=lp(this.es);this.ml0=hp(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en)}}function dp(t){var e=t.x;var r=t.y;var n=_c(e-this.long0);var i;var o,a;var s=Math.sin(r);var u=Math.cos(r);if(!this.es){var l=u*Math.sin(n);if(Math.abs(Math.abs(l)-1)<xh){return 93}else{o=.5*this.a*this.k0*Math.log((1+l)/(1-l))+this.x0;a=u*Math.cos(n)/Math.sqrt(1-Math.pow(l,2));l=Math.abs(a);if(l>=1){if(l-1>xh){return 93}else{a=0}}else{a=Math.acos(a)}if(r<0){a=-a}a=this.a*this.k0*(a-this.lat0)+this.y0}}else{var h=u*n;var c=Math.pow(h,2);var f=this.ep2*Math.pow(u,2);var p=Math.pow(f,2);var d=Math.abs(u)>xh?Math.tan(r):0;var v=Math.pow(d,2);var _=Math.pow(v,2);i=1-this.es*Math.pow(s,2);h=h/Math.sqrt(i);var g=hp(r,s,u,this.en);o=this.a*(this.k0*h*(1+c/6*(1-v+f+c/20*(5-18*v+_+14*f-58*v*f+c/42*(61+179*_-_*v-479*v)))))+this.x0;a=this.a*(this.k0*(g-this.ml0+s*n*h/2*(1+c/12*(5-v+9*f+4*p+c/30*(61+_-58*v+270*f-330*v*f+c/56*(1385+543*_-_*v-3111*v))))))+this.y0}t.x=o;t.y=a;return t}function vp(t){var e,r;var n,i;var o=(t.x-this.x0)*(1/this.a);var a=(t.y-this.y0)*(1/this.a);if(!this.es){var s=Math.exp(o/this.k0);var u=.5*(s-1/s);var l=this.lat0+a/this.k0;var h=Math.cos(l);e=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(u,2)));n=Math.asin(e);if(a<0){n=-n}if(u===0&&h===0){i=0}else{i=_c(Math.atan2(u,h)+this.long0)}}else{e=this.ml0+a/this.k0;r=fp(e,this.es,this.en);if(Math.abs(r)<mh){var c=Math.sin(r);var f=Math.cos(r);var p=Math.abs(f)>xh?Math.tan(r):0;var d=this.ep2*Math.pow(f,2);var v=Math.pow(d,2);var _=Math.pow(p,2);var g=Math.pow(_,2);e=1-this.es*Math.pow(c,2);var y=o*Math.sqrt(e)/this.k0;var m=Math.pow(y,2);e=e*p;n=r-e*m/(1-this.es)*.5*(1-m/12*(5+3*_-9*d*_+d-4*v-m/30*(61+90*_-252*d*_+45*g+46*d-m/56*(1385+3633*_+4095*g+1574*g*_))));i=_c(this.long0+y*(1-m/6*(1+2*_+d-m/20*(5+28*_+24*g+8*d*_+6*d-m/42*(61+662*_+1320*g+720*g*_))))/f)}else{n=mh*vc(a);i=0}}t.x=i;t.y=n;return t}var _p=["Fast_Transverse_Mercator","Fast Transverse Mercator"];var gp={init:pp,forward:dp,inverse:vp,names:_p};var yp=function(t){var e=Math.exp(t);e=(e-1/e)/2;return e};var mp=function(t,e){t=Math.abs(t);e=Math.abs(e);var r=Math.max(t,e);var n=Math.min(t,e)/(r?r:1);return r*Math.sqrt(1+Math.pow(n,2))};var Ep=function(t){var e=1+t;var r=e-1;return r===0?t:t*Math.log(e)/r};var Op=function(t){var e=Math.abs(t);e=Ep(e*(1+e/(mp(1,e)+1)));return t<0?-e:e};var bp=function(t,e){var r=2*Math.cos(2*e);var n=t.length-1;var i=t[n];var o=0;var a;while(--n>=0){a=-o+r*i+t[n];o=i;i=a}return e+a*Math.sin(2*e)};var xp=function(t,e){var r=2*Math.cos(e);var n=t.length-1;var i=t[n];var o=0;var a;while(--n>=0){a=-o+r*i+t[n];o=i;i=a}return Math.sin(e)*a};var wp=function(t){var e=Math.exp(t);e=(e+1/e)/2;return e};var Mp=function(t,e,r){var n=Math.sin(e);var i=Math.cos(e);var o=yp(r);var a=wp(r);var s=2*i*a;var u=-2*n*o;var l=t.length-1;var h=t[l];var c=0;var f=0;var p=0;var d;var v;while(--l>=0){d=f;v=c;f=h;c=p;h=-d+s*f-u*c+t[l];p=-v+u*f+s*c}s=n*a;u=i*o;return[s*h-u*p,s*p+u*h]};function Sp(){if(!this.approx&&(isNaN(this.es)||this.es<=0)){throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.')}if(this.approx){gp.init.apply(this);this.forward=gp.forward;this.inverse=gp.inverse}this.x0=this.x0!==undefined?this.x0:0;this.y0=this.y0!==undefined?this.y0:0;this.long0=this.long0!==undefined?this.long0:0;this.lat0=this.lat0!==undefined?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es));var e=t/(2-t);var r=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675))))));this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725))))));r=r*e;this.cgb[1]=r*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945)))));this.cbg[1]=r*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945)))));r=r*e;this.cgb[2]=r*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835))));this.cbg[2]=r*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835))));r=r*e;this.cgb[3]=r*(4279/630+e*(-332/35+e*(-399572/14175)));this.cbg[3]=r*(1237/630+e*(-12/5+e*(-24832/14175)));r=r*e;this.cgb[4]=r*(4174/315+e*(-144838/6237));this.cbg[4]=r*(-734/315+e*(109598/31185));r=r*e;this.cgb[5]=r*(601676/22275);this.cbg[5]=r*(444337/155925);r=Math.pow(e,2);this.Qn=this.k0/(1+e)*(1+r*(1/4+r*(1/64+r/256)));this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800))))));this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800))))));this.utg[1]=r*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720)))));this.gtu[1]=r*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360)))));r=r*e;this.utg[2]=r*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720))));this.gtu[2]=r*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440))));r=r*e;this.utg[3]=r*(-4397/161280+e*(11/504+e*(830251/7257600)));this.gtu[3]=r*(49561/161280+e*(-179/168+e*(6601661/7257600)));r=r*e;this.utg[4]=r*(-4583/161280+e*(108847/3991680));this.gtu[4]=r*(34729/80640+e*(-3418889/1995840));r=r*e;this.utg[5]=r*(-20648693/638668800);this.gtu[5]=r*(212378941/319334400);var n=bp(this.cbg,this.lat0);this.Zb=-this.Qn*(n+xp(this.gtu,2*n))}function Cp(t){var e=_c(t.x-this.long0);var r=t.y;r=bp(this.cbg,r);var n=Math.sin(r);var i=Math.cos(r);var o=Math.sin(e);var a=Math.cos(e);r=Math.atan2(n,a*i);e=Math.atan2(o*i,mp(n,i*a));e=Op(Math.tan(e));var s=Mp(this.gtu,2*r,2*e);r=r+s[0];e=e+s[1];var u;var l;if(Math.abs(e)<=2.623395162778){u=this.a*(this.Qn*e)+this.x0;l=this.a*(this.Qn*r+this.Zb)+this.y0}else{u=Infinity;l=Infinity}t.x=u;t.y=l;return t}function Rp(t){var e=(t.x-this.x0)*(1/this.a);var r=(t.y-this.y0)*(1/this.a);r=(r-this.Zb)/this.Qn;e=e/this.Qn;var n;var i;if(Math.abs(e)<=2.623395162778){var o=Mp(this.utg,2*r,2*e);r=r+o[0];e=e+o[1];e=Math.atan(yp(e));var a=Math.sin(r);var s=Math.cos(r);var u=Math.sin(e);var l=Math.cos(e);r=Math.atan2(a*l,mp(u,l*s));e=Math.atan2(u,l*s);n=_c(e+this.long0);i=bp(this.cgb,r)}else{n=Infinity;i=Infinity}t.x=n;t.y=i;return t}var Tp=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"];var Ip={init:Sp,forward:Cp,inverse:Rp,names:Tp};var Pp=function(t,e){if(t===undefined){t=Math.floor((_c(e)+Math.PI)*30/Math.PI)+1;if(t<0){return 0}else if(t>60){return 60}}return t};var Lp="etmerc";function Ap(){var t=Pp(this.zone,this.long0);if(t===undefined){throw new Error("unknown utm zone")}this.lat0=0;this.long0=(6*Math.abs(t)-183)*wh;this.x0=5e5;this.y0=this.utmSouth?1e7:0;this.k0=.9996;Ip.init.apply(this);this.forward=Ip.forward;this.inverse=Ip.inverse}var jp=["Universal Transverse Mercator System","utm"];var Np={init:Ap,names:jp,dependsOn:Lp};var Fp=function(t,e){return Math.pow((1-t)/(1+t),e)};var Dp=20;function Gp(){var t=Math.sin(this.lat0);var e=Math.cos(this.lat0);e*=e;this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t);this.C=Math.sqrt(1+this.es*e*e/(1-this.es));this.phic0=Math.asin(t/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+Sh)/(Math.pow(Math.tan(.5*this.lat0+Sh),this.C)*Fp(this.e*t,this.ratexp))}function kp(t){var e=t.x;var r=t.y;t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*r+Sh),this.C)*Fp(this.e*Math.sin(r),this.ratexp))-mh;t.x=this.C*e;return t}function Up(t){var e=1e-14;var r=t.x/this.C;var n=t.y;var i=Math.pow(Math.tan(.5*n+Sh)/this.K,1/this.C);for(var o=Dp;o>0;--o){n=2*Math.atan(i*Fp(this.e*Math.sin(t.y),-.5*this.e))-mh;if(Math.abs(n-t.y)<e){break}t.y=n}if(!o){return null}t.x=r;t.y=n;return t}var Bp=["gauss"];var zp={init:Gp,forward:kp,inverse:Up,names:Bp};function Yp(){zp.init.apply(this);if(!this.rc){return}this.sinc0=Math.sin(this.phic0);this.cosc0=Math.cos(this.phic0);this.R2=2*this.rc;if(!this.title){this.title="Oblique Stereographic Alternative"}}function Wp(t){var e,r,n,i;t.x=_c(t.x-this.long0);zp.forward.apply(this,[t]);e=Math.sin(t.y);r=Math.cos(t.y);n=Math.cos(t.x);i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*r*n);t.x=i*r*Math.sin(t.x);t.y=i*(this.cosc0*e-this.sinc0*r*n);t.x=this.a*t.x+this.x0;t.y=this.a*t.y+this.y0;return t}function Vp(t){var e,r,n,i,o;t.x=(t.x-this.x0)/this.a;t.y=(t.y-this.y0)/this.a;t.x/=this.k0;t.y/=this.k0;if(o=Math.sqrt(t.x*t.x+t.y*t.y)){var a=2*Math.atan2(o,this.R2);e=Math.sin(a);r=Math.cos(a);i=Math.asin(r*this.sinc0+t.y*e*this.cosc0/o);n=Math.atan2(t.x*e,o*this.cosc0*r-t.y*this.sinc0*e)}else{i=this.phic0;n=0}t.x=n;t.y=i;zp.inverse.apply(this,[t]);t.x=_c(t.x+this.long0);return t}var Xp=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];var qp={init:Yp,forward:Wp,inverse:Vp,names:Xp};function Zp(t,e,r){e*=r;return Math.tan(.5*(mh+t))*Math.pow((1-e)/(1+e),.5*r)}function Kp(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);if(this.sphere){if(this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=xh){this.k0=.5*(1+vc(this.lat0)*Math.sin(this.lat_ts))}}else{if(Math.abs(this.coslat0)<=xh){if(this.lat0>0){this.con=1}else{this.con=-1}}this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e));if(this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=xh){this.k0=.5*this.cons*dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/gc(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))}this.ms1=dc(this.e,this.sinlat0,this.coslat0);this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-mh;this.cosX0=Math.cos(this.X0);this.sinX0=Math.sin(this.X0)}}function Hp(t){var e=t.x;var r=t.y;var n=Math.sin(r);var i=Math.cos(r);var o,a,s,u,l,h;var c=_c(e-this.long0);if(Math.abs(Math.abs(e-this.long0)-Math.PI)<=xh&&Math.abs(r+this.lat0)<=xh){t.x=NaN;t.y=NaN;return t}if(this.sphere){o=2*this.k0/(1+this.sinlat0*n+this.coslat0*i*Math.cos(c));t.x=this.a*o*i*Math.sin(c)+this.x0;t.y=this.a*o*(this.coslat0*n-this.sinlat0*i*Math.cos(c))+this.y0;return t}else{a=2*Math.atan(this.ssfn_(r,n,this.e))-mh;u=Math.cos(a);s=Math.sin(a);if(Math.abs(this.coslat0)<=xh){l=gc(this.e,r*this.con,this.con*n);h=2*this.a*this.k0*l/this.cons;t.x=this.x0+h*Math.sin(e-this.long0);t.y=this.y0-this.con*h*Math.cos(e-this.long0);return t}else if(Math.abs(this.sinlat0)<xh){o=2*this.a*this.k0/(1+u*Math.cos(c));t.y=o*s}else{o=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*u*Math.cos(c)));t.y=o*(this.cosX0*s-this.sinX0*u*Math.cos(c))+this.y0}t.x=o*u*Math.sin(c)+this.x0}return t}function Jp(t){t.x-=this.x0;t.y-=this.y0;var e,r,n,i,o;var a=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(a/(2*this.a*this.k0));e=this.long0;r=this.lat0;if(a<=xh){t.x=e;t.y=r;return t}r=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/a);if(Math.abs(this.coslat0)<xh){if(this.lat0>0){e=_c(this.long0+Math.atan2(t.x,-1*t.y))}else{e=_c(this.long0+Math.atan2(t.x,t.y))}}else{e=_c(this.long0+Math.atan2(t.x*Math.sin(s),a*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s)))}t.x=e;t.y=r;return t}else{if(Math.abs(this.coslat0)<=xh){if(a<=xh){r=this.lat0;e=this.long0;t.x=e;t.y=r;return t}t.x*=this.con;t.y*=this.con;n=a*this.cons/(2*this.a*this.k0);r=this.con*yc(this.e,n);e=this.con*_c(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else{i=2*Math.atan(a*this.cosX0/(2*this.a*this.k0*this.ms1));e=this.long0;if(a<=xh){o=this.X0}else{o=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/a);e=_c(this.long0+Math.atan2(t.x*Math.sin(i),a*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))}r=-1*yc(this.e,Math.tan(.5*(mh+o)))}}t.x=e;t.y=r;return t}var Qp=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];var $p={init:Kp,forward:Hp,inverse:Jp,names:Qp,ssfn_:Zp};function td(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t);var r=this.a;var n=this.rf;var i=1/n;var o=2*i-Math.pow(i,2);var a=this.e=Math.sqrt(o);this.R=this.k0*r*Math.sqrt(1-o)/(1-o*Math.pow(e,2));this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4));this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2));var u=Math.log(Math.tan(Math.PI/4+t/2));var l=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*u+this.alpha*a/2*l}function ed(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2));var r=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y)));var n=-this.alpha*(e+r)+this.K;var i=2*(Math.atan(Math.exp(n))-Math.PI/4);var o=this.alpha*(t.x-this.lambda0);var a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o)));var s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0;t.x=this.R*a+this.x0;return t}function rd(t){var e=t.x-this.x0;var r=t.y-this.y0;var n=e/this.R;var i=2*(Math.atan(Math.exp(r/this.R))-Math.PI/4);var o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(n));var a=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(i)));var s=this.lambda0+a/this.alpha;var u=0;var l=o;var h=-1e3;var c=0;while(Math.abs(l-h)>1e-7){if(++c>20){return}u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2));h=l;l=2*Math.atan(Math.exp(u))-Math.PI/2}t.x=s;t.y=l;return t}var nd=["somerc"];var id={init:td,forward:ed,inverse:rd,names:nd};var od=1e-7;function ad(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"];var r=typeof t.PROJECTION==="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||e.indexOf(r)!==-1}function sd(){var t,e,r,n,i,o,a,s,u,l,h=0,c,f=0,p=0,d=0,v=0,_=0,g=0,y;this.no_off=ad(this);this.no_rot="no_rot"in this;var m=false;if("alpha"in this){m=true}var E=false;if("rectified_grid_angle"in this){E=true}if(m){g=this.alpha}if(E){h=this.rectified_grid_angle*wh}if(m||E){f=this.longc}else{p=this.long1;v=this.lat1;d=this.long2;_=this.lat2;if(Math.abs(v-_)<=od||(t=Math.abs(v))<=od||Math.abs(t-mh)<=od||Math.abs(Math.abs(this.lat0)-mh)<=od||Math.abs(Math.abs(_)-mh)<=od){throw new Error}}var O=1-this.es;e=Math.sqrt(O);if(Math.abs(this.lat0)>xh){s=Math.sin(this.lat0);r=Math.cos(this.lat0);t=1-this.es*s*s;this.B=r*r;this.B=Math.sqrt(1+this.es*this.B*this.B/O);this.A=this.B*this.k0*e/t;n=this.B*e/(r*Math.sqrt(t));i=n*n-1;if(i<=0){i=0}else{i=Math.sqrt(i);if(this.lat0<0){i=-i}}this.E=i+=n;this.E*=Math.pow(gc(this.e,this.lat0,s),this.B)}else{this.B=1/e;this.A=this.k0;this.E=n=i=1}if(m||E){if(m){c=Math.asin(Math.sin(g)/n);if(!E){h=g}}else{c=h;g=Math.asin(n*Math.sin(c))}this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(c))/this.B}else{o=Math.pow(gc(this.e,v,Math.sin(v)),this.B);a=Math.pow(gc(this.e,_,Math.sin(_)),this.B);i=this.E/o;u=(a-o)/(a+o);l=this.E*this.E;l=(l-a*o)/(l+a*o);t=p-d;if(t<-Math.pi){d-=Ch}else if(t>Math.pi){d+=Ch}this.lam0=_c(.5*(p+d)-Math.atan(l*Math.tan(.5*this.B*(p-d))/u)/this.B);c=Math.atan(2*Math.sin(this.B*_c(p-this.lam0))/(i-1/i));h=g=Math.asin(n*Math.sin(c))}this.singam=Math.sin(c);this.cosgam=Math.cos(c);this.sinrot=Math.sin(h);this.cosrot=Math.cos(h);this.rB=1/this.B;this.ArB=this.A*this.rB;this.BrA=1/this.ArB;y=this.A*this.B;if(this.no_off){this.u_0=0}else{this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(g)));if(this.lat0<0){this.u_0=-this.u_0}}i=.5*c;this.v_pole_n=this.ArB*Math.log(Math.tan(Sh-i));this.v_pole_s=this.ArB*Math.log(Math.tan(Sh+i))}function ud(t){var e={};var r,n,i,o,a,s,u,l;t.x=t.x-this.lam0;if(Math.abs(Math.abs(t.y)-mh)>xh){a=this.E/Math.pow(gc(this.e,t.y,Math.sin(t.y)),this.B);s=1/a;r=.5*(a-s);n=.5*(a+s);o=Math.sin(this.B*t.x);i=(r*this.singam-o*this.cosgam)/n;if(Math.abs(Math.abs(i)-1)<xh){throw new Error}l=.5*this.ArB*Math.log((1-i)/(1+i));s=Math.cos(this.B*t.x);if(Math.abs(s)<od){u=this.A*t.x}else{u=this.ArB*Math.atan2(r*this.cosgam+o*this.singam,s)}}else{l=t.y>0?this.v_pole_n:this.v_pole_s;u=this.ArB*t.y}if(this.no_rot){e.x=u;e.y=l}else{u-=this.u_0;e.x=l*this.cosrot+u*this.sinrot;e.y=u*this.cosrot-l*this.sinrot}e.x=this.a*e.x+this.x0;e.y=this.a*e.y+this.y0;return e}function ld(t){var e,r,n,i,o,a,s;var u={};t.x=(t.x-this.x0)*(1/this.a);t.y=(t.y-this.y0)*(1/this.a);if(this.no_rot){r=t.y;e=t.x}else{r=t.x*this.cosrot-t.y*this.sinrot;e=t.y*this.cosrot+t.x*this.sinrot+this.u_0}n=Math.exp(-this.BrA*r);i=.5*(n-1/n);o=.5*(n+1/n);a=Math.sin(this.BrA*e);s=(a*this.cosgam+i*this.singam)/o;if(Math.abs(Math.abs(s)-1)<xh){u.x=0;u.y=s<0?-mh:mh}else{u.y=this.E/Math.sqrt((1+s)/(1-s));u.y=yc(this.e,Math.pow(u.y,1/this.B));if(u.y===Infinity){throw new Error}u.x=-this.rB*Math.atan2(i*this.cosgam-a*this.singam,Math.cos(this.BrA*e))}u.x+=this.lam0;return u}var hd=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];var cd={init:sd,forward:ud,inverse:ld,names:hd};function fd(){if(!this.lat2){this.lat2=this.lat1}if(!this.k0){this.k0=1}this.x0=this.x0||0;this.y0=this.y0||0;if(Math.abs(this.lat1+this.lat2)<xh){return}var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1);var r=Math.cos(this.lat1);var n=dc(this.e,e,r);var i=gc(this.e,this.lat1,e);var o=Math.sin(this.lat2);var a=Math.cos(this.lat2);var s=dc(this.e,o,a);var u=gc(this.e,this.lat2,o);var l=gc(this.e,this.lat0,Math.sin(this.lat0));if(Math.abs(this.lat1-this.lat2)>xh){this.ns=Math.log(n/s)/Math.log(i/u)}else{this.ns=e}if(isNaN(this.ns)){this.ns=e}this.f0=n/(this.ns*Math.pow(i,this.ns));this.rh=this.a*this.f0*Math.pow(l,this.ns);if(!this.title){this.title="Lambert Conformal Conic"}}function pd(t){var e=t.x;var r=t.y;if(Math.abs(2*Math.abs(r)-Math.PI)<=xh){r=vc(r)*(mh-2*xh)}var n=Math.abs(Math.abs(r)-mh);var i,o;if(n>xh){i=gc(this.e,r,Math.sin(r));o=this.a*this.f0*Math.pow(i,this.ns)}else{n=r*this.ns;if(n<=0){return null}o=0}var a=this.ns*_c(e-this.long0);t.x=this.k0*(o*Math.sin(a))+this.x0;t.y=this.k0*(this.rh-o*Math.cos(a))+this.y0;return t}function dd(t){var e,r,n;var i,o;var a=(t.x-this.x0)/this.k0;var s=this.rh-(t.y-this.y0)/this.k0;if(this.ns>0){e=Math.sqrt(a*a+s*s);r=1}else{e=-Math.sqrt(a*a+s*s);r=-1}var u=0;if(e!==0){u=Math.atan2(r*a,r*s)}if(e!==0||this.ns>0){r=1/this.ns;n=Math.pow(e/(this.a*this.f0),r);i=yc(this.e,n);if(i===-9999){return null}}else{i=-mh}o=_c(u/this.ns+this.long0);t.x=o;t.y=i;return t}var vd=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"];var _d={init:fd,forward:pd,inverse:dd,names:vd};function gd(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);if(!this.lat0){this.lat0=.863937979737193}if(!this.long0){this.long0=.7417649320975901-.308341501185665}if(!this.k0){this.k0=.9999}this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq}function yd(t){var e,r,n,i,o,a,s;var u=t.x;var l=t.y;var h=_c(u-this.long0);e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2);r=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45);n=-h*this.alfa;i=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(n));o=Math.asin(Math.cos(r)*Math.sin(n)/Math.cos(i));a=this.n*o;s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n);t.y=s*Math.cos(a)/1;t.x=s*Math.sin(a)/1;if(!this.czech){t.y*=-1;t.x*=-1}return t}function md(t){var e,r,n,i,o,a,s;var u;var l=t.x;t.x=t.y;t.y=l;if(!this.czech){t.y*=-1;t.x*=-1}a=Math.sqrt(t.x*t.x+t.y*t.y);o=Math.atan2(t.y,t.x);i=o/Math.sin(this.s0);n=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(i));r=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(e));t.x=this.long0-r/this.alfa;s=e;u=0;var h=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45);if(Math.abs(s-t.y)<1e-10){u=1}s=t.y;h+=1}while(u===0&&h<15);if(h>=15){return null}return t}var Ed=["Krovak","krovak"];var Od={init:gd,forward:yd,inverse:md,names:Ed};var bd=function(t,e,r,n,i){return t*i-e*Math.sin(2*i)+r*Math.sin(4*i)-n*Math.sin(6*i)};var xd=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))};var wd=function(t){return.375*t*(1+.25*t*(1+.46875*t))};var Md=function(t){return.05859375*t*t*(1+.75*t)};var Sd=function(t){return t*t*t*(35/3072)};var Cd=function(t,e,r){var n=e*r;return t/Math.sqrt(1-n*n)};var Rd=function(t){return Math.abs(t)<mh?t:t-vc(t)*Math.PI};var Td=function(t,e,r,n,i){var o;var a;o=t/e;for(var s=0;s<15;s++){a=(t-(e*o-r*Math.sin(2*o)+n*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*r*Math.cos(2*o)+4*n*Math.cos(4*o)-6*i*Math.cos(6*o));o+=a;if(Math.abs(a)<=1e-10){return o}}return NaN};function Id(){if(!this.sphere){this.e0=xd(this.es);this.e1=wd(this.es);this.e2=Md(this.es);this.e3=Sd(this.es);this.ml0=this.a*bd(this.e0,this.e1,this.e2,this.e3,this.lat0)}}function Pd(t){var e,r;var n=t.x;var i=t.y;n=_c(n-this.long0);if(this.sphere){e=this.a*Math.asin(Math.cos(i)*Math.sin(n));r=this.a*(Math.atan2(Math.tan(i),Math.cos(n))-this.lat0)}else{var o=Math.sin(i);var a=Math.cos(i);var s=Cd(this.a,this.e,o);var u=Math.tan(i)*Math.tan(i);var l=n*Math.cos(i);var h=l*l;var c=this.es*a*a/(1-this.es);var f=this.a*bd(this.e0,this.e1,this.e2,this.e3,i);e=s*l*(1-h*u*(1/6-(8-u+8*c)*h/120));r=f-this.ml0+s*o/a*h*(.5+(5-u+6*c)*h/24)}t.x=e+this.x0;t.y=r+this.y0;return t}function Ld(t){t.x-=this.x0;t.y-=this.y0;var e=t.x/this.a;var r=t.y/this.a;var n,i;if(this.sphere){var o=r+this.lat0;n=Math.asin(Math.sin(o)*Math.cos(e));i=Math.atan2(Math.tan(e),Math.cos(o))}else{var a=this.ml0/this.a+r;var s=Td(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-mh)<=xh){t.x=this.long0;t.y=mh;if(r<0){t.y*=-1}return t}var u=Cd(this.a,this.e,Math.sin(s));var l=u*u*u/this.a/this.a*(1-this.es);var h=Math.pow(Math.tan(s),2);var c=e*this.a/u;var f=c*c;n=s-u*Math.tan(s)/l*c*c*(.5-(1+3*h)*c*c/24);i=c*(1-f*(h/3+(1+3*h)*h*f/15))/Math.cos(s)}t.x=_c(i+this.long0);t.y=Rd(n);return t}var Ad=["Cassini","Cassini_Soldner","cass"];var jd={init:Id,forward:Pd,inverse:Ld,names:Ad};var Nd=function(t,e){var r;if(t>1e-7){r=t*e;return(1-t*t)*(e/(1-r*r)-.5/t*Math.log((1-r)/(1+r)))}else{return 2*e}};var Fd=1;var Dd=2;var Gd=3;var kd=4;function Ud(){var t=Math.abs(this.lat0);if(Math.abs(t-mh)<xh){this.mode=this.lat0<0?this.S_POLE:this.N_POLE}else if(Math.abs(t)<xh){this.mode=this.EQUIT}else{this.mode=this.OBLIQ}if(this.es>0){var e;this.qp=Nd(this.e,1);this.mmf=.5/(1-this.es);this.apa=Kd(this.es);switch(this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp);e=Math.sin(this.lat0);this.sinb1=Nd(this.e,e)/this.qp;this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1);this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1);this.ymf=(this.xmf=this.rq)/this.dd;this.xmf*=this.dd;break}}else{if(this.mode===this.OBLIQ){this.sinph0=Math.sin(this.lat0);this.cosph0=Math.cos(this.lat0)}}}function Bd(t){var e,r,n,i,o,a,s,u,l,h;var c=t.x;var f=t.y;c=_c(c-this.long0);if(this.sphere){o=Math.sin(f);h=Math.cos(f);n=Math.cos(c);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){r=this.mode===this.EQUIT?1+h*n:1+this.sinph0*o+this.cosph0*h*n;if(r<=xh){return null}r=Math.sqrt(2/r);e=r*h*Math.sin(c);r*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*h*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE){n=-n}if(Math.abs(f+this.lat0)<xh){return null}r=Sh-f*.5;r=2*(this.mode===this.S_POLE?Math.cos(r):Math.sin(r));e=r*Math.sin(c);r*=n}}else{s=0;u=0;l=0;n=Math.cos(c);i=Math.sin(c);o=Math.sin(f);a=Nd(this.e,o);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){s=a/this.qp;u=Math.sqrt(1-s*s)}switch(this.mode){case this.OBLIQ:l=1+this.sinb1*s+this.cosb1*u*n;break;case this.EQUIT:l=1+u*n;break;case this.N_POLE:l=mh+f;a=this.qp-a;break;case this.S_POLE:l=f-mh;a=this.qp+a;break}if(Math.abs(l)<xh){return null}switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l);if(this.mode===this.OBLIQ){r=this.ymf*l*(this.cosb1*s-this.sinb1*u*n)}else{r=(l=Math.sqrt(2/(1+u*n)))*s*this.ymf}e=this.xmf*l*u*i;break;case this.N_POLE:case this.S_POLE:if(a>=0){e=(l=Math.sqrt(a))*i;r=n*(this.mode===this.S_POLE?l:-l)}else{e=r=0}break}}t.x=this.a*e+this.x0;t.y=this.a*r+this.y0;return t}function zd(t){t.x-=this.x0;t.y-=this.y0;var e=t.x/this.a;var r=t.y/this.a;var n,i,o,a,s,u,l;if(this.sphere){var h=0,c,f=0;c=Math.sqrt(e*e+r*r);i=c*.5;if(i>1){return null}i=2*Math.asin(i);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){f=Math.sin(i);h=Math.cos(i)}switch(this.mode){case this.EQUIT:i=Math.abs(c)<=xh?0:Math.asin(r*f/c);e*=f;r=h*c;break;case this.OBLIQ:i=Math.abs(c)<=xh?this.lat0:Math.asin(h*this.sinph0+r*f*this.cosph0/c);e*=f*this.cosph0;r=(h-Math.sin(i)*this.sinph0)*c;break;case this.N_POLE:r=-r;i=mh-i;break;case this.S_POLE:i-=mh;break}n=r===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,r)}else{l=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){e/=this.dd;r*=this.dd;u=Math.sqrt(e*e+r*r);if(u<xh){t.x=this.long0;t.y=this.lat0;return t}a=2*Math.asin(.5*u/this.rq);o=Math.cos(a);e*=a=Math.sin(a);if(this.mode===this.OBLIQ){l=o*this.sinb1+r*a*this.cosb1/u;s=this.qp*l;r=u*this.cosb1*o-r*this.sinb1*a}else{l=r*a/u;s=this.qp*l;r=u*o}}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE){r=-r}s=e*e+r*r;if(!s){t.x=this.long0;t.y=this.lat0;return t}l=1-s/this.qp;if(this.mode===this.S_POLE){l=-l}}n=Math.atan2(e,r);i=Hd(Math.asin(l),this.apa)}t.x=_c(this.long0+n);t.y=i;return t}var Yd=.3333333333333333;var Wd=.17222222222222222;var Vd=.10257936507936508;var Xd=.06388888888888888;var qd=.0664021164021164;var Zd=.016415012942191543;function Kd(t){var e;var r=[];r[0]=t*Yd;e=t*t;r[0]+=e*Wd;r[1]=e*Xd;e*=t;r[0]+=e*Vd;r[1]+=e*qd;r[2]=e*Zd;return r}function Hd(t,e){var r=t+t;return t+e[0]*Math.sin(r)+e[1]*Math.sin(r+r)+e[2]*Math.sin(r+r+r)}var Jd=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];var Qd={init:Ud,forward:Bd,inverse:zd,names:Jd,S_POLE:Fd,N_POLE:Dd,EQUIT:Gd,OBLIQ:kd};var $d=function(t){if(Math.abs(t)>1){t=t>1?1:-1}return Math.asin(t)};function tv(){if(Math.abs(this.lat1+this.lat2)<xh){return}this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e3=Math.sqrt(this.es);this.sin_po=Math.sin(this.lat1);this.cos_po=Math.cos(this.lat1);this.t1=this.sin_po;this.con=this.sin_po;this.ms1=dc(this.e3,this.sin_po,this.cos_po);this.qs1=Nd(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat2);this.cos_po=Math.cos(this.lat2);this.t2=this.sin_po;this.ms2=dc(this.e3,this.sin_po,this.cos_po);this.qs2=Nd(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat0);this.cos_po=Math.cos(this.lat0);this.t3=this.sin_po;this.qs0=Nd(this.e3,this.sin_po,this.cos_po);if(Math.abs(this.lat1-this.lat2)>xh){this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1)}else{this.ns0=this.con}this.c=this.ms1*this.ms1+this.ns0*this.qs1;this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0}function ev(t){var e=t.x;var r=t.y;this.sin_phi=Math.sin(r);this.cos_phi=Math.cos(r);var n=Nd(this.e3,this.sin_phi,this.cos_phi);var i=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0;var o=this.ns0*_c(e-this.long0);var a=i*Math.sin(o)+this.x0;var s=this.rh-i*Math.cos(o)+this.y0;t.x=a;t.y=s;return t}function rv(t){var e,r,n,i,o,a;t.x-=this.x0;t.y=this.rh-t.y+this.y0;if(this.ns0>=0){e=Math.sqrt(t.x*t.x+t.y*t.y);n=1}else{e=-Math.sqrt(t.x*t.x+t.y*t.y);n=-1}i=0;if(e!==0){i=Math.atan2(n*t.x,n*t.y)}n=e*this.ns0/this.a;if(this.sphere){a=Math.asin((this.c-n*n)/(2*this.ns0))}else{r=(this.c-n*n)/this.ns0;a=this.phi1z(this.e3,r)}o=_c(i/this.ns0+this.long0);t.x=o;t.y=a;return t}function nv(t,e){var r,n,i,o,a;var s=$d(.5*e);if(t<xh){return s}var u=t*t;for(var l=1;l<=25;l++){r=Math.sin(s);n=Math.cos(s);i=t*r;o=1-i*i;a=.5*o*o/n*(e/(1-u)-r/o+.5/t*Math.log((1-i)/(1+i)));s=s+a;if(Math.abs(a)<=1e-7){return s}}return null}var iv=["Albers_Conic_Equal_Area","Albers","aea"];var ov={init:tv,forward:ev,inverse:rv,names:iv,phi1z:nv};function av(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1e3*this.a;this.rc=1}function sv(t){var e,r;var n;var i;var o;var a;var s,u;var l=t.x;var h=t.y;n=_c(l-this.long0);e=Math.sin(h);r=Math.cos(h);i=Math.cos(n);a=this.sin_p14*e+this.cos_p14*r*i;o=1;if(a>0||Math.abs(a)<=xh){s=this.x0+this.a*o*r*Math.sin(n)/a;u=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*i)/a}else{s=this.x0+this.infinity_dist*r*Math.sin(n);u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*r*i)}t.x=s;t.y=u;return t}function uv(t){var e;var r,n;var i;var o,a;t.x=(t.x-this.x0)/this.a;t.y=(t.y-this.y0)/this.a;t.x/=this.k0;t.y/=this.k0;if(e=Math.sqrt(t.x*t.x+t.y*t.y)){i=Math.atan2(e,this.rc);r=Math.sin(i);n=Math.cos(i);a=$d(n*this.sin_p14+t.y*r*this.cos_p14/e);o=Math.atan2(t.x*r,e*this.cos_p14*n-t.y*this.sin_p14*r);o=_c(this.long0+o)}else{a=this.phic0;o=0}t.x=o;t.y=a;return t}var lv=["gnom"];var hv={init:av,forward:sv,inverse:uv,names:lv};var cv=function(t,e){var r=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-r)<1e-6){if(e<0){return-1*mh}else{return mh}}var n=Math.asin(.5*e);var i;var o;var a;var s;for(var u=0;u<30;u++){o=Math.sin(n);a=Math.cos(n);s=t*o;i=Math.pow(1-s*s,2)/(2*a)*(e/(1-t*t)-o/(1-s*s)+.5/t*Math.log((1-s)/(1+s)));n+=i;if(Math.abs(i)<=1e-10){return n}}return NaN};function fv(){if(!this.sphere){this.k0=dc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}}function pv(t){var e=t.x;var r=t.y;var n,i;var o=_c(e-this.long0);if(this.sphere){n=this.x0+this.a*o*Math.cos(this.lat_ts);i=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts)}else{var a=Nd(this.e,Math.sin(r));n=this.x0+this.a*this.k0*o;i=this.y0+this.a*a*.5/this.k0}t.x=n;t.y=i;return t}function dv(t){t.x-=this.x0;t.y-=this.y0;var e,r;if(this.sphere){e=_c(this.long0+t.x/this.a/Math.cos(this.lat_ts));r=Math.asin(t.y/this.a*Math.cos(this.lat_ts))}else{r=cv(this.e,2*t.y*this.k0/this.a);e=_c(this.long0+t.x/(this.a*this.k0))}t.x=e;t.y=r;return t}var vv=["cea"];var _v={init:fv,forward:pv,inverse:dv,names:vv};function gv(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)}function yv(t){var e=t.x;var r=t.y;var n=_c(e-this.long0);var i=Rd(r-this.lat0);t.x=this.x0+this.a*n*this.rc;t.y=this.y0+this.a*i;return t}function mv(t){var e=t.x;var r=t.y;t.x=_c(this.long0+(e-this.x0)/(this.a*this.rc));t.y=Rd(this.lat0+(r-this.y0)/this.a);return t}var Ev=["Equirectangular","Equidistant_Cylindrical","eqc"];var Ov={init:gv,forward:yv,inverse:mv,names:Ev};var bv=20;function xv(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=xd(this.es);this.e1=wd(this.es);this.e2=Md(this.es);this.e3=Sd(this.es);this.ml0=this.a*bd(this.e0,this.e1,this.e2,this.e3,this.lat0)}function wv(t){var e=t.x;var r=t.y;var n,i,o;var a=_c(e-this.long0);o=a*Math.sin(r);if(this.sphere){if(Math.abs(r)<=xh){n=this.a*a;i=-1*this.a*this.lat0}else{n=this.a*Math.sin(o)/Math.tan(r);i=this.a*(Rd(r-this.lat0)+(1-Math.cos(o))/Math.tan(r))}}else{if(Math.abs(r)<=xh){n=this.a*a;i=-1*this.ml0}else{var s=Cd(this.a,this.e,Math.sin(r))/Math.tan(r);n=s*Math.sin(o);i=this.a*bd(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+s*(1-Math.cos(o))}}t.x=n+this.x0;t.y=i+this.y0;return t}function Mv(t){var e,r,n,i,o;var a,s;var u,l;n=t.x-this.x0;i=t.y-this.y0;if(this.sphere){if(Math.abs(i+this.a*this.lat0)<=xh){e=_c(n/this.a+this.long0);r=0}else{a=this.lat0+i/this.a;s=n*n/this.a/this.a+a*a;u=a;var h;for(o=bv;o;--o){h=Math.tan(u);l=-1*(a*(u*h+1)-u-.5*(u*u+s)*h)/((u-a)/h-1);u+=l;if(Math.abs(l)<=xh){r=u;break}}e=_c(this.long0+Math.asin(n*Math.tan(u)/this.a)/Math.sin(r))}}else{if(Math.abs(i+this.ml0)<=xh){r=0;e=_c(this.long0+n/this.a)}else{a=(this.ml0+i)/this.a;s=n*n/this.a/this.a+a*a;u=a;var c,f,p,d;var v;for(o=bv;o;--o){v=this.e*Math.sin(u);c=Math.sqrt(1-v*v)*Math.tan(u);f=this.a*bd(this.e0,this.e1,this.e2,this.e3,u);p=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u);d=f/this.a;l=(a*(c*d+1)-d-.5*c*(d*d+s))/(this.es*Math.sin(2*u)*(d*d+s-2*a*d)/(4*c)+(a-d)*(c*p-2/Math.sin(2*u))-p);u-=l;if(Math.abs(l)<=xh){r=u;break}}c=Math.sqrt(1-this.es*Math.pow(Math.sin(r),2))*Math.tan(r);e=_c(this.long0+Math.asin(n*c/this.a)/Math.sin(r))}}t.x=e;t.y=r;return t}var Sv=["Polyconic","poly"];var Cv={init:xv,forward:wv,inverse:Mv,names:Sv};var Rv=1;function Tv(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=67e-5;this.A[10]=-34e-5;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013}function Iv(t){var e;var r=t.x;var n=t.y;var i=n-this.lat0;var o=r-this.long0;var a=i/yh*1e-5;var s=o;var u=1;var l=0;for(e=1;e<=10;e++){u=u*a;l=l+this.A[e]*u}var h=l;var c=s;var f=1;var p=0;var d;var v;var _=0;var g=0;for(e=1;e<=6;e++){d=f*h-p*c;v=p*h+f*c;f=d;p=v;_=_+this.B_re[e]*f-this.B_im[e]*p;g=g+this.B_im[e]*f+this.B_re[e]*p}t.x=g*this.a+this.x0;t.y=_*this.a+this.y0;return t}function Pv(t){var e;var r=t.x;var n=t.y;var i=r-this.x0;var o=n-this.y0;var a=o/this.a;var s=i/this.a;var u=1;var l=0;var h;var c;var f=0;var p=0;for(e=1;e<=6;e++){h=u*a-l*s;c=l*a+u*s;u=h;l=c;f=f+this.C_re[e]*u-this.C_im[e]*l;p=p+this.C_im[e]*u+this.C_re[e]*l}for(var d=0;d<this.iterations;d++){var v=f;var _=p;var g;var y;var m=a;var E=s;for(e=2;e<=6;e++){g=v*f-_*p;y=_*f+v*p;v=g;_=y;m=m+(e-1)*(this.B_re[e]*v-this.B_im[e]*_);E=E+(e-1)*(this.B_im[e]*v+this.B_re[e]*_)}v=1;_=0;var O=this.B_re[1];var b=this.B_im[1];for(e=2;e<=6;e++){g=v*f-_*p;y=_*f+v*p;v=g;_=y;O=O+e*(this.B_re[e]*v-this.B_im[e]*_);b=b+e*(this.B_im[e]*v+this.B_re[e]*_)}var x=O*O+b*b;f=(m*O+E*b)/x;p=(E*O-m*b)/x}var w=f;var M=p;var S=1;var C=0;for(e=1;e<=9;e++){S=S*w;C=C+this.D[e]*S}var R=this.lat0+C*yh*1e5;var T=this.long0+M;t.x=T;t.y=R;return t}var Lv=["New_Zealand_Map_Grid","nzmg"];var Av={init:Tv,forward:Iv,inverse:Pv,names:Lv};function jv(){}function Nv(t){var e=t.x;var r=t.y;var n=_c(e-this.long0);var i=this.x0+this.a*n;var o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+r/2.5))*1.25;t.x=i;t.y=o;return t}function Fv(t){t.x-=this.x0;t.y-=this.y0;var e=_c(this.long0+t.x/this.a);var r=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);t.x=e;t.y=r;return t}var Dv=["Miller_Cylindrical","mill"];var Gv={init:jv,forward:Nv,inverse:Fv,names:Dv};var kv=20;function Uv(){if(!this.sphere){this.en=lp(this.es)}else{this.n=1;this.m=0;this.es=0;this.C_y=Math.sqrt((this.m+1)/this.n);this.C_x=this.C_y/(this.m+1)}}function Bv(t){var e,r;var n=t.x;var i=t.y;n=_c(n-this.long0);if(this.sphere){if(!this.m){i=this.n!==1?Math.asin(this.n*Math.sin(i)):i}else{var o=this.n*Math.sin(i);for(var a=kv;a;--a){var s=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));i-=s;if(Math.abs(s)<xh){break}}}e=this.a*this.C_x*n*(this.m+Math.cos(i));r=this.a*this.C_y*i}else{var u=Math.sin(i);var l=Math.cos(i);r=this.a*hp(i,u,l,this.en);e=this.a*n*l/Math.sqrt(1-this.es*u*u)}t.x=e;t.y=r;return t}function zv(t){var e,r,n,i;t.x-=this.x0;n=t.x/this.a;t.y-=this.y0;e=t.y/this.a;if(this.sphere){e/=this.C_y;n=n/(this.C_x*(this.m+Math.cos(e)));if(this.m){e=$d((this.m*e+Math.sin(e))/this.n)}else if(this.n!==1){e=$d(Math.sin(e)/this.n)}n=_c(n+this.long0);e=Rd(e)}else{e=fp(t.y/this.a,this.es,this.en);i=Math.abs(e);if(i<mh){i=Math.sin(e);r=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e));n=_c(r)}else if(i-xh<mh){n=this.long0}}t.x=n;t.y=e;return t}var Yv=["Sinusoidal","sinu"];var Wv={init:Uv,forward:Bv,inverse:zv,names:Yv};function Vv(){}function Xv(t){var e=t.x;var r=t.y;var n=_c(e-this.long0);var i=r;var o=Math.PI*Math.sin(r);while(true){var a=-(i+Math.sin(i)-o)/(1+Math.cos(i));i+=a;if(Math.abs(a)<xh){break}}i/=2;if(Math.PI/2-Math.abs(r)<xh){n=0}var s=.900316316158*this.a*n*Math.cos(i)+this.x0;var u=1.4142135623731*this.a*Math.sin(i)+this.y0;t.x=s;t.y=u;return t}function qv(t){var e;var r;t.x-=this.x0;t.y-=this.y0;r=t.y/(1.4142135623731*this.a);if(Math.abs(r)>.999999999999){r=.999999999999}e=Math.asin(r);var n=_c(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));if(n<-Math.PI){n=-Math.PI}if(n>Math.PI){n=Math.PI}r=(2*e+Math.sin(2*e))/Math.PI;if(Math.abs(r)>1){r=1}var i=Math.asin(r);t.x=n;t.y=i;return t}var Zv=["Mollweide","moll"];var Kv={init:Vv,forward:Xv,inverse:qv,names:Zv};function Hv(){if(Math.abs(this.lat1+this.lat2)<xh){return}this.lat2=this.lat2||this.lat1;this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=xd(this.es);this.e1=wd(this.es);this.e2=Md(this.es);this.e3=Sd(this.es);this.sinphi=Math.sin(this.lat1);this.cosphi=Math.cos(this.lat1);this.ms1=dc(this.e,this.sinphi,this.cosphi);this.ml1=bd(this.e0,this.e1,this.e2,this.e3,this.lat1);if(Math.abs(this.lat1-this.lat2)<xh){this.ns=this.sinphi}else{this.sinphi=Math.sin(this.lat2);this.cosphi=Math.cos(this.lat2);this.ms2=dc(this.e,this.sinphi,this.cosphi);this.ml2=bd(this.e0,this.e1,this.e2,this.e3,this.lat2);this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)}this.g=this.ml1+this.ms1/this.ns;this.ml0=bd(this.e0,this.e1,this.e2,this.e3,this.lat0);this.rh=this.a*(this.g-this.ml0)}function Jv(t){var e=t.x;var r=t.y;var n;if(this.sphere){n=this.a*(this.g-r)}else{var i=bd(this.e0,this.e1,this.e2,this.e3,r);n=this.a*(this.g-i)}var o=this.ns*_c(e-this.long0);var a=this.x0+n*Math.sin(o);var s=this.y0+this.rh-n*Math.cos(o);t.x=a;t.y=s;return t}function Qv(t){t.x-=this.x0;t.y=this.rh-t.y+this.y0;var e,r,n,i;if(this.ns>=0){r=Math.sqrt(t.x*t.x+t.y*t.y);e=1}else{r=-Math.sqrt(t.x*t.x+t.y*t.y);e=-1}var o=0;if(r!==0){o=Math.atan2(e*t.x,e*t.y)}if(this.sphere){i=_c(this.long0+o/this.ns);n=Rd(this.g-r/this.a);t.x=i;t.y=n;return t}else{var a=this.g-r/this.a;n=Td(a,this.e0,this.e1,this.e2,this.e3);i=_c(this.long0+o/this.ns);t.x=i;t.y=n;return t}}var $v=["Equidistant_Conic","eqdc"];var t_={init:Hv,forward:Jv,inverse:Qv,names:$v};function e_(){this.R=this.a}function r_(t){var e=t.x;var r=t.y;var n=_c(e-this.long0);var i,o;if(Math.abs(r)<=xh){i=this.x0+this.R*n;o=this.y0}var a=$d(2*Math.abs(r/Math.PI));if(Math.abs(n)<=xh||Math.abs(Math.abs(r)-mh)<=xh){i=this.x0;if(r>=0){o=this.y0+Math.PI*this.R*Math.tan(.5*a)}else{o=this.y0+Math.PI*this.R*-Math.tan(.5*a)}}var s=.5*Math.abs(Math.PI/n-n/Math.PI);var u=s*s;var l=Math.sin(a);var h=Math.cos(a);var c=h/(l+h-1);var f=c*c;var p=c*(2/l-1);var d=p*p;var v=Math.PI*this.R*(s*(c-d)+Math.sqrt(u*(c-d)*(c-d)-(d+u)*(f-d)))/(d+u);if(n<0){v=-v}i=this.x0+v;var _=u+c;v=Math.PI*this.R*(p*_-s*Math.sqrt((d+u)*(u+1)-_*_))/(d+u);if(r>=0){o=this.y0+v}else{o=this.y0-v}t.x=i;t.y=o;return t}function n_(t){var e,r;var n,i,o,a,s,u;var l;var h;var c;var f;var p;t.x-=this.x0;t.y-=this.y0;c=Math.PI*this.R;n=t.x/c;i=t.y/c;o=n*n+i*i;a=-Math.abs(i)*(1+o);s=a-2*i*i+n*n;u=-2*a+1+2*i*i+o*o;p=i*i/u+(2*s*s*s/u/u/u-9*a*s/u/u)/27;l=(a-s*s/3/u)/u;h=2*Math.sqrt(-l/3);c=3*p/l/h;if(Math.abs(c)>1){if(c>=0){c=1}else{c=-1}}f=Math.acos(c)/3;if(t.y>=0){r=(-h*Math.cos(f+Math.PI/3)-s/3/u)*Math.PI}else{r=-(-h*Math.cos(f+Math.PI/3)-s/3/u)*Math.PI}if(Math.abs(n)<xh){e=this.long0}else{e=_c(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-i*i)+o*o))/2/n)}t.x=e;t.y=r;return t}var i_=["Van_der_Grinten_I","VanDerGrinten","vandg"];var o_={init:e_,forward:r_,inverse:n_,names:i_};function a_(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)}function s_(t){var e=t.x;var r=t.y;var n=Math.sin(t.y);var i=Math.cos(t.y);var o=_c(e-this.long0);var a,s,u,l,h,c,f,p,d,v,_,g,y,m,E,O,b,x,w,M,S,C,R;if(this.sphere){if(Math.abs(this.sin_p12-1)<=xh){t.x=this.x0+this.a*(mh-r)*Math.sin(o);t.y=this.y0-this.a*(mh-r)*Math.cos(o);return t}else if(Math.abs(this.sin_p12+1)<=xh){t.x=this.x0+this.a*(mh+r)*Math.sin(o);t.y=this.y0+this.a*(mh+r)*Math.cos(o);return t}else{x=this.sin_p12*n+this.cos_p12*i*Math.cos(o);O=Math.acos(x);b=O?O/Math.sin(O):1;t.x=this.x0+this.a*b*i*Math.sin(o);t.y=this.y0+this.a*b*(this.cos_p12*n-this.sin_p12*i*Math.cos(o));return t}}else{a=xd(this.es);s=wd(this.es);u=Md(this.es);l=Sd(this.es);if(Math.abs(this.sin_p12-1)<=xh){h=this.a*bd(a,s,u,l,mh);c=this.a*bd(a,s,u,l,r);t.x=this.x0+(h-c)*Math.sin(o);t.y=this.y0-(h-c)*Math.cos(o);return t}else if(Math.abs(this.sin_p12+1)<=xh){h=this.a*bd(a,s,u,l,mh);c=this.a*bd(a,s,u,l,r);t.x=this.x0+(h+c)*Math.sin(o);t.y=this.y0+(h+c)*Math.cos(o);return t}else{f=n/i;p=Cd(this.a,this.e,this.sin_p12);d=Cd(this.a,this.e,n);v=Math.atan((1-this.es)*f+this.es*p*this.sin_p12/(d*i));_=Math.atan2(Math.sin(o),this.cos_p12*Math.tan(v)-this.sin_p12*Math.cos(o));if(_===0){w=Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v))}else if(Math.abs(Math.abs(_)-Math.PI)<=xh){w=-Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v))}else{w=Math.asin(Math.sin(o)*Math.cos(v)/Math.sin(_))}g=this.e*this.sin_p12/Math.sqrt(1-this.es);y=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es);m=g*y;E=y*y;M=w*w;S=M*w;C=S*w;R=C*w;O=p*w*(1-M*E*(1-E)/6+S/8*m*(1-2*E)+C/120*(E*(4-7*E)-3*g*g*(1-7*E))-R/48*m);t.x=this.x0+O*Math.sin(_);t.y=this.y0+O*Math.cos(_);return t}}}function u_(t){t.x-=this.x0;t.y-=this.y0;var e,r,n,i,o,a,s,u,l,h,c,f,p,d,v,_,g,y,m,E,O,b,x,w;if(this.sphere){e=Math.sqrt(t.x*t.x+t.y*t.y);if(e>2*mh*this.a){return}r=e/this.a;n=Math.sin(r);i=Math.cos(r);o=this.long0;if(Math.abs(e)<=xh){a=this.lat0}else{a=$d(i*this.sin_p12+t.y*n*this.cos_p12/e);s=Math.abs(this.lat0)-mh;if(Math.abs(s)<=xh){if(this.lat0>=0){o=_c(this.long0+Math.atan2(t.x,-t.y))}else{o=_c(this.long0-Math.atan2(-t.x,t.y))}}else{o=_c(this.long0+Math.atan2(t.x*n,e*this.cos_p12*i-t.y*this.sin_p12*n))}}t.x=o;t.y=a;return t}else{u=xd(this.es);l=wd(this.es);h=Md(this.es);c=Sd(this.es);if(Math.abs(this.sin_p12-1)<=xh){f=this.a*bd(u,l,h,c,mh);e=Math.sqrt(t.x*t.x+t.y*t.y);p=f-e;a=Td(p/this.a,u,l,h,c);o=_c(this.long0+Math.atan2(t.x,-1*t.y));t.x=o;t.y=a;return t}else if(Math.abs(this.sin_p12+1)<=xh){f=this.a*bd(u,l,h,c,mh);e=Math.sqrt(t.x*t.x+t.y*t.y);p=e-f;a=Td(p/this.a,u,l,h,c);o=_c(this.long0+Math.atan2(t.x,t.y));t.x=o;t.y=a;return t}else{e=Math.sqrt(t.x*t.x+t.y*t.y);_=Math.atan2(t.x,t.y);d=Cd(this.a,this.e,this.sin_p12);g=Math.cos(_);y=this.e*this.cos_p12*g;m=-y*y/(1-this.es);E=3*this.es*(1-m)*this.sin_p12*this.cos_p12*g/(1-this.es);O=e/d;b=O-m*(1+m)*Math.pow(O,3)/6-E*(1+3*m)*Math.pow(O,4)/24;x=1-m*b*b/2-O*b*b*b/6;v=Math.asin(this.sin_p12*Math.cos(b)+this.cos_p12*Math.sin(b)*g);o=_c(this.long0+Math.asin(Math.sin(_)*Math.sin(b)/Math.cos(v)));w=Math.sin(v);a=Math.atan2((w-this.es*x*this.sin_p12)*Math.tan(v),w*(1-this.es));t.x=o;t.y=a;return t}}}var l_=["Azimuthal_Equidistant","aeqd"];var h_={init:a_,forward:s_,inverse:u_,names:l_};function c_(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)}function f_(t){var e,r;var n;var i;var o;var a,s,u;var l=t.x;var h=t.y;n=_c(l-this.long0);e=Math.sin(h);r=Math.cos(h);i=Math.cos(n);a=this.sin_p14*e+this.cos_p14*r*i;o=1;if(a>0||Math.abs(a)<=xh){s=this.a*o*r*Math.sin(n);u=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*r*i)}t.x=s;t.y=u;return t}function p_(t){var e;var r;var n,i;var o;var a,s;t.x-=this.x0;t.y-=this.y0;e=Math.sqrt(t.x*t.x+t.y*t.y);r=$d(e/this.a);n=Math.sin(r);i=Math.cos(r);a=this.long0;if(Math.abs(e)<=xh){s=this.lat0;t.x=a;t.y=s;return t}s=$d(i*this.sin_p14+t.y*n*this.cos_p14/e);o=Math.abs(this.lat0)-mh;if(Math.abs(o)<=xh){if(this.lat0>=0){a=_c(this.long0+Math.atan2(t.x,-t.y))}else{a=_c(this.long0-Math.atan2(-t.x,t.y))}t.x=a;t.y=s;return t}a=_c(this.long0+Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n));t.x=a;t.y=s;return t}var d_=["ortho"];var v_={init:c_,forward:f_,inverse:p_,names:d_};var __={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6};var g_={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function y_(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Quadrilateralized Spherical Cube";if(this.lat0>=mh-Sh/2){this.face=__.TOP}else if(this.lat0<=-(mh-Sh/2)){this.face=__.BOTTOM}else if(Math.abs(this.long0)<=Sh){this.face=__.FRONT}else if(Math.abs(this.long0)<=mh+Sh){this.face=this.long0>0?__.RIGHT:__.LEFT}else{this.face=__.BACK}if(this.es!==0){this.one_minus_f=1-(this.a-this.b)/this.a;this.one_minus_f_squared=this.one_minus_f*this.one_minus_f}}function m_(t){var e={x:0,y:0};var r,n;var i,o;var a,s;var u={value:0};t.x-=this.long0;if(this.es!==0){r=Math.atan(this.one_minus_f_squared*Math.tan(t.y))}else{r=t.y}n=t.x;if(this.face===__.TOP){o=mh-r;if(n>=Sh&&n<=mh+Sh){u.value=g_.AREA_0;i=n-mh}else if(n>mh+Sh||n<=-(mh+Sh)){u.value=g_.AREA_1;i=n>0?n-Rh:n+Rh}else if(n>-(mh+Sh)&&n<=-Sh){u.value=g_.AREA_2;i=n+mh}else{u.value=g_.AREA_3;i=n}}else if(this.face===__.BOTTOM){o=mh+r;if(n>=Sh&&n<=mh+Sh){u.value=g_.AREA_0;i=-n+mh}else if(n<Sh&&n>=-Sh){u.value=g_.AREA_1;i=-n}else if(n<-Sh&&n>=-(mh+Sh)){u.value=g_.AREA_2;i=-n-mh}else{u.value=g_.AREA_3;i=n>0?-n+Rh:-n-Rh}}else{var l,h,c;var f,p;var d,v;if(this.face===__.RIGHT){n=b_(n,+mh)}else if(this.face===__.BACK){n=b_(n,+Rh)}else if(this.face===__.LEFT){n=b_(n,-mh)}f=Math.sin(r);p=Math.cos(r);d=Math.sin(n);v=Math.cos(n);l=p*v;h=p*d;c=f;if(this.face===__.FRONT){o=Math.acos(l);i=O_(o,c,h,u)}else if(this.face===__.RIGHT){o=Math.acos(h);i=O_(o,c,-l,u)}else if(this.face===__.BACK){o=Math.acos(-l);i=O_(o,c,-h,u)}else if(this.face===__.LEFT){o=Math.acos(-h);i=O_(o,c,l,u)}else{o=i=0;u.value=g_.AREA_0}}s=Math.atan(12/Rh*(i+Math.acos(Math.sin(i)*Math.cos(Sh))-mh));a=Math.sqrt((1-Math.cos(o))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(i)))));if(u.value===g_.AREA_1){s+=mh}else if(u.value===g_.AREA_2){s+=Rh}else if(u.value===g_.AREA_3){s+=1.5*Rh}e.x=a*Math.cos(s);e.y=a*Math.sin(s);e.x=e.x*this.a+this.x0;e.y=e.y*this.a+this.y0;t.x=e.x;t.y=e.y;return t}function E_(t){var e={lam:0,phi:0};var r,n,i,o;var a,s,u,l;var h;var c={value:0};t.x=(t.x-this.x0)/this.a;t.y=(t.y-this.y0)/this.a;n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y));r=Math.atan2(t.y,t.x);if(t.x>=0&&t.x>=Math.abs(t.y)){c.value=g_.AREA_0}else if(t.y>=0&&t.y>=Math.abs(t.x)){c.value=g_.AREA_1;r-=mh}else if(t.x<0&&-t.x>=Math.abs(t.y)){c.value=g_.AREA_2;r=r<0?r+Rh:r-Rh}else{c.value=g_.AREA_3;r+=mh}h=Rh/12*Math.tan(r);a=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2));s=Math.atan(a);i=Math.cos(r);o=Math.tan(n);u=1-i*i*o*o*(1-Math.cos(Math.atan(1/Math.cos(s))));if(u<-1){u=-1}else if(u>+1){u=+1}if(this.face===__.TOP){l=Math.acos(u);e.phi=mh-l;if(c.value===g_.AREA_0){e.lam=s+mh}else if(c.value===g_.AREA_1){e.lam=s<0?s+Rh:s-Rh}else if(c.value===g_.AREA_2){e.lam=s-mh}else{e.lam=s}}else if(this.face===__.BOTTOM){l=Math.acos(u);e.phi=l-mh;if(c.value===g_.AREA_0){e.lam=-s+mh}else if(c.value===g_.AREA_1){e.lam=-s}else if(c.value===g_.AREA_2){e.lam=-s-mh}else{e.lam=s<0?-s-Rh:-s+Rh}}else{var f,p,d;f=u;h=f*f;if(h>=1){d=0}else{d=Math.sqrt(1-h)*Math.sin(s)}h+=d*d;if(h>=1){p=0}else{p=Math.sqrt(1-h)}if(c.value===g_.AREA_1){h=p;p=-d;d=h}else if(c.value===g_.AREA_2){p=-p;d=-d}else if(c.value===g_.AREA_3){h=p;p=d;d=-h}if(this.face===__.RIGHT){h=f;f=-p;p=h}else if(this.face===__.BACK){f=-f;p=-p}else if(this.face===__.LEFT){h=f;f=p;p=-h}e.phi=Math.acos(-d)-mh;e.lam=Math.atan2(p,f);if(this.face===__.RIGHT){e.lam=b_(e.lam,-mh)}else if(this.face===__.BACK){e.lam=b_(e.lam,-Rh)}else if(this.face===__.LEFT){e.lam=b_(e.lam,+mh)}}if(this.es!==0){var v;var _,g;v=e.phi<0?1:0;_=Math.tan(e.phi);g=this.b/Math.sqrt(_*_+this.one_minus_f_squared);e.phi=Math.atan(Math.sqrt(this.a*this.a-g*g)/(this.one_minus_f*g));if(v){e.phi=-e.phi}}e.lam+=this.long0;t.x=e.lam;t.y=e.phi;return t}function O_(t,e,r,n){var i;if(t<xh){n.value=g_.AREA_0;i=0}else{i=Math.atan2(e,r);if(Math.abs(i)<=Sh){n.value=g_.AREA_0}else if(i>Sh&&i<=mh+Sh){n.value=g_.AREA_1;i-=mh}else if(i>mh+Sh||i<=-(mh+Sh)){n.value=g_.AREA_2;i=i>=0?i-Rh:i+Rh}else{n.value=g_.AREA_3;i+=mh}}return i}function b_(t,e){var r=t+e;if(r<-Rh){r+=Ch}else if(r>+Rh){r-=Ch}return r}var x_=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];var w_={init:y_,forward:m_,inverse:E_,names:x_};var M_=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]];var S_=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]];var C_=.8487;var R_=1.3523;var T_=Mh/5;var I_=1/T_;var P_=18;var L_=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var A_=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function j_(t,e,r,n){var i=e;for(;n;--n){var o=t(i);i-=o;if(Math.abs(o)<r){break}}return i}function N_(){this.x0=this.x0||0;this.y0=this.y0||0;this.long0=this.long0||0;this.es=0;this.title=this.title||"Robinson"}function F_(t){var e=_c(t.x-this.long0);var r=Math.abs(t.y);var n=Math.floor(r*T_);if(n<0){n=0}else if(n>=P_){n=P_-1}r=Mh*(r-I_*n);var i={x:L_(M_[n],r)*e,y:L_(S_[n],r)};if(t.y<0){i.y=-i.y}i.x=i.x*this.a*C_+this.x0;i.y=i.y*this.a*R_+this.y0;return i}function D_(t){var e={x:(t.x-this.x0)/(this.a*C_),y:Math.abs(t.y-this.y0)/(this.a*R_)};if(e.y>=1){e.x/=M_[P_][0];e.y=t.y<0?-mh:mh}else{var r=Math.floor(e.y*P_);if(r<0){r=0}else if(r>=P_){r=P_-1}for(;;){if(S_[r][0]>e.y){--r}else if(S_[r+1][0]<=e.y){++r}else{break}}var n=S_[r];var i=5*(e.y-n[0])/(S_[r+1][0]-n[0]);i=j_((function(t){return(L_(n,t)-e.y)/A_(n,t)}),i,xh,100);e.x/=L_(M_[r],i);e.y=(5*r+i)*wh;if(t.y<0){e.y=-e.y}}e.x=_c(e.x+this.long0);return e}var G_=["Robinson","robin"];var k_={init:N_,forward:F_,inverse:D_,names:G_};function U_(){this.name="geocent"}function B_(t){var e=nf(t,this.es,this.a);return e}function z_(t){var e=of(t,this.es,this.a,this.b);return e}var Y_=["Geocentric","geocentric","geocent","Geocent"];var W_={init:U_,forward:B_,inverse:z_,names:Y_};var V_={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3};var X_={h:{def:1e5,num:true},azi:{def:0,num:true,degrees:true},tilt:{def:0,num:true,degrees:true},long0:{def:0,num:true},lat0:{def:0,num:true}};function q_(){Object.keys(X_).forEach(function(t){if(typeof this[t]==="undefined"){this[t]=X_[t].def}else if(X_[t].num&&isNaN(this[t])){throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t])}else if(X_[t].num){this[t]=parseFloat(this[t])}if(X_[t].degrees){this[t]=this[t]*wh}}.bind(this));if(Math.abs(Math.abs(this.lat0)-mh)<xh){this.mode=this.lat0<0?V_.S_POLE:V_.N_POLE}else if(Math.abs(this.lat0)<xh){this.mode=V_.EQUIT}else{this.mode=V_.OBLIQ;this.sinph0=Math.sin(this.lat0);this.cosph0=Math.cos(this.lat0)}this.pn1=this.h/this.a;if(this.pn1<=0||this.pn1>1e10){throw new Error("Invalid height")}this.p=1+this.pn1;this.rp=1/this.p;this.h1=1/this.pn1;this.pfact=(this.p+1)*this.h1;this.es=0;var t=this.tilt;var e=this.azi;this.cg=Math.cos(e);this.sg=Math.sin(e);this.cw=Math.cos(t);this.sw=Math.sin(t)}function Z_(t){t.x-=this.long0;var e=Math.sin(t.y);var r=Math.cos(t.y);var n=Math.cos(t.x);var i,o;switch(this.mode){case V_.OBLIQ:o=this.sinph0*e+this.cosph0*r*n;break;case V_.EQUIT:o=r*n;break;case V_.S_POLE:o=-e;break;case V_.N_POLE:o=e;break}o=this.pn1/(this.p-o);i=o*r*Math.sin(t.x);switch(this.mode){case V_.OBLIQ:o*=this.cosph0*e-this.sinph0*r*n;break;case V_.EQUIT:o*=e;break;case V_.N_POLE:o*=-(r*n);break;case V_.S_POLE:o*=r*n;break}var a,s;a=o*this.cg+i*this.sg;s=1/(a*this.sw*this.h1+this.cw);i=(i*this.cg-o*this.sg)*this.cw*s;o=a*s;t.x=i*this.a;t.y=o*this.a;return t}function K_(t){t.x/=this.a;t.y/=this.a;var e={x:t.x,y:t.y};var r,n,i;i=1/(this.pn1-t.y*this.sw);r=this.pn1*t.x*i;n=this.pn1*t.y*this.cw*i;t.x=r*this.cg+n*this.sg;t.y=n*this.cg-r*this.sg;var o=mp(t.x,t.y);if(Math.abs(o)<xh){e.x=0;e.y=t.y}else{var a,s;s=1-o*o*this.pfact;s=(this.p-Math.sqrt(s))/(this.pn1/o+o/this.pn1);a=Math.sqrt(1-s*s);switch(this.mode){case V_.OBLIQ:e.y=Math.asin(a*this.sinph0+t.y*s*this.cosph0/o);t.y=(a-this.sinph0*Math.sin(e.y))*o;t.x*=s*this.cosph0;break;case V_.EQUIT:e.y=Math.asin(t.y*s/o);t.y=a*o;t.x*=s;break;case V_.N_POLE:e.y=Math.asin(a);t.y=-t.y;break;case V_.S_POLE:e.y=-Math.asin(a);break}e.x=Math.atan2(t.x,t.y)}t.x=e.x+this.long0;t.y=e.y;return t}var H_=["Tilted_Perspective","tpers"];var J_={init:q_,forward:Z_,inverse:K_,names:H_};var Q_=function(t){t.Proj.projections.add(gp);t.Proj.projections.add(Ip);t.Proj.projections.add(Np);t.Proj.projections.add(qp);t.Proj.projections.add($p);t.Proj.projections.add(id);t.Proj.projections.add(cd);t.Proj.projections.add(_d);t.Proj.projections.add(Od);t.Proj.projections.add(jd);t.Proj.projections.add(Qd);t.Proj.projections.add(ov);t.Proj.projections.add(hv);t.Proj.projections.add(_v);t.Proj.projections.add(Ov);t.Proj.projections.add(Cv);t.Proj.projections.add(Av);t.Proj.projections.add(Gv);t.Proj.projections.add(Wv);t.Proj.projections.add(Kv);t.Proj.projections.add(t_);t.Proj.projections.add(o_);t.Proj.projections.add(h_);t.Proj.projections.add(v_);t.Proj.projections.add(w_);t.Proj.projections.add(k_);t.Proj.projections.add(W_);t.Proj.projections.add(J_)};xf.defaultDatum="WGS84";xf.Proj=ef;xf.WGS84=new xf.Proj("WGS84");xf.Point=Hf;xf.toPoint=df;xf.defs=rc;xf.nadgrid=Yc;xf.transform=yf;xf.mgrs=Lf;xf.version="__VERSION__";Q_(xf);var $_=xf;function tg(t,e,r){$_.defs(t,e.trim());uh($_);const n=jr(t);n.setExtent(r);return n}var eg=r(29);var rg=r.n(eg);var ng="http://www.w3.org/2001/XMLSchema-instance";function ig(t,e){return Ig().createElementNS(t,e)}function og(t,e){return ag(t,e,[]).join("")}function ag(t,e,r){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE){if(e){r.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,""))}else{r.push(t.nodeValue)}}else{var n=void 0;for(n=t.firstChild;n;n=n.nextSibling){ag(n,e,r)}}return r}function sg(t){return"documentElement"in t}function ug(t,e,r){return t.getAttributeNS(e,r)||""}function lg(t){return(new DOMParser).parseFromString(t,"application/xml")}function hg(t,e){return function(r,n){var i=t.call(e!==undefined?e:this,r,n);if(i!==undefined){var o=n[n.length-1];Object(fn["c"])(o,i)}}}function cg(t,e){return function(r,n){var i=t.call(e!==undefined?e:this,r,n);if(i!==undefined){var o=n[n.length-1];o.push(i)}}}function fg(t,e){return function(r,n){var i=t.call(e!==undefined?e:this,r,n);if(i!==undefined){n[n.length-1]=i}}}function pg(t,e,r){return function(n,i){var o=t.call(r!==undefined?r:this,n,i);if(o!==undefined){var a=i[i.length-1];var s=e!==undefined?e:n.localName;var u=void 0;if(s in a){u=a[s]}else{u=[];a[s]=u}u.push(o)}}}function dg(t,e,r){return function(n,i){var o=t.call(r!==undefined?r:this,n,i);if(o!==undefined){var a=i[i.length-1];var s=e!==undefined?e:n.localName;a[s]=o}}}function vg(t,e){return function(r,n,i){t.call(e!==undefined?e:this,r,n,i);var o=i[i.length-1];var a=o.node;a.appendChild(r)}}function _g(t,e){var r,n;return function(e,i,o){if(r===undefined){r={};var a={};a[e.localName]=t;r[e.namespaceURI]=a;n=gg(e.localName)}xg(r,n,i,o)}}function gg(t,e){var r=t;return function(t,n,i){var o=n[n.length-1];var a=o.node;var s=r;if(s===undefined){s=i}var u=e!==undefined?e:a.namespaceURI;return ig(u,s)}}var yg=gg();function mg(t,e){var r=e.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=t[e[i]]}return n}function Eg(t,e,r){var n=r!==undefined?r:{};var i,o;for(i=0,o=t.length;i<o;++i){n[t[i]]=e}return n}function Og(t,e,r,n){var i;for(i=e.firstElementChild;i;i=i.nextElementSibling){var o=t[i.namespaceURI];if(o!==undefined){var a=o[i.localName];if(a!==undefined){a.call(n,i,r)}}}}function bg(t,e,r,n,i){n.push(t);Og(e,r,n,i);return n.pop()}function xg(t,e,r,n,i,o){var a=(i!==undefined?i:r).length;var s,u;for(var l=0;l<a;++l){s=r[l];if(s!==undefined){u=e.call(o!==undefined?o:this,s,n,i!==undefined?i[l]:undefined);if(u!==undefined){t[u.namespaceURI][u.localName].call(o,u,s,n)}}}}function wg(t,e,r,n,i,o,a){i.push(t);xg(e,r,n,i,o,a);return i.pop()}var Mg=undefined;function Sg(t){Mg=t}function Cg(){if(Mg===undefined&&typeof XMLSerializer!=="undefined"){Mg=new XMLSerializer}return Mg}var Rg=undefined;function Tg(t){Rg=t}function Ig(){if(Rg===undefined&&typeof document!=="undefined"){Rg=document.implementation.createDocument("","",null)}return Rg}var Pg=function(){function t(){}t.prototype.read=function(t){if(!t){return null}else if(typeof t==="string"){var e=lg(t);return this.readFromDocument(e)}else if(sg(t)){return this.readFromDocument(t)}else{return this.readFromNode(t)}};t.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling){if(e.nodeType==Node.ELEMENT_NODE){return this.readFromNode(e)}}return null};t.prototype.readFromNode=function(t){};return t}();var Lg=Pg;var Ag="http://www.w3.org/1999/xlink";function jg(t){return t.getAttributeNS(Ag,"href")}function Ng(t){var e=og(t,false);return Fg(e)}function Fg(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e){return e[1]!==undefined||false}else{return undefined}}function Dg(t){var e=og(t,false);var r=Date.parse(e);return isNaN(r)?undefined:r/1e3}function Gg(t){var e=og(t,false);return kg(e)}function kg(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e){return parseFloat(e[1])}else{return undefined}}function Ug(t){var e=og(t,false);return Bg(e)}function Bg(t){var e=/^\s*(\d+)\s*$/.exec(t);if(e){return parseInt(e[1],10)}else{return undefined}}function zg(t){return og(t,false).trim()}function Yg(t,e){Zg(t,e?"1":"0")}function Wg(t,e){t.appendChild(Ig().createCDATASection(e))}function Vg(t,e){var r=new Date(e*1e3);var n=r.getUTCFullYear()+"-"+et(r.getUTCMonth()+1,2)+"-"+et(r.getUTCDate(),2)+"T"+et(r.getUTCHours(),2)+":"+et(r.getUTCMinutes(),2)+":"+et(r.getUTCSeconds(),2)+"Z";t.appendChild(Ig().createTextNode(n))}function Xg(t,e){var r=e.toPrecision();t.appendChild(Ig().createTextNode(r))}function qg(t,e){var r=e.toString();t.appendChild(Ig().createTextNode(r))}function Zg(t,e){t.appendChild(Ig().createTextNode(e))}var Kg=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Hg=[null,"http://www.opengis.net/ows/1.1"];var Jg=Eg(Hg,{ServiceIdentification:dg(by),ServiceProvider:dg(wy),OperationsMetadata:dg(Ey)});var Qg=function(t){Kg(e,t);function e(){return t.call(this)||this}e.prototype.readFromNode=function(t){var e=bg({},Jg,t,[]);return e?e:null};return e}(Lg);var $g=Eg(Hg,{DeliveryPoint:dg(zg),City:dg(zg),AdministrativeArea:dg(zg),PostalCode:dg(zg),Country:dg(zg),ElectronicMailAddress:dg(zg)});var ty=Eg(Hg,{Value:pg(My)});var ey=Eg(Hg,{AllowedValues:dg(py)});var ry=Eg(Hg,{Phone:dg(Oy),Address:dg(fy)});var ny=Eg(Hg,{HTTP:dg(yy)});var iy=Eg(Hg,{Get:pg(gy),Post:undefined});var oy=Eg(Hg,{DCP:dg(_y)});var ay=Eg(Hg,{Operation:my});var sy=Eg(Hg,{Voice:dg(zg),Facsimile:dg(zg)});var uy=Eg(Hg,{Constraint:pg(dy)});var ly=Eg(Hg,{IndividualName:dg(zg),PositionName:dg(zg),ContactInfo:dg(vy)});var hy=Eg(Hg,{Abstract:dg(zg),AccessConstraints:dg(zg),Fees:dg(zg),Title:dg(zg),ServiceTypeVersion:dg(zg),ServiceType:dg(zg)});var cy=Eg(Hg,{ProviderName:dg(zg),ProviderSite:dg(jg),ServiceContact:dg(xy)});function fy(t,e){return bg({},$g,t,e)}function py(t,e){return bg({},ty,t,e)}function dy(t,e){var r=t.getAttribute("name");if(!r){return undefined}return bg({name:r},ey,t,e)}function vy(t,e){return bg({},ry,t,e)}function _y(t,e){return bg({},ny,t,e)}function gy(t,e){var r=jg(t);if(!r){return undefined}return bg({href:r},uy,t,e)}function yy(t,e){return bg({},iy,t,e)}function my(t,e){var r=t.getAttribute("name");var n=bg({},oy,t,e);if(!n){return undefined}var i=e[e.length-1];i[r]=n}function Ey(t,e){return bg({},ay,t,e)}function Oy(t,e){return bg({},sy,t,e)}function by(t,e){return bg({},hy,t,e)}function xy(t,e){return bg({},ly,t,e)}function wy(t,e){return bg({},cy,t,e)}function My(t,e){return zg(t)}var Sy=Qg;var Cy=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ry=[null,"http://www.opengis.net/wmts/1.0"];var Ty=[null,"http://www.opengis.net/ows/1.1"];var Iy=Eg(Ry,{Contents:dg(zy)});var Py=function(t){Cy(e,t);function e(){var e=t.call(this)||this;e.owsParser_=new Sy;return e}e.prototype.readFromNode=function(t){var e=t.getAttribute("version");if(e){e=e.trim()}var r=this.owsParser_.readFromNode(t);if(!r){return null}r["version"]=e;r=bg(r,Iy,t,[]);return r?r:null};return e}(Lg);var Ly=Eg(Ry,{Layer:pg(Yy),TileMatrixSet:pg(Wy)});var Ay=Eg(Ry,{Style:pg(Vy),Format:pg(zg),TileMatrixSetLink:pg(Xy),Dimension:pg(qy),ResourceURL:pg(Zy)},Eg(Ty,{Title:dg(zg),Abstract:dg(zg),WGS84BoundingBox:dg(Ky),Identifier:dg(zg)}));var jy=Eg(Ry,{LegendURL:pg(Hy)},Eg(Ty,{Title:dg(zg),Identifier:dg(zg)}));var Ny=Eg(Ry,{TileMatrixSet:dg(zg),TileMatrixSetLimits:dg($y)});var Fy=Eg(Ry,{TileMatrixLimits:cg(tm)});var Dy=Eg(Ry,{TileMatrix:dg(zg),MinTileRow:dg(Ug),MaxTileRow:dg(Ug),MinTileCol:dg(Ug),MaxTileCol:dg(Ug)});var Gy=Eg(Ry,{Default:dg(zg),Value:pg(zg)},Eg(Ty,{Identifier:dg(zg)}));var ky=Eg(Ty,{LowerCorner:cg(Jy),UpperCorner:cg(Jy)});var Uy=Eg(Ry,{WellKnownScaleSet:dg(zg),TileMatrix:pg(Qy)},Eg(Ty,{SupportedCRS:dg(zg),Identifier:dg(zg),BoundingBox:dg(Ky)}));var By=Eg(Ry,{TopLeftCorner:dg(Jy),ScaleDenominator:dg(Gg),TileWidth:dg(Ug),TileHeight:dg(Ug),MatrixWidth:dg(Ug),MatrixHeight:dg(Ug)},Eg(Ty,{Identifier:dg(zg)}));function zy(t,e){return bg({},Ly,t,e)}function Yy(t,e){return bg({},Ay,t,e)}function Wy(t,e){return bg({},Uy,t,e)}function Vy(t,e){var r=bg({},jy,t,e);if(!r){return undefined}var n=t.getAttribute("isDefault")==="true";r["isDefault"]=n;return r}function Xy(t,e){return bg({},Ny,t,e)}function qy(t,e){return bg({},Gy,t,e)}function Zy(t,e){var r=t.getAttribute("format");var n=t.getAttribute("template");var i=t.getAttribute("resourceType");var o={};if(r){o["format"]=r}if(n){o["template"]=n}if(i){o["resourceType"]=i}return o}function Ky(t,e){var r=bg([],ky,t,e);if(r.length!=2){return undefined}return Object(R["b"])(r)}function Hy(t,e){var r={};r["format"]=t.getAttribute("format");r["href"]=jg(t);return r}function Jy(t,e){var r=zg(t).split(/\s+/);if(!r||r.length!=2){return undefined}var n=+r[0];var i=+r[1];if(isNaN(n)||isNaN(i)){return undefined}return[n,i]}function Qy(t,e){return bg({},By,t,e)}function $y(t,e){return bg([],Fy,t,e)}function tm(t,e){return bg({},Dy,t,e)}var em=Py;var rm="1.3.0";var nm=.5;var im=true;var om=10;var am=.25;var sm=function(){function t(t,e,r,n,i,o){this.sourceProj_=t;this.targetProj_=e;var a={};var s=Xr(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];if(!a[e]){a[e]=s(t)}return a[e]};this.maxSourceExtent_=n;this.errorThresholdSquared_=i*i;this.triangles_=[];this.wrapsXInSource_=false;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Object(R["D"])(n)==Object(R["D"])(this.sourceProj_.getExtent());this.sourceWorldWidth_=this.sourceProj_.getExtent()?Object(R["D"])(this.sourceProj_.getExtent()):null;this.targetWorldWidth_=this.targetProj_.getExtent()?Object(R["D"])(this.targetProj_.getExtent()):null;var u=Object(R["B"])(r);var l=Object(R["C"])(r);var h=Object(R["v"])(r);var c=Object(R["u"])(r);var f=this.transformInv_(u);var p=this.transformInv_(l);var d=this.transformInv_(h);var v=this.transformInv_(c);var _=om+(o?Math.max(0,Math.ceil(Object(T["f"])(Object(R["t"])(r)/(o*o*256*256)))):0);this.addQuad_(u,l,h,c,f,p,d,v,_);if(this.wrapsXInSource_){var g=Infinity;this.triangles_.forEach((function(t,e,r){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])}));this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];if(e[0][0]-g>this.sourceWorldWidth_/2){e[0][0]-=this.sourceWorldWidth_}if(e[1][0]-g>this.sourceWorldWidth_/2){e[1][0]-=this.sourceWorldWidth_}if(e[2][0]-g>this.sourceWorldWidth_/2){e[2][0]-=this.sourceWorldWidth_}var r=Math.min(e[0][0],e[1][0],e[2][0]);var n=Math.max(e[0][0],e[1][0],e[2][0]);if(n-r<this.sourceWorldWidth_/2){t.source=e}}}.bind(this))}a={}}t.prototype.addTriangle_=function(t,e,r,n,i,o){this.triangles_.push({source:[n,i,o],target:[t,e,r]})};t.prototype.addQuad_=function(t,e,r,n,i,o,a,s,u){var l=Object(R["b"])([i,o,a,s]);var h=this.sourceWorldWidth_?Object(R["D"])(l)/this.sourceWorldWidth_:null;var c=this.sourceWorldWidth_;var f=this.sourceProj_.canWrapX()&&h>.5&&h<1;var p=false;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var d=Object(R["b"])([t,e,r,n]);var v=Object(R["D"])(d)/this.targetWorldWidth_;p=v>am||p}if(!f&&this.sourceProj_.isGlobal()&&h){p=h>am||p}}if(!p&&this.maxSourceExtent_){if(isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])){if(!Object(R["E"])(l,this.maxSourceExtent_)){return}}}var _=0;if(!p){if(!isFinite(i[0])||!isFinite(i[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1])){if(u>0){p=true}else{_=(!isFinite(i[0])||!isFinite(i[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(s[0])||!isFinite(s[1])?1:0);if(_!=1&&_!=2&&_!=4&&_!=8){return}}}}if(u>0){if(!p){var g=[(t[0]+r[0])/2,(t[1]+r[1])/2];var y=this.transformInv_(g);var m=void 0;if(f){var E=(Object(T["g"])(i[0],c)+Object(T["g"])(a[0],c))/2;m=E-Object(T["g"])(y[0],c)}else{m=(i[0]+a[0])/2-y[0]}var O=(i[1]+a[1])/2-y[1];var b=m*m+O*O;p=b>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var x=[(e[0]+r[0])/2,(e[1]+r[1])/2];var w=this.transformInv_(x);var M=[(n[0]+t[0])/2,(n[1]+t[1])/2];var S=this.transformInv_(M);this.addQuad_(t,e,x,M,i,o,w,S,u-1);this.addQuad_(M,x,r,n,S,w,a,s,u-1)}else{var C=[(t[0]+e[0])/2,(t[1]+e[1])/2];var I=this.transformInv_(C);var P=[(r[0]+n[0])/2,(r[1]+n[1])/2];var L=this.transformInv_(P);this.addQuad_(t,C,P,n,i,I,L,s,u-1);this.addQuad_(C,e,r,P,I,o,a,L,u-1)}return}}if(f){if(!this.canWrapXInSource_){return}this.wrapsXInSource_=true}if((_&11)==0){this.addTriangle_(t,r,n,i,a,s)}if((_&14)==0){this.addTriangle_(t,r,e,i,a,o)}if(_){if((_&13)==0){this.addTriangle_(e,n,t,o,s,i)}if((_&7)==0){this.addTriangle_(e,n,r,o,s,a)}}};t.prototype.calculateSourceExtent=function(){var t=Object(R["j"])();this.triangles_.forEach((function(e,r,n){var i=e.source;Object(R["q"])(t,i[0]);Object(R["q"])(t,i[1]);Object(R["q"])(t,i[2])}));return t};t.prototype.getTriangles=function(){return this.triangles_};return t}();var um=sm;var lm={imageSmoothingEnabled:false,msImageSmoothingEnabled:false};var hm={imageSmoothingEnabled:true,msImageSmoothingEnabled:true};var cm;function fm(t,e,r,n,i){t.beginPath();t.moveTo(0,0);t.lineTo(e,r);t.lineTo(n,i);t.closePath();t.save();t.clip();t.fillRect(0,0,Math.max(e,n)+1,Math.max(r,i));t.restore()}function pm(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function dm(){if(cm===undefined){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter";t.fillStyle="rgba(210, 0, 0, 0.75)";fm(t,4,5,4,0);fm(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;cm=pm(e,0)||pm(e,4)||pm(e,8)}return cm}function vm(t,e,r,n){var i=qr(r,e,t);var o=Nr(e,n,r);var a=e.getMetersPerUnit();if(a!==undefined){o*=a}var s=t.getMetersPerUnit();if(s!==undefined){o/=s}var u=t.getExtent();if(!u||Object(R["f"])(u,i)){var l=Nr(t,o,i)/o;if(isFinite(l)&&l>0){o/=l}}return o}function _m(t,e,r,n){var i=Object(R["w"])(r);var o=vm(t,e,i,n);if(!isFinite(o)||o<=0){Object(R["s"])(r,(function(r){o=vm(t,e,r,n);return isFinite(o)&&o>0}))}return o}function gm(t,e,r,n,i,o,a,s,u,l,h,c){var f=Object(Ut["a"])(Math.round(r*t),Math.round(r*e));if(!c){Object(K["a"])(f,lm)}if(u.length===0){return f.canvas}f.scale(r,r);function p(t){return Math.round(t*r)/r}f.globalCompositeOperation="lighter";var d=Object(R["j"])();u.forEach((function(t,e,r){Object(R["p"])(d,t.extent)}));var v=Object(R["D"])(d);var _=Object(R["z"])(d);var g=Object(Ut["a"])(Math.round(r*v/n),Math.round(r*_/n));if(!c){Object(K["a"])(g,lm)}var y=r/n;u.forEach((function(t,e,r){var n=t.extent[0]-d[0];var i=-(t.extent[3]-d[3]);var o=Object(R["D"])(t.extent);var a=Object(R["z"])(t.extent);if(t.image.width>0&&t.image.height>0){g.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*y,i*y,o*y,a*y)}}));var m=Object(R["B"])(a);s.getTriangles().forEach((function(t,e,i){var a=t.source;var s=t.target;var u=a[0][0],l=a[0][1];var h=a[1][0],v=a[1][1];var _=a[2][0],y=a[2][1];var E=p((s[0][0]-m[0])/o);var O=p(-(s[0][1]-m[1])/o);var b=p((s[1][0]-m[0])/o);var x=p(-(s[1][1]-m[1])/o);var w=p((s[2][0]-m[0])/o);var M=p(-(s[2][1]-m[1])/o);var S=u;var C=l;u=0;l=0;h-=S;v-=C;_-=S;y-=C;var R=[[h,v,0,0,b-E],[_,y,0,0,w-E],[0,0,h,v,x-O],[0,0,_,y,M-O]];var I=Object(T["i"])(R);if(!I){return}f.save();f.beginPath();if(dm()||!c){f.moveTo(b,x);var P=4;var L=E-b;var A=O-x;for(var j=0;j<P;j++){f.lineTo(b+p((j+1)*L/P),x+p(j*A/(P-1)));if(j!=P-1){f.lineTo(b+p((j+1)*L/P),x+p((j+1)*A/(P-1)))}}f.lineTo(w,M)}else{f.moveTo(b,x);f.lineTo(E,O);f.lineTo(w,M)}f.clip();f.transform(I[0],I[2],I[1],I[3],E,O);f.translate(d[0]-S,d[3]-C);f.scale(n/r,-n/r);f.drawImage(g.canvas,0,0);f.restore()}));if(h){f.save();f.globalCompositeOperation="source-over";f.strokeStyle="black";f.lineWidth=1;s.getTriangles().forEach((function(t,e,r){var n=t.target;var i=(n[0][0]-m[0])/o;var a=-(n[0][1]-m[1])/o;var s=(n[1][0]-m[0])/o;var u=-(n[1][1]-m[1])/o;var l=(n[2][0]-m[0])/o;var h=-(n[2][1]-m[1])/o;f.beginPath();f.moveTo(s,u);f.lineTo(i,a);f.lineTo(l,h);f.closePath();f.stroke()}));f.restore()}return f.canvas}var ym=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var mm=function(t){ym(e,t);function e(e,r,n,i,o,a,s){var u=this;var l=e.getExtent();var h=r.getExtent();var c=h?Object(R["A"])(n,h):n;var f=Object(R["w"])(c);var p=vm(e,r,f,i);var d=nm;var v=new um(e,r,c,l,p*d,i);var _=v.calculateSourceExtent();var g=a(_,p,o);var y=g?ts.IDLE:ts.EMPTY;var m=g?g.getPixelRatio():1;u=t.call(this,n,i,m,y)||this;u.targetProj_=r;u.maxSourceExtent_=l;u.triangulation_=v;u.targetResolution_=i;u.targetExtent_=n;u.sourceImage_=g;u.sourcePixelRatio_=m;u.interpolate_=s;u.canvas_=null;u.sourceListenerKey_=null;return u}e.prototype.disposeInternal=function(){if(this.state==ts.LOADING){this.unlistenSource_()}t.prototype.disposeInternal.call(this)};e.prototype.getImage=function(){return this.canvas_};e.prototype.getProjection=function(){return this.targetProj_};e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==ts.LOADED){var e=Object(R["D"])(this.targetExtent_)/this.targetResolution_;var r=Object(R["z"])(this.targetExtent_)/this.targetResolution_;this.canvas_=gm(e,r,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,undefined,this.interpolate_)}this.state=t;this.changed()};e.prototype.load=function(){if(this.state==ts.IDLE){this.state=ts.LOADING;this.changed();var t=this.sourceImage_.getState();if(t==ts.LOADED||t==ts.ERROR){this.reproject_()}else{this.sourceListenerKey_=Object(H["a"])(this.sourceImage_,V["a"].CHANGE,(function(t){var e=this.sourceImage_.getState();if(e==ts.LOADED||e==ts.ERROR){this.unlistenSource_();this.reproject_()}}),this);this.sourceImage_.load()}}};e.prototype.unlistenSource_=function(){Object(H["c"])(this.sourceListenerKey_);this.sourceListenerKey_=null};return e}(os);var Em=mm;var Om=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var bm={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};var xm=function(t){Om(e,t);function e(e,r){var n=t.call(this,e)||this;n.image=r;return n}return e}(wt["a"]);var wm=function(t){Om(e,t);function e(e){var r=this;var n=e.imageSmoothing!==undefined?e.imageSmoothing:true;if(e.interpolate!==undefined){n=e.interpolate}r=t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state,interpolate:n})||this;r.on;r.once;r.un;r.resolutions_=e.resolutions!==undefined?e.resolutions:null;r.reprojectedImage_=null;r.reprojectedRevision_=0;return r}e.prototype.getResolutions=function(){return this.resolutions_};e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Object(fn["h"])(this.resolutions_,t,0);t=this.resolutions_[e]}return t};e.prototype.getImage=function(t,e,r,n){var i=this.getProjection();if(!im||!i||!n||Wr(i,n)){if(i){n=i}return this.getImageInternal(t,e,r,n)}else{if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Wr(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&Object(R["o"])(this.reprojectedImage_.getExtent(),t)){return this.reprojectedImage_}this.reprojectedImage_.dispose();this.reprojectedImage_=null}this.reprojectedImage_=new Em(i,n,t,e,r,function(t,e,r){return this.getImageInternal(t,e,r,i)}.bind(this),this.getInterpolate());this.reprojectedRevision_=this.getRevision();return this.reprojectedImage_}};e.prototype.getImageInternal=function(t,e,r,n){return Object(s["b"])()};e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case ts.LOADING:this.loading=true;this.dispatchEvent(new xm(bm.IMAGELOADSTART,e));break;case ts.LOADED:this.loading=false;this.dispatchEvent(new xm(bm.IMAGELOADEND,e));break;case ts.ERROR:this.loading=false;this.dispatchEvent(new xm(bm.IMAGELOADERROR,e));break;default:}};return e}(Ys);function Mm(t,e){t.getImage().src=e}var Sm=wm;var Cm={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};function Rm(t,e){var r=[];Object.keys(e).forEach((function(t){if(e[t]!==null&&e[t]!==undefined){r.push(t+"="+encodeURIComponent(e[t]))}}));var n=r.join("&");t=t.replace(/[?&]$/,"");t=t.indexOf("?")===-1?t+"?":t+"&";return t+n}var Tm=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Im=4;var Pm=[101,101];var Lm=function(t){Tm(e,t);function e(e){var r=this;var n=e?e:{};var i=n.imageSmoothing!==undefined?n.imageSmoothing:true;if(n.interpolate!==undefined){i=n.interpolate}r=t.call(this,{attributions:n.attributions,interpolate:i,projection:n.projection,resolutions:n.resolutions})||this;r.crossOrigin_=n.crossOrigin!==undefined?n.crossOrigin:null;r.url_=n.url;r.imageLoadFunction_=n.imageLoadFunction!==undefined?n.imageLoadFunction:Mm;r.params_=n.params||{};r.v13_=true;r.updateV13_();r.serverType_=n.serverType;r.hidpi_=n.hidpi!==undefined?n.hidpi:true;r.image_=null;r.imageSize_=[0,0];r.renderedRevision_=0;r.ratio_=n.ratio!==undefined?n.ratio:1.5;return r}e.prototype.getFeatureInfoUrl=function(t,e,r,n){if(this.url_===undefined){return undefined}var i=jr(r);var o=this.getProjection();if(o&&o!==i){e=vm(o,i,t,e);t=qr(t,i,o)}var a=Object(R["y"])(t,e,0,Pm);var s={SERVICE:"WMS",VERSION:rm,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:true,QUERY_LAYERS:this.params_["LAYERS"]};Object(K["a"])(s,this.params_,n);var u=Object(T["d"])((t[0]-a[0])/e,Im);var l=Object(T["d"])((a[3]-t[1])/e,Im);s[this.v13_?"I":"X"]=u;s[this.v13_?"J":"Y"]=l;return this.getRequestUrl_(a,Pm,1,o||i,s)};e.prototype.getLegendUrl=function(t,e){if(this.url_===undefined){return undefined}var r={SERVICE:"WMS",VERSION:rm,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===undefined||e["LAYER"]===undefined){var n=this.params_.LAYERS;var i=!Array.isArray(n)||n.length===1;if(!i){return undefined}r["LAYER"]=n}if(t!==undefined){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;var a=28e-5;r["SCALE"]=t*o/a}Object(K["a"])(r,e);return Rm(this.url_,r)};e.prototype.getParams=function(){return this.params_};e.prototype.getImageInternal=function(t,e,r,n){if(this.url_===undefined){return null}e=this.findNearestResolution(e);if(r!=1&&(!this.hidpi_||this.serverType_===undefined)){r=1}var i=e/r;var o=Object(R["w"])(t);var a=Object(T["a"])(Object(R["D"])(t)/i,Im);var s=Object(T["a"])(Object(R["z"])(t)/i,Im);var u=Object(R["y"])(o,i,0,[a,s]);var l=Object(T["a"])(this.ratio_*Object(R["D"])(t)/i,Im);var h=Object(T["a"])(this.ratio_*Object(R["z"])(t)/i,Im);var c=Object(R["y"])(o,i,0,[l,h]);var f=this.image_;if(f&&this.renderedRevision_==this.getRevision()&&f.getResolution()==e&&f.getPixelRatio()==r&&Object(R["g"])(f.getExtent(),u)){return f}var p={SERVICE:"WMS",VERSION:rm,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:true};Object(K["a"])(p,this.params_);this.imageSize_[0]=Object(T["h"])(Object(R["D"])(c)/i,Im);this.imageSize_[1]=Object(T["h"])(Object(R["z"])(c)/i,Im);var d=this.getRequestUrl_(c,this.imageSize_,r,n,p);this.image_=new ls(c,e,r,d,this.crossOrigin_,this.imageLoadFunction_);this.renderedRevision_=this.getRevision();this.image_.addEventListener(V["a"].CHANGE,this.handleImageChange.bind(this));return this.image_};e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_};e.prototype.getRequestUrl_=function(t,e,r,n,i){Object(l["a"])(this.url_!==undefined,9);i[this.v13_?"CRS":"SRS"]=n.getCode();if(!("STYLES"in this.params_)){i["STYLES"]=""}if(r!=1){switch(this.serverType_){case Cm.GEOSERVER:var o=90*r+.5|0;if("FORMAT_OPTIONS"in i){i["FORMAT_OPTIONS"]+=";dpi:"+o}else{i["FORMAT_OPTIONS"]="dpi:"+o}break;case Cm.MAPSERVER:i["MAP_RESOLUTION"]=90*r;break;case Cm.CARMENTA_SERVER:case Cm.QGIS:i["DPI"]=90*r;break;default:Object(l["a"])(false,8);break}}i["WIDTH"]=e[0];i["HEIGHT"]=e[1];var a=n.getAxisOrientation();var s;if(this.v13_&&a.substr(0,2)=="ne"){s=[t[1],t[0],t[3],t[2]]}else{s=t}i["BBOX"]=s.join(",");return Rm(this.url_,i)};e.prototype.getUrl=function(){return this.url_};e.prototype.setImageLoadFunction=function(t){this.image_=null;this.imageLoadFunction_=t;this.changed()};e.prototype.setUrl=function(t){if(t!=this.url_){this.url_=t;this.image_=null;this.changed()}};e.prototype.updateParams=function(t){Object(K["a"])(this.params_,t);this.updateV13_();this.image_=null;this.changed()};e.prototype.updateV13_=function(){var t=this.params_["VERSION"]||rm;this.v13_=rt(t,"1.3")>=0};return e}(Sm);var Am=Lm;var jm=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Nm=function(t){jm(e,t);function e(e,r,n){var i=t.call(this)||this;var o=n?n:{};i.tileCoord=e;i.state=r;i.interimTile=null;i.key="";i.transition_=o.transition===undefined?250:o.transition;i.transitionStarts_={};i.interpolate=!!o.interpolate;return i}e.prototype.changed=function(){this.dispatchEvent(V["a"].CHANGE)};e.prototype.release=function(){};e.prototype.getKey=function(){return this.key+"/"+this.tileCoord};e.prototype.getInterimTile=function(){if(!this.interimTile){return this}var t=this.interimTile;do{if(t.getState()==Ne.LOADED){this.transition_=0;return t}t=t.interimTile}while(t);return this};e.prototype.refreshInterimChain=function(){if(!this.interimTile){return}var t=this.interimTile;var e=this;do{if(t.getState()==Ne.LOADED){t.interimTile=null;break}else if(t.getState()==Ne.LOADING){e=t}else if(t.getState()==Ne.IDLE){e.interimTile=t.interimTile}else{e=t}t=e.interimTile}while(t)};e.prototype.getTileCoord=function(){return this.tileCoord};e.prototype.getState=function(){return this.state};e.prototype.setState=function(t){if(this.state!==Ne.ERROR&&this.state>t){throw new Error("Tile load sequence violation")}this.state=t;this.changed()};e.prototype.load=function(){Object(s["b"])()};e.prototype.getAlpha=function(t,e){if(!this.transition_){return 1}var r=this.transitionStarts_[t];if(!r){r=e;this.transitionStarts_[t]=r}else if(r===-1){return 1}var n=e-r+1e3/60;if(n>=this.transition_){return 1}return bn(n/this.transition_)};e.prototype.inTransition=function(t){if(!this.transition_){return false}return this.transitionStarts_[t]!==-1};e.prototype.endTransition=function(t){if(this.transition_){this.transitionStarts_[t]=-1}};return e}(kt["a"]);var Fm=Nm;var Dm=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Gm=function(t){Dm(e,t);function e(e,r,n,i,o,a){var s=t.call(this,e,r,a)||this;s.crossOrigin_=i;s.src_=n;s.key=n;s.image_=new Image;if(i!==null){s.image_.crossOrigin=i}s.unlisten_=null;s.tileLoadFunction_=o;return s}e.prototype.getImage=function(){return this.image_};e.prototype.setImage=function(t){this.image_=t;this.state=Ne.LOADED;this.unlistenImage_();this.changed()};e.prototype.handleImageError_=function(){this.state=Ne.ERROR;this.unlistenImage_();this.image_=km();this.changed()};e.prototype.handleImageLoad_=function(){var t=this.image_;if(t.naturalWidth&&t.naturalHeight){this.state=Ne.LOADED}else{this.state=Ne.EMPTY}this.unlistenImage_();this.changed()};e.prototype.load=function(){if(this.state==Ne.ERROR){this.state=Ne.IDLE;this.image_=new Image;if(this.crossOrigin_!==null){this.image_.crossOrigin=this.crossOrigin_}}if(this.state==Ne.IDLE){this.state=Ne.LOADING;this.changed();this.tileLoadFunction_(this,this.src_);this.unlisten_=us(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}};e.prototype.unlistenImage_=function(){if(this.unlisten_){this.unlisten_();this.unlisten_=null}};return e}(Fm);function km(){var t=Object(Ut["a"])(1,1);t.fillStyle="rgba(0,0,0,0)";t.fillRect(0,0,1,1);return t.canvas}var Um=Gm;var Bm=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var zm=function(t){Bm(e,t);function e(e,r,n,i,o,a,s,u,l,h,c,f){var p=t.call(this,o,Ne.IDLE,{interpolate:!!f})||this;p.renderEdges_=c!==undefined?c:false;p.pixelRatio_=s;p.gutter_=u;p.canvas_=null;p.sourceTileGrid_=r;p.targetTileGrid_=i;p.wrappedTileCoord_=a?a:o;p.sourceTiles_=[];p.sourcesListenerKeys_=null;p.sourceZ_=0;var d=i.getTileCoordExtent(p.wrappedTileCoord_);var v=p.targetTileGrid_.getExtent();var _=p.sourceTileGrid_.getExtent();var g=v?Object(R["A"])(d,v):d;if(Object(R["t"])(g)===0){p.state=Ne.EMPTY;return p}var y=e.getExtent();if(y){if(!_){_=y}else{_=Object(R["A"])(_,y)}}var m=i.getResolution(p.wrappedTileCoord_[0]);var E=_m(e,n,g,m);if(!isFinite(E)||E<=0){p.state=Ne.EMPTY;return p}var O=h!==undefined?h:nm;p.triangulation_=new um(e,n,g,_,E*O,m);if(p.triangulation_.getTriangles().length===0){p.state=Ne.EMPTY;return p}p.sourceZ_=r.getZForResolution(E);var b=p.triangulation_.calculateSourceExtent();if(_){if(e.canWrapX()){b[1]=Object(T["b"])(b[1],_[1],_[3]);b[3]=Object(T["b"])(b[3],_[1],_[3])}else{b=Object(R["A"])(b,_)}}if(!Object(R["t"])(b)){p.state=Ne.EMPTY}else{var x=r.getTileRangeForExtentAndZ(b,p.sourceZ_);for(var w=x.minX;w<=x.maxX;w++){for(var M=x.minY;M<=x.maxY;M++){var S=l(p.sourceZ_,w,M,s);if(S){p.sourceTiles_.push(S)}}}if(p.sourceTiles_.length===0){p.state=Ne.EMPTY}}return p}e.prototype.getImage=function(){return this.canvas_};e.prototype.reproject_=function(){var t=[];this.sourceTiles_.forEach(function(e,r,n){if(e&&e.getState()==Ne.LOADED){t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}}.bind(this));this.sourceTiles_.length=0;if(t.length===0){this.state=Ne.ERROR}else{var e=this.wrappedTileCoord_[0];var r=this.targetTileGrid_.getTileSize(e);var n=typeof r==="number"?r:r[0];var i=typeof r==="number"?r:r[1];var o=this.targetTileGrid_.getResolution(e);var a=this.sourceTileGrid_.getResolution(this.sourceZ_);var s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=gm(n,i,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate);this.state=Ne.LOADED}this.changed()};e.prototype.load=function(){if(this.state==Ne.IDLE){this.state=Ne.LOADING;this.changed();var t=0;this.sourcesListenerKeys_=[];this.sourceTiles_.forEach(function(e,r,n){var i=e.getState();if(i==Ne.IDLE||i==Ne.LOADING){t++;var o=Object(H["a"])(e,V["a"].CHANGE,(function(r){var n=e.getState();if(n==Ne.LOADED||n==Ne.ERROR||n==Ne.EMPTY){Object(H["c"])(o);t--;if(t===0){this.unlistenSources_();this.reproject_()}}}),this);this.sourcesListenerKeys_.push(o)}}.bind(this));if(t===0){setTimeout(this.reproject_.bind(this),0)}else{this.sourceTiles_.forEach((function(t,e,r){var n=t.getState();if(n==Ne.IDLE){t.load()}}))}}};e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(H["c"]);this.sourcesListenerKeys_=null};return e}(Fm);var Ym=zm;var Wm=function(){function t(t){this.highWaterMark=t!==undefined?t:2048;this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null}t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark};t.prototype.clear=function(){this.count_=0;this.entries_={};this.oldest_=null;this.newest_=null};t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)};t.prototype.forEach=function(t){var e=this.oldest_;while(e){t(e.value_,e.key_,this);e=e.newer}};t.prototype.get=function(t,e){var r=this.entries_[t];Object(l["a"])(r!==undefined,15);if(r===this.newest_){return r.value_}else if(r===this.oldest_){this.oldest_=this.oldest_.newer;this.oldest_.older=null}else{r.newer.older=r.older;r.older.newer=r.newer}r.newer=null;r.older=this.newest_;this.newest_.newer=r;this.newest_=r;return r.value_};t.prototype.remove=function(t){var e=this.entries_[t];Object(l["a"])(e!==undefined,15);if(e===this.newest_){this.newest_=e.older;if(this.newest_){this.newest_.newer=null}}else if(e===this.oldest_){this.oldest_=e.newer;if(this.oldest_){this.oldest_.older=null}}else{e.newer.older=e.older;e.older.newer=e.newer}delete this.entries_[t];--this.count_;return e.value_};t.prototype.getCount=function(){return this.count_};t.prototype.getKeys=function(){var t=new Array(this.count_);var e=0;var r;for(r=this.newest_;r;r=r.older){t[e++]=r.key_}return t};t.prototype.getValues=function(){var t=new Array(this.count_);var e=0;var r;for(r=this.newest_;r;r=r.older){t[e++]=r.value_}return t};t.prototype.peekLast=function(){return this.oldest_.value_};t.prototype.peekLastKey=function(){return this.oldest_.key_};t.prototype.peekFirstKey=function(){return this.newest_.key_};t.prototype.pop=function(){var t=this.oldest_;delete this.entries_[t.key_];if(t.newer){t.newer.older=null}this.oldest_=t.newer;if(!this.oldest_){this.newest_=null}--this.count_;return t.value_};t.prototype.replace=function(t,e){this.get(t);this.entries_[t].value_=e};t.prototype.set=function(t,e){Object(l["a"])(!(t in this.entries_),16);var r={key_:t,newer:null,older:this.newest_,value_:e};if(!this.newest_){this.oldest_=r}else{this.newest_.newer=r}this.newest_=r;this.entries_[t]=r;++this.count_};t.prototype.setSize=function(t){this.highWaterMark=t};return t}();var Vm=Wm;function Xm(t,e,r,n){if(n!==undefined){n[0]=t;n[1]=e;n[2]=r;return n}else{return[t,e,r]}}function qm(t,e,r){return t+"/"+e+"/"+r}function Zm(t){return qm(t[0],t[1],t[2])}function Km(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(",").map(Number),r=e[0],n=e[1],i=e[2];return qm(r,n,i)}function Hm(t){return t.split("/").map(Number)}function Jm(t){return(t[1]<<t[0])+t[2]}function Qm(t,e){var r=t[0];var n=t[1];var i=t[2];if(e.getMinZoom()>r||r>e.getMaxZoom()){return false}var o=e.getFullTileRange(r);if(!o){return true}else{return o.containsXY(n,i)}}var $m=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var tE=function(t){$m(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.expireCache=function(t){while(this.canExpireCache()){var e=this.peekLast();if(e.getKey()in t){break}else{this.pop().release()}}};e.prototype.pruneExceptNewestZ=function(){if(this.getCount()===0){return}var t=this.peekFirstKey();var e=Hm(t);var r=e[0];this.forEach(function(t){if(t.tileCoord[0]!==r){this.remove(Zm(t.tileCoord));t.release()}}.bind(this))};return e}(Vm);var eE=tE;var rE={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var nE=r(23);var iE=function(){function t(t,e,r,n){this.minX=t;this.maxX=e;this.minY=r;this.maxY=n}t.prototype.contains=function(t){return this.containsXY(t[1],t[2])};t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY};t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY};t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY};t.prototype.extend=function(t){if(t.minX<this.minX){this.minX=t.minX}if(t.maxX>this.maxX){this.maxX=t.maxX}if(t.minY<this.minY){this.minY=t.minY}if(t.maxY>this.maxY){this.maxY=t.maxY}};t.prototype.getHeight=function(){return this.maxY-this.minY+1};t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]};t.prototype.getWidth=function(){return this.maxX-this.minX+1};t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};return t}();function oE(t,e,r,n,i){if(i!==undefined){i.minX=t;i.maxX=e;i.minY=r;i.maxY=n;return i}else{return new iE(t,e,r,n)}}var aE=iE;var sE=[0,0,0];var uE=5;var lE=function(){function t(t){this.minZoom=t.minZoom!==undefined?t.minZoom:0;this.resolutions_=t.resolutions;Object(l["a"])(Object(fn["g"])(this.resolutions_,(function(t,e){return e-t}),true),17);var e;if(!t.origins){for(var r=0,n=this.resolutions_.length-1;r<n;++r){if(!e){e=this.resolutions_[r]/this.resolutions_[r+1]}else{if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=undefined;break}}}}this.zoomFactor_=e;this.maxZoom=this.resolutions_.length-1;this.origin_=t.origin!==undefined?t.origin:null;this.origins_=null;if(t.origins!==undefined){this.origins_=t.origins;Object(l["a"])(this.origins_.length==this.resolutions_.length,20)}var i=t.extent;if(i!==undefined&&!this.origin_&&!this.origins_){this.origin_=Object(R["B"])(i)}Object(l["a"])(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;if(t.tileSizes!==undefined){this.tileSizes_=t.tileSizes;Object(l["a"])(this.tileSizes_.length==this.resolutions_.length,19)}this.tileSize_=t.tileSize!==undefined?t.tileSize:!this.tileSizes_?Ke:null;Object(l["a"])(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=i!==undefined?i:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];this.tmpExtent_=[0,0,0,0];if(t.sizes!==undefined){this.fullTileRanges_=t.sizes.map((function(t,e){var r=new aE(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){var n=this.getTileRangeForExtentAndZ(i,e);r.minX=Math.max(n.minX,r.minX);r.maxX=Math.min(n.maxX,r.maxX);r.minY=Math.max(n.minY,r.minY);r.maxY=Math.min(n.maxY,r.maxY)}return r}),this)}else if(i){this.calculateTileRanges_(i)}}t.prototype.forEachTileCoord=function(t,e,r){var n=this.getTileRangeForExtentAndZ(t,e);for(var i=n.minX,o=n.maxX;i<=o;++i){for(var a=n.minY,s=n.maxY;a<=s;++a){r([e,i,a])}}};t.prototype.forEachTileCoordParentTileRange=function(t,e,r,n){var i,o,a;var s=null;var u=t[0]-1;if(this.zoomFactor_===2){o=t[1];a=t[2]}else{s=this.getTileCoordExtent(t,n)}while(u>=this.minZoom){if(this.zoomFactor_===2){o=Math.floor(o/2);a=Math.floor(a/2);i=oE(o,o,a,a,r)}else{i=this.getTileRangeForExtentAndZ(s,u,r)}if(e(u,i)){return true}--u}return false};t.prototype.getExtent=function(){return this.extent_};t.prototype.getMaxZoom=function(){return this.maxZoom};t.prototype.getMinZoom=function(){return this.minZoom};t.prototype.getOrigin=function(t){if(this.origin_){return this.origin_}else{return this.origins_[t]}};t.prototype.getResolution=function(t){return this.resolutions_[t]};t.prototype.getResolutions=function(){return this.resolutions_};t.prototype.getTileCoordChildTileRange=function(t,e,r){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){var n=t[1]*2;var i=t[2]*2;return oE(n,n+1,i,i+1,e)}var o=this.getTileCoordExtent(t,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null};t.prototype.getTileRangeForTileCoordAndZ=function(t,e,r){if(e>this.maxZoom||e<this.minZoom){return null}var n=t[0];var i=t[1];var o=t[2];if(e===n){return oE(i,o,i,o,r)}if(this.zoomFactor_){var a=Math.pow(this.zoomFactor_,e-n);var s=Math.floor(i*a);var u=Math.floor(o*a);if(e<n){return oE(s,s,u,u,r)}var l=Math.floor(a*(i+1))-1;var h=Math.floor(a*(o+1))-1;return oE(s,l,u,h,r)}var c=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(c,e,r)};t.prototype.getTileRangeExtent=function(t,e,r){var n=this.getOrigin(t);var i=this.getResolution(t);var o=io(this.getTileSize(t),this.tmpSize_);var a=n[0]+e.minX*o[0]*i;var s=n[0]+(e.maxX+1)*o[0]*i;var u=n[1]+e.minY*o[1]*i;var l=n[1]+(e.maxY+1)*o[1]*i;return Object(R["k"])(a,u,s,l,r)};t.prototype.getTileRangeForExtentAndZ=function(t,e,r){var n=sE;this.getTileCoordForXYAndZ_(t[0],t[3],e,false,n);var i=n[1];var o=n[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,true,n);return oE(i,n[1],o,n[2],r)};t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]);var r=this.getResolution(t[0]);var n=io(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*r,e[1]-(t[2]+.5)*n[1]*r]};t.prototype.getTileCoordExtent=function(t,e){var r=this.getOrigin(t[0]);var n=this.getResolution(t[0]);var i=io(this.getTileSize(t[0]),this.tmpSize_);var o=r[0]+t[1]*i[0]*n;var a=r[1]-(t[2]+1)*i[1]*n;var s=o+i[0]*n;var u=a+i[1]*n;return Object(R["k"])(o,a,s,u,e)};t.prototype.getTileCoordForCoordAndResolution=function(t,e,r){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,false,r)};t.prototype.getTileCoordForXYAndResolution_=function(t,e,r,n,i){var o=this.getZForResolution(r);var a=r/this.getResolution(o);var s=this.getOrigin(o);var u=io(this.getTileSize(o),this.tmpSize_);var l=a*(t-s[0])/r/u[0];var h=a*(s[1]-e)/r/u[1];if(n){l=Object(T["a"])(l,uE)-1;h=Object(T["a"])(h,uE)-1}else{l=Object(T["d"])(l,uE);h=Object(T["d"])(h,uE)}return Xm(o,l,h,i)};t.prototype.getTileCoordForXYAndZ_=function(t,e,r,n,i){var o=this.getOrigin(r);var a=this.getResolution(r);var s=io(this.getTileSize(r),this.tmpSize_);var u=(t-o[0])/a/s[0];var l=(o[1]-e)/a/s[1];if(n){u=Object(T["a"])(u,uE)-1;l=Object(T["a"])(l,uE)-1}else{u=Object(T["d"])(u,uE);l=Object(T["d"])(l,uE)}return Xm(r,u,l,i)};t.prototype.getTileCoordForCoordAndZ=function(t,e,r){return this.getTileCoordForXYAndZ_(t[0],t[1],e,false,r)};t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]};t.prototype.getTileSize=function(t){if(this.tileSize_){return this.tileSize_}else{return this.tileSizes_[t]}};t.prototype.getFullTileRange=function(t){if(!this.fullTileRanges_){return this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}else{return this.fullTileRanges_[t]}};t.prototype.getZForResolution=function(t,e){var r=Object(fn["h"])(this.resolutions_,t,e||0);return Object(T["b"])(r,this.minZoom,this.maxZoom)};t.prototype.calculateTileRanges_=function(t){var e=this.resolutions_.length;var r=new Array(e);for(var n=this.minZoom;n<e;++n){r[n]=this.getTileRangeForExtentAndZ(t,n)}this.fullTileRanges_=r};return t}();var hE=lE;function cE(t){var e=t.getDefaultTileGrid();if(!e){e=_E(t);t.setDefaultTileGrid(e)}return e}function fE(t,e,r){var n=e[0];var i=t.getTileCoordCenter(e);var o=gE(r);if(!Object(R["f"])(o,i)){var a=Object(R["D"])(o);var s=Math.ceil((o[0]-i[0])/a);i[0]+=a*s;return t.getTileCoordForCoordAndZ(i,n)}else{return e}}function pE(t,e,r,n){var i=n!==undefined?n:nE["a"].TOP_LEFT;var o=vE(t,e,r);return new hE({extent:t,origin:Object(R["x"])(t,i),resolutions:o,tileSize:r})}function dE(t){var e=t||{};var r=e.extent||jr("EPSG:3857").getExtent();var n={extent:r,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:vE(r,e.maxZoom,e.tileSize,e.maxResolution)};return new hE(n)}function vE(t,e,r,n){var i=e!==undefined?e:Ze;var o=Object(R["z"])(t);var a=Object(R["D"])(t);var s=io(r!==undefined?r:Ke);var u=n>0?n:Math.max(a/s[0],o/s[1]);var l=i+1;var h=new Array(l);for(var c=0;c<l;++c){h[c]=u/Math.pow(2,c)}return h}function _E(t,e,r,n){var i=gE(t);return pE(i,e,r,n)}function gE(t){t=jr(t);var e=t.getExtent();if(!e){var r=180*We[Ve.DEGREES]/t.getMetersPerUnit();e=Object(R["k"])(-r,-r,r,r)}return e}var yE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var mE=function(t){yE(e,t);function e(e){var r=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate})||this;r.on;r.once;r.un;r.opaque_=e.opaque!==undefined?e.opaque:false;r.tilePixelRatio_=e.tilePixelRatio!==undefined?e.tilePixelRatio:1;r.tileGrid=e.tileGrid!==undefined?e.tileGrid:null;var n=[256,256];var i=e.tileGrid;if(i){io(i.getTileSize(i.getMinZoom()),n)}r.tileCache=new eE(e.cacheSize||0);r.tmpSize=[0,0];r.key_=e.key||"";r.tileOptions={transition:e.transition,interpolate:e.interpolate};r.zDirection=e.zDirection?e.zDirection:0;return r}e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()};e.prototype.expireCache=function(t,e){var r=this.getTileCacheForProjection(t);if(r){r.expireCache(e)}};e.prototype.forEachLoadedTile=function(t,e,r,n){var i=this.getTileCacheForProjection(t);if(!i){return false}var o=true;var a,s,u;for(var l=r.minX;l<=r.maxX;++l){for(var h=r.minY;h<=r.maxY;++h){s=qm(e,l,h);u=false;if(i.containsKey(s)){a=i.get(s);u=a.getState()===Ne.LOADED;if(u){u=n(a)!==false}}if(!u){o=false}}}return o};e.prototype.getGutterForProjection=function(t){return 0};e.prototype.getKey=function(){return this.key_};e.prototype.setKey=function(t){if(this.key_!==t){this.key_=t;this.changed()}};e.prototype.getOpaque=function(t){return this.opaque_};e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()};e.prototype.getTile=function(t,e,r,n,i){return Object(s["b"])()};e.prototype.getTileGrid=function(){return this.tileGrid};e.prototype.getTileGridForProjection=function(t){if(!this.tileGrid){return cE(t)}else{return this.tileGrid}};e.prototype.getTileCacheForProjection=function(t){Object(l["a"])(Wr(this.getProjection(),t),68);return this.tileCache};e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_};e.prototype.getTilePixelSize=function(t,e,r){var n=this.getTileGridForProjection(r);var i=this.getTilePixelRatio(e);var o=io(n.getTileSize(t),this.tmpSize);if(i==1){return o}else{return no(o,i,this.tmpSize)}};e.prototype.getTileCoordForTileUrlFunction=function(t,e){var r=e!==undefined?e:this.getProjection();var n=this.getTileGridForProjection(r);if(this.getWrapX()&&r.isGlobal()){t=fE(n,t,r)}return Qm(t,n)?t:null};e.prototype.clear=function(){this.tileCache.clear()};e.prototype.refresh=function(){this.clear();t.prototype.refresh.call(this)};e.prototype.updateCacheSize=function(t,e){var r=this.getTileCacheForProjection(e);if(t>r.highWaterMark){r.highWaterMark=t}};e.prototype.useTile=function(t,e,r,n){};return e}(Ys);var EE=function(t){yE(e,t);function e(e,r){var n=t.call(this,e)||this;n.tile=r;return n}return e}(wt["a"]);var OE=mE;function bE(t,e){var r=/\{z\}/g;var n=/\{x\}/g;var i=/\{y\}/g;var o=/\{-y\}/g;return function(a,s,u){if(!a){return undefined}else{return t.replace(r,a[0].toString()).replace(n,a[1].toString()).replace(i,a[2].toString()).replace(o,(function(){var t=a[0];var r=e.getFullTileRange(t);Object(l["a"])(r,55);var n=r.getHeight()-a[2]-1;return n.toString()}))}}}function xE(t,e){var r=t.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=bE(t[i],e)}return wE(n)}function wE(t){if(t.length===1){return t[0]}return function(e,r,n){if(!e){return undefined}else{var i=Jm(e);var o=Object(T["g"])(i,t.length);return t[o](e,r,n)}}}function ME(t,e,r){return undefined}function SE(t){var e=[];var r=/\{([a-z])-([a-z])\}/.exec(t);if(r){var n=r[1].charCodeAt(0);var i=r[2].charCodeAt(0);var o=void 0;for(o=n;o<=i;++o){e.push(t.replace(r[0],String.fromCharCode(o)))}return e}r=/\{(\d+)-(\d+)\}/.exec(t);if(r){var a=parseInt(r[2],10);for(var s=parseInt(r[1],10);s<=a;s++){e.push(t.replace(r[0],s.toString()))}return e}e.push(t);return e}var CE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var RE=function(t){CE(e,t);function e(r){var n=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,opaque:r.opaque,projection:r.projection,state:r.state,tileGrid:r.tileGrid,tilePixelRatio:r.tilePixelRatio,wrapX:r.wrapX,transition:r.transition,interpolate:r.interpolate,key:r.key,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection})||this;n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction;n.tileLoadFunction=r.tileLoadFunction;if(r.tileUrlFunction){n.tileUrlFunction=r.tileUrlFunction}n.urls=null;if(r.urls){n.setUrls(r.urls)}else if(r.url){n.setUrl(r.url)}n.tileLoadingKeys_={};return n}e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction};e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction};e.prototype.getUrls=function(){return this.urls};e.prototype.handleTileChange=function(t){var e=t.target;var r=Object(s["c"])(e);var n=e.getState();var i;if(n==Ne.LOADING){this.tileLoadingKeys_[r]=true;i=rE.TILELOADSTART}else if(r in this.tileLoadingKeys_){delete this.tileLoadingKeys_[r];i=n==Ne.ERROR?rE.TILELOADERROR:n==Ne.LOADED?rE.TILELOADEND:undefined}if(i!=undefined){this.dispatchEvent(new EE(i,e))}};e.prototype.setTileLoadFunction=function(t){this.tileCache.clear();this.tileLoadFunction=t;this.changed()};e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t;this.tileCache.pruneExceptNewestZ();if(typeof e!=="undefined"){this.setKey(e)}else{this.changed()}};e.prototype.setUrl=function(t){var e=SE(t);this.urls=e;this.setUrls(e)};e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");if(this.generateTileUrlFunction_){this.setTileUrlFunction(xE(t,this.tileGrid),e)}else{this.setKey(e)}};e.prototype.tileUrlFunction=function(t,e,r){return undefined};e.prototype.useTile=function(t,e,r){var n=qm(t,e,r);if(this.tileCache.containsKey(n)){this.tileCache.get(n)}};return e}(OE);var TE=RE;var IE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var PE=function(t){IE(e,t);function e(e){var r=this;var n=e.imageSmoothing!==undefined?e.imageSmoothing:true;if(e.interpolate!==undefined){n=e.interpolate}r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:LE,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:n,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;r.crossOrigin=e.crossOrigin!==undefined?e.crossOrigin:null;r.tileClass=e.tileClass!==undefined?e.tileClass:Um;r.tileCacheForProjection={};r.tileGridForProjection={};r.reprojectionErrorThreshold_=e.reprojectionErrorThreshold;r.renderReprojectionEdges_=false;return r}e.prototype.canExpireCache=function(){if(!im){return t.prototype.canExpireCache.call(this)}if(this.tileCache.canExpireCache()){return true}else{for(var e in this.tileCacheForProjection){if(this.tileCacheForProjection[e].canExpireCache()){return true}}}return false};e.prototype.expireCache=function(e,r){if(!im){t.prototype.expireCache.call(this,e,r);return}var n=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==n?r:{});for(var i in this.tileCacheForProjection){var o=this.tileCacheForProjection[i];o.expireCache(o==n?r:{})}};e.prototype.getGutterForProjection=function(t){if(im&&this.getProjection()&&t&&!Wr(this.getProjection(),t)){return 0}else{return this.getGutter()}};e.prototype.getGutter=function(){return 0};e.prototype.getKey=function(){var e=t.prototype.getKey.call(this);if(!this.getInterpolate()){e+=":disable-interpolation"}return e};e.prototype.getOpaque=function(e){if(im&&this.getProjection()&&e&&!Wr(this.getProjection(),e)){return false}else{return t.prototype.getOpaque.call(this,e)}};e.prototype.getTileGridForProjection=function(e){if(!im){return t.prototype.getTileGridForProjection.call(this,e)}var r=this.getProjection();if(this.tileGrid&&(!r||Wr(r,e))){return this.tileGrid}else{var n=Object(s["c"])(e);if(!(n in this.tileGridForProjection)){this.tileGridForProjection[n]=cE(e)}return this.tileGridForProjection[n]}};e.prototype.getTileCacheForProjection=function(e){if(!im){return t.prototype.getTileCacheForProjection.call(this,e)}var r=this.getProjection();if(!r||Wr(r,e)){return this.tileCache}else{var n=Object(s["c"])(e);if(!(n in this.tileCacheForProjection)){this.tileCacheForProjection[n]=new eE(this.tileCache.highWaterMark)}return this.tileCacheForProjection[n]}};e.prototype.createTile_=function(t,e,r,n,i,o){var a=[t,e,r];var s=this.getTileCoordForTileUrlFunction(a,i);var u=s?this.tileUrlFunction(s,n,i):undefined;var l=new this.tileClass(a,u!==undefined?Ne.IDLE:Ne.EMPTY,u!==undefined?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);l.key=o;l.addEventListener(V["a"].CHANGE,this.handleTileChange.bind(this));return l};e.prototype.getTile=function(t,e,r,n,i){var o=this.getProjection();if(!im||!o||!i||Wr(o,i)){return this.getTileInternal(t,e,r,n,o||i)}else{var a=this.getTileCacheForProjection(i);var s=[t,e,r];var u=void 0;var l=Zm(s);if(a.containsKey(l)){u=a.get(l)}var h=this.getKey();if(u&&u.key==h){return u}else{var c=this.getTileGridForProjection(o);var f=this.getTileGridForProjection(i);var p=this.getTileCoordForTileUrlFunction(s,i);var d=new Ym(o,c,i,f,s,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,r,n){return this.getTileInternal(t,e,r,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());d.key=h;if(u){d.interimTile=u;d.refreshInterimChain();a.replace(l,d)}else{a.set(l,d)}return d}}};e.prototype.getTileInternal=function(t,e,r,n,i){var o=null;var a=qm(t,e,r);var s=this.getKey();if(!this.tileCache.containsKey(a)){o=this.createTile_(t,e,r,n,i,s);this.tileCache.set(a,o)}else{o=this.tileCache.get(a);if(o.key!=s){var u=o;o=this.createTile_(t,e,r,n,i,s);if(u.getState()==Ne.IDLE){o.interimTile=u.interimTile}else{o.interimTile=u}o.refreshInterimChain();this.tileCache.replace(a,o)}}return o};e.prototype.setRenderReprojectionEdges=function(t){if(!im||this.renderReprojectionEdges_==t){return}this.renderReprojectionEdges_=t;for(var e in this.tileCacheForProjection){this.tileCacheForProjection[e].clear()}this.changed()};e.prototype.setTileGridForProjection=function(t,e){if(im){var r=jr(t);if(r){var n=Object(s["c"])(r);if(!(n in this.tileGridForProjection)){this.tileGridForProjection[n]=e}}}};return e}(TE);function LE(t,e){t.getImage().src=e}var AE=PE;var jE={KVP:"KVP",REST:"REST"};var NE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var FE=function(t){NE(e,t);function e(e){var r=t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;r.matrixIds_=e.matrixIds;return r}e.prototype.getMatrixId=function(t){return this.matrixIds_[t]};e.prototype.getMatrixIds=function(){return this.matrixIds_};return e}(hE);var DE=FE;function GE(t,e,r){var n=[];var i=[];var o=[];var a=[];var s=[];var u=r!==undefined?r:[];var l="SupportedCRS";var h="TileMatrix";var c="Identifier";var f="ScaleDenominator";var p="TopLeftCorner";var d="TileWidth";var v="TileHeight";var _=t[l];var g=jr(_);var y=g.getMetersPerUnit();var m=g.getAxisOrientation().substr(0,2)=="ne";t[h].sort((function(t,e){return e[f]-t[f]}));t[h].forEach((function(e){var r;if(u.length>0){r=Object(fn["d"])(u,(function(r){if(e[c]==r[h]){return true}if(e[c].indexOf(":")===-1){return t[c]+":"+e[c]===r[h]}return false}))}else{r=true}if(r){i.push(e[c]);var l=e[f]*28e-5/y;var _=e[d];var g=e[v];if(m){o.push([e[p][1],e[p][0]])}else{o.push(e[p])}n.push(l);a.push(_==g?_:[_,g]);s.push([e["MatrixWidth"],e["MatrixHeight"]])}}));return new FE({extent:e,origins:o,resolutions:n,matrixIds:i,tileSizes:a,sizes:s})}var kE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var UE=function(t){kE(e,t);function e(e){var r=this;var n=e.imageSmoothing!==undefined?e.imageSmoothing:true;if(e.interpolate!==undefined){n=e.interpolate}var i=e.requestEncoding!==undefined?e.requestEncoding:jE.KVP;var o=e.tileGrid;var a=e.urls;if(a===undefined&&e.url!==undefined){a=SE(e.url)}r=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:n,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:o,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:a,wrapX:e.wrapX!==undefined?e.wrapX:false,transition:e.transition,zDirection:e.zDirection})||this;r.version_=e.version!==undefined?e.version:"1.0.0";r.format_=e.format!==undefined?e.format:"image/jpeg";r.dimensions_=e.dimensions!==undefined?e.dimensions:{};r.layer_=e.layer;r.matrixSet_=e.matrixSet;r.style_=e.style;r.requestEncoding_=i;r.setKey(r.getKeyForDimensions_());if(a&&a.length>0){r.tileUrlFunction=wE(a.map(r.createFromWMTSTemplate.bind(r)))}return r}e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(wE(t.map(this.createFromWMTSTemplate.bind(this))),e)};e.prototype.getDimensions=function(){return this.dimensions_};e.prototype.getFormat=function(){return this.format_};e.prototype.getLayer=function(){return this.layer_};e.prototype.getMatrixSet=function(){return this.matrixSet_};e.prototype.getRequestEncoding=function(){return this.requestEncoding_};e.prototype.getStyle=function(){return this.style_};e.prototype.getVersion=function(){return this.version_};e.prototype.getKeyForDimensions_=function(){var t=0;var e=[];for(var r in this.dimensions_){e[t++]=r+"-"+this.dimensions_[r]}return e.join("/")};e.prototype.updateDimensions=function(t){Object(K["a"])(this.dimensions_,t);this.setKey(this.getKeyForDimensions_())};e.prototype.createFromWMTSTemplate=function(t){var e=this.requestEncoding_;var r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};if(e==jE.KVP){Object(K["a"])(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_})}t=e==jE.KVP?Rm(t,r):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in r?r[e.toLowerCase()]:t}));var n=this.tileGrid;var i=this.dimensions_;return function(r,o,a){if(!r){return undefined}else{var s={TileMatrix:n.getMatrixId(r[0]),TileCol:r[1],TileRow:r[2]};Object(K["a"])(s,i);var u=t;if(e==jE.KVP){u=Rm(u,s)}else{u=u.replace(/\{(\w+?)\}/g,(function(t,e){return s[e]}))}return u}}};return e}(AE);var BE=UE;function zE(t,e){var r=t["Contents"]["Layer"];var n=Object(fn["d"])(r,(function(t,r,n){return t["Identifier"]==e["layer"]}));if(n===null){return null}var i=t["Contents"]["TileMatrixSet"];var o;if(n["TileMatrixSetLink"].length>1){if("projection"in e){o=Object(fn["e"])(n["TileMatrixSetLink"],(function(t,r,n){var o=Object(fn["d"])(i,(function(e){return e["Identifier"]==t["TileMatrixSet"]}));var a=o["SupportedCRS"];var s=jr(a);var u=jr(e["projection"]);if(s&&u){return Wr(s,u)}else{return a==e["projection"]}}))}else{o=Object(fn["e"])(n["TileMatrixSetLink"],(function(t,r,n){return t["TileMatrixSet"]==e["matrixSet"]}))}}else{o=0}if(o<0){o=0}var a=n["TileMatrixSetLink"][o]["TileMatrixSet"];var s=n["TileMatrixSetLink"][o]["TileMatrixSetLimits"];var u=n["Format"][0];if("format"in e){u=e["format"]}o=Object(fn["e"])(n["Style"],(function(t,r,n){if("style"in e){return t["Title"]==e["style"]}else{return t["isDefault"]}}));if(o<0){o=0}var l=n["Style"][o]["Identifier"];var h={};if("Dimension"in n){n["Dimension"].forEach((function(t,e,r){var n=t["Identifier"];var i=t["Default"];if(i===undefined){i=t["Value"][0]}h[n]=i}))}var c=t["Contents"]["TileMatrixSet"];var f=Object(fn["d"])(c,(function(t,e,r){return t["Identifier"]==a}));var p;var d=f["SupportedCRS"];if(d){p=jr(d)}if("projection"in e){var v=jr(e["projection"]);if(v){if(!p||Wr(v,p)){p=v}}}var _=false;var g=p.getAxisOrientation().substr(0,2)=="ne";var y=f.TileMatrix[0];var m={MinTileCol:0,MinTileRow:0,MaxTileCol:y.MatrixWidth-1,MaxTileRow:y.MatrixHeight-1};if(s){m=s[s.length-1];var E=Object(fn["d"])(f.TileMatrix,(function(t){return t.Identifier===m.TileMatrix||f.Identifier+":"+t.Identifier===m.TileMatrix}));if(E){y=E}}var O=y.ScaleDenominator*28e-5/p.getMetersPerUnit();var b=g?[y.TopLeftCorner[1],y.TopLeftCorner[0]]:y.TopLeftCorner;var x=y.TileWidth*O;var w=y.TileHeight*O;var M=f["BoundingBox"];var S=[b[0]+x*m.MinTileCol,b[1]-w*(1+m.MaxTileRow),b[0]+x*(1+m.MaxTileCol),b[1]-w*m.MinTileRow];if(M!==undefined&&!Object(R["g"])(M,S)){var C=n["WGS84BoundingBox"];var T=jr("EPSG:4326").getExtent();S=M;if(C){_=C[0]===T[0]&&C[2]===T[2]}else{var I=Zr(M,f["SupportedCRS"],"EPSG:4326");_=I[0]-1e-10<=T[0]&&I[2]+1e-10>=T[2]}}var P=GE(f,S,s);var L=[];var A=e["requestEncoding"];A=A!==undefined?A:"";if("OperationsMetadata"in t&&"GetTile"in t["OperationsMetadata"]){var j=t["OperationsMetadata"]["GetTile"]["DCP"]["HTTP"]["Get"];for(var N=0,F=j.length;N<F;++N){if(j[N]["Constraint"]){var D=Object(fn["d"])(j[N]["Constraint"],(function(t){return t["name"]=="GetEncoding"}));var G=D["AllowedValues"]["Value"];if(A===""){A=G[0]}if(A===jE.KVP){if(Object(fn["f"])(G,jE.KVP)){L.push(j[N]["href"])}}else{break}}else if(j[N]["href"]){A=jE.KVP;L.push(j[N]["href"])}}}if(L.length===0){A=jE.REST;n["ResourceURL"].forEach((function(t){if(t["resourceType"]==="tile"){u=t["format"];L.push(t["template"])}}))}return{urls:L,layer:e["layer"],matrixSet:a,format:u,projection:p,requestEncoding:A,tileGrid:P,style:l,dimensions:h,wrapX:_,crossOrigin:e["crossOrigin"]}}var YE={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var WE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var VE=function(t){WE(e,t);function e(e){var r=this;var n=e?e:{};var i=Object(K["a"])({},n);delete i.preload;delete i.useInterimTilesOnError;r=t.call(this,i)||this;r.on;r.once;r.un;r.setPreload(n.preload!==undefined?n.preload:0);r.setUseInterimTilesOnError(n.useInterimTilesOnError!==undefined?n.useInterimTilesOnError:true);return r}e.prototype.getPreload=function(){return this.get(YE.PRELOAD)};e.prototype.setPreload=function(t){this.set(YE.PRELOAD,t)};e.prototype.getUseInterimTilesOnError=function(){return this.get(YE.USE_INTERIM_TILES_ON_ERROR)};e.prototype.setUseInterimTilesOnError=function(t){this.set(YE.USE_INTERIM_TILES_ON_ERROR,t)};return e}(tt);var XE=VE;var qE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ZE=function(t){qE(e,t);function e(e){var r=t.call(this,e)||this;r.extentChanged=true;r.renderedExtent_=null;r.renderedPixelRatio;r.renderedProjection=null;r.renderedRevision;r.renderedTiles=[];r.newTiles_=false;r.tmpExtent=Object(R["j"])();r.tmpTileRange_=new aE(0,0,0,0);return r}e.prototype.isDrawableTile=function(t){var e=this.getLayer();var r=t.getState();var n=e.getUseInterimTilesOnError();return r==Ne.LOADED||r==Ne.EMPTY||r==Ne.ERROR&&!n};e.prototype.getTile=function(t,e,r,n){var i=n.pixelRatio;var o=n.viewState.projection;var a=this.getLayer();var s=a.getSource();var u=s.getTile(t,e,r,i,o);if(u.getState()==Ne.ERROR){if(!a.getUseInterimTilesOnError()){u.setState(Ne.LOADED)}else if(a.getPreload()>0){this.newTiles_=true}}if(!this.isDrawableTile(u)){u=u.getInterimTile()}return u};e.prototype.loadedTileCallback=function(e,r,n){if(this.isDrawableTile(n)){return t.prototype.loadedTileCallback.call(this,e,r,n)}return false};e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()};e.prototype.renderFrame=function(t,e){var r=t.layerStatesArray[t.layerIndex];var n=t.viewState;var i=n.projection;var o=n.resolution;var a=n.center;var u=n.rotation;var l=t.pixelRatio;var h=this.getLayer();var c=h.getSource();var f=c.getRevision();var p=c.getTileGridForProjection(i);var d=p.getZForResolution(o,c.zDirection);var v=p.getResolution(d);var g=t.extent;var y=r.extent&&on(r.extent,i);if(y){g=Object(R["A"])(g,on(r.extent,i))}var m=c.getTilePixelRatio(l);var E=Math.round(t.size[0]*m);var b=Math.round(t.size[1]*m);if(u){var x=Math.round(Math.sqrt(E*E+b*b));E=x;b=x}var M=v*E/2/m;var S=v*b/2/m;var T=[a[0]-M,a[1]-S,a[0]+M,a[1]+S];var I=p.getTileRangeForExtentAndZ(g,d);var P={};P[d]={};var L=this.createLoadedTileFinder(c,i,P);var A=this.tmpExtent;var j=this.tmpTileRange_;this.newTiles_=false;for(var N=I.minX;N<=I.maxX;++N){for(var F=I.minY;F<=I.maxY;++F){var D=this.getTile(d,N,F,t);if(this.isDrawableTile(D)){var G=Object(s["c"])(this);if(D.getState()==Ne.LOADED){P[d][D.tileCoord.toString()]=D;var k=D.inTransition(G);if(!this.newTiles_&&(k||this.renderedTiles.indexOf(D)===-1)){this.newTiles_=true}}if(D.getAlpha(G,t.time)===1){continue}}var U=p.getTileCoordChildTileRange(D.tileCoord,j,A);var B=false;if(U){B=L(d+1,U)}if(!B){p.forEachTileCoordParentTileRange(D.tileCoord,L,j,A)}}}var z=v/o;O(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/m,1/m,u,-E/2,-b/2);var Y=C(this.pixelTransform);this.useContainer(e,Y,r.opacity,this.getBackground(t));var W=this.context;var V=W.canvas;w(this.inversePixelTransform,this.pixelTransform);O(this.tempTransform,E/2,b/2,z,z,0,-E/2,-b/2);if(V.width!=E||V.height!=b){V.width=E;V.height=b}else if(!this.containerReused){W.clearRect(0,0,E,b)}if(y){this.clipUnrotated(W,t,y)}if(!c.getInterpolate()){Object(K["a"])(W,lm)}this.preRender(W,t);this.renderedTiles.length=0;var X=Object.keys(P).map(Number);X.sort(fn["i"]);var q,Z,H;if(r.opacity===1&&(!this.containerReused||c.getOpaque(t.viewState.projection))){X=X.reverse()}else{q=[];Z=[]}for(var J=X.length-1;J>=0;--J){var Q=X[J];var $=c.getTilePixelSize(Q,l,i);var tt=p.getResolution(Q);var et=tt/v;var rt=$[0]*et*z;var nt=$[1]*et*z;var it=p.getTileCoordForCoordAndZ(Object(R["B"])(T),Q);var ot=p.getTileCoordExtent(it);var at=_(this.tempTransform,[m*(ot[0]-T[0])/v,m*(T[3]-ot[3])/v]);var st=m*c.getGutterForProjection(i);var ut=P[Q];for(var lt in ut){var D=ut[lt];var ht=D.tileCoord;var ct=it[1]-ht[1];var ft=Math.round(at[0]-(ct-1)*rt);var pt=it[2]-ht[2];var dt=Math.round(at[1]-(pt-1)*nt);var N=Math.round(at[0]-ct*rt);var F=Math.round(at[1]-pt*nt);var vt=ft-N;var _t=dt-F;var gt=d===Q;var k=gt&&D.getAlpha(Object(s["c"])(this),t.time)!==1;if(!k){if(q){W.save();H=[N,F,N+vt,F,N+vt,F+_t,N,F+_t];for(var yt=0,mt=q.length;yt<mt;++yt){if(d!==Q&&Q<Z[yt]){var Et=q[yt];W.beginPath();W.moveTo(H[0],H[1]);W.lineTo(H[2],H[3]);W.lineTo(H[4],H[5]);W.lineTo(H[6],H[7]);W.moveTo(Et[6],Et[7]);W.lineTo(Et[4],Et[5]);W.lineTo(Et[2],Et[3]);W.lineTo(Et[0],Et[1]);W.clip()}}q.push(H);Z.push(Q)}else{W.clearRect(N,F,vt,_t)}}this.drawTileImage(D,t,N,F,vt,_t,st,gt);if(q&&!k){W.restore();this.renderedTiles.unshift(D)}else{this.renderedTiles.push(D)}this.updateUsedTiles(t.usedTiles,c,D)}}this.renderedRevision=f;this.renderedResolution=v;this.extentChanged=!this.renderedExtent_||!Object(R["o"])(this.renderedExtent_,T);this.renderedExtent_=T;this.renderedPixelRatio=l;this.renderedProjection=i;this.manageTilePyramid(t,c,p,l,i,g,d,h.getPreload());this.scheduleExpireCache(t,c);this.postRender(W,t);if(r.extent){W.restore()}Object(K["a"])(W,hm);if(Y!==V.style.transform){V.style.transform=Y}var Ot=Dt(r.opacity);var bt=this.container;if(Ot!==bt.style.opacity){bt.style.opacity=Ot}return this.container};e.prototype.drawTileImage=function(t,e,r,n,i,o,a,u){var l=this.getTileImage(t);if(!l){return}var h=Object(s["c"])(this);var c=u?t.getAlpha(h,e.time):1;var f=c!==this.context.globalAlpha;if(f){this.context.save();this.context.globalAlpha=c}this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,r,n,i,o);if(f){this.context.restore()}if(c!==1){e.animate=true}else if(u){t.endTransition(h)}};e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null};e.prototype.getTileImage=function(t){return t.getImage()};e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var r=function(t,e,r){var n=Object(s["c"])(t);if(n in r.usedTiles){t.expireCache(r.viewState.projection,r.usedTiles[n])}}.bind(null,e);t.postRenderFunctions.push(r)}};e.prototype.updateUsedTiles=function(t,e,r){var n=Object(s["c"])(e);if(!(n in t)){t[n]={}}t[n][r.getKey()]=true};e.prototype.manageTilePyramid=function(t,e,r,n,i,o,a,u,l){var h=Object(s["c"])(e);if(!(h in t.wantedTiles)){t.wantedTiles[h]={}}var c=t.wantedTiles[h];var f=t.tileQueue;var p=r.getMinZoom();var d=0;var v,_,g,y,m,E;for(E=p;E<=a;++E){_=r.getTileRangeForExtentAndZ(o,E,_);g=r.getResolution(E);for(y=_.minX;y<=_.maxX;++y){for(m=_.minY;m<=_.maxY;++m){if(a-E<=u){++d;v=e.getTile(E,y,m,n,i);if(v.getState()==Ne.IDLE){c[v.getKey()]=true;if(!f.isKeyQueued(v.getKey())){f.enqueue([v,h,r.getTileCoordCenter(v.tileCoord),g])}}if(l!==undefined){l(v)}}else{e.useTile(E,y,m,i)}}}}e.updateCacheSize(d,i)};return e}(Yu);ZE.prototype.getLayer;var KE=ZE;var HE=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var JE=function(t){HE(e,t);function e(e){return t.call(this,e)||this}e.prototype.createRenderer=function(){return new KE(this)};return e}(XE);var QE=JE;var $E=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var tO=function(t){$E(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;return r}return e}(tt);var eO=tO;var rO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var nO=function(t){rO(e,t);function e(e){var r=t.call(this,e)||this;r.image_=null;return r}e.prototype.getImage=function(){return!this.image_?null:this.image_.getImage()};e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex];var r=t.pixelRatio;var n=t.viewState;var i=n.resolution;var o=this.getLayer().getSource();var a=t.viewHints;var s=t.extent;if(e.extent!==undefined){s=Object(R["A"])(s,on(e.extent,n.projection))}if(!a[Xe.ANIMATING]&&!a[Xe.INTERACTING]&&!Object(R["G"])(s)){if(o){var u=n.projection;if(!im){var l=o.getProjection();if(l){u=l}}var h=o.getImage(s,i,r,u);if(h&&this.loadImage(h)){this.image_=h}}else{this.image_=null}}return!!this.image_};e.prototype.renderFrame=function(t,e){var r=this.image_;var n=r.getExtent();var i=r.getResolution();var o=r.getPixelRatio();var a=t.layerStatesArray[t.layerIndex];var s=t.pixelRatio;var u=t.viewState;var l=u.center;var h=u.resolution;var c=t.size;var f=s*i/(h*o);var p=Math.round(c[0]*s);var d=Math.round(c[1]*s);var v=u.rotation;if(v){var _=Math.round(Math.sqrt(p*p+d*d));p=_;d=_}O(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,v,-p/2,-d/2);w(this.inversePixelTransform,this.pixelTransform);var g=C(this.pixelTransform);this.useContainer(e,g,a.opacity,this.getBackground(t));var y=this.context;var m=y.canvas;if(m.width!=p||m.height!=d){m.width=p;m.height=d}else if(!this.containerReused){y.clearRect(0,0,p,d)}var E=false;var b=true;if(a.extent){var x=on(a.extent,u.projection);b=Object(R["E"])(x,t.extent);E=b&&!Object(R["g"])(x,t.extent);if(E){this.clipUnrotated(y,t,x)}}var M=r.getImage();var S=O(this.tempTransform,p/2,d/2,f,f,0,o*(n[0]-l[0])/i,o*(l[1]-n[3])/i);this.renderedResolution=i*s/o;var T=M.width*S[0];var I=M.height*S[3];if(!this.getLayer().getSource().getInterpolate()){Object(K["a"])(y,lm)}this.preRender(y,t);if(b&&T>=.5&&I>=.5){var P=S[4];var L=S[5];var A=a.opacity;var j=void 0;if(A!==1){j=y.globalAlpha;y.globalAlpha=A}y.drawImage(M,0,0,+M.width,+M.height,Math.round(P),Math.round(L),Math.round(T),Math.round(I));if(A!==1){y.globalAlpha=j}}this.postRender(y,t);if(E){y.restore()}Object(K["a"])(y,hm);if(g!==m.style.transform){m.style.transform=g}return this.container};return e}(Yu);var iO=nO;var oO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var aO=function(t){oO(e,t);function e(e){return t.call(this,e)||this}e.prototype.createRenderer=function(){return new iO(this)};return e}(eO);var sO=aO;let uO;function lO(){if(!uO){if(!i.themesUrl){throw new Error("Missing constants.themesUrl")}uO=fetch(i.themesUrl).then((t=>t.json()))}return uO}let hO;function cO(){if(!i.localeUrl){return Promise.resolve({})}if(!hO){hO=fetch(i.localeUrl).then((t=>t.json())).then((t=>t[Object.keys(t)[0]]))}return hO}let fO;function pO(){return lO().then((t=>{const e=[];for(const r of t.background_layers){const n=r;if(n.type==="WMTS"){const t=r;e.push(mO(t).then((e=>{e.set("config.name",t.name);return e})))}else if(n.type==="WMS"){const n=r;const i=t.ogcServers[r.ogcServer];e.push(yO(n,i).then((t=>{t.set("config.name",n.name);return t})))}else if(r.children){const n=r.children.slice().reverse();const i=n.map((e=>{const r=e;if(r.type==="WMTS"){const t=r;return mO(t)}else if(r.type==="WMS"){const e=r;return yO(e,t.ogcServers[r.ogcServer])}throw new Error("Unknow layer type")}));const o=Promise.all(i);e.push(o.then((t=>{const e=new ye["default"]({layers:t});e.set("config.name",r.name);return e})))}}return Promise.all(e)}))}const dO=new Map;function vO(){if(!fO){fO=new Promise(((t,e)=>{lO().then((e=>{for(const t of e.themes){_O(t,e.ogcServers)}t(dO)}))}))}return fO}function _O(t,e,r){const n=t;const i=r?r:e[n.ogcServer];if(n.children){for(const t of n.children){_O(t,e,i)}}else{const e=t;dO.set(e.name,{layer:e,ogcServer:i})}}function gO(t){return vO().then((e=>{const r=[];for(const n of t){const t=e.get(n);if(!t){console.error(`Layer not found in themes: ${n}`);continue}const i=t.ogcServer;if(t.layer.type==="WMTS"){const e=t.layer;r.push(mO(e))}else if(t.layer.type==="WMS"&&i){const e=t.layer;r.push(yO(e,i))}}return Promise.all(r)}))}function yO(t,e){const r=new sO({source:new Am({url:e.url,params:{LAYERS:t.layers},serverType:e.type}),minResolution:t.minResolutionHint,maxResolution:t.maxResolutionHint});r.set("config.name",t.name);return cO().then((e=>{r.set("title",e[t.name]||t.name);return r}))}function mO(t){return Promise.all([cO(),OO(t.url)]).then((e=>{const r=e[0];const n=e[1];const i=zE(n,{crossOrigin:"anonymous",layer:t.layer,matrixSet:t.matrixSet});if(!i){console.log(`Missing options for WMTS layer '${t.layer}', `+`with name '${t.name}', `+`from URL '${t.url}'.`);return null}const o=new BE(i);o.updateDimensions(t.dimensions);const a=new QE({preload:Infinity,source:o});a.set("title",r[t.name]||t.name);a.set("config.name",t.name);return a}))}const EO=new Map;function OO(t){if(!EO.has(t)){const e=fetch(t).then((t=>t.text())).then((t=>{const e=new em;return e.read(t)}));EO.set(t,e)}return EO.get(t)}function bO(t,e,r,n,i,o,a){var s,u;var l=(r-e)/n;if(l===1){s=e}else if(l===2){s=e;u=i}else if(l!==0){var h=t[e];var c=t[e+1];var f=0;var p=[0];for(var d=e+n;d<r;d+=n){var v=t[d];var _=t[d+1];f+=Math.sqrt((v-h)*(v-h)+(_-c)*(_-c));p.push(f);h=v;c=_}var g=i*f;var y=Object(fn["a"])(p,g);if(y<0){u=(g-p[-y-2])/(p[-y-1]-p[-y-2]);s=e+(-y-2)*n}else{s=e+y*n}}var m=a>1?a:2;var E=o?o:new Array(m);for(var d=0;d<m;++d){E[d]=s===undefined?NaN:u===undefined?t[s+d]:Object(T["e"])(t[s+d],t[s+n+d],u)}return E}function xO(t,e,r,n,i,o){if(r==e){return null}var a;if(i<t[e+n-1]){if(o){a=t.slice(e,e+n);a[n-1]=i;return a}else{return null}}else if(t[r-1]<i){if(o){a=t.slice(r-n,r);a[n-1]=i;return a}else{return null}}if(i==t[e+n-1]){return t.slice(e,e+n)}var s=e/n;var u=r/n;while(s<u){var l=s+u>>1;if(i<t[(l+1)*n-1]){u=l}else{s=l+1}}var h=t[s*n-1];if(i==h){return t.slice((s-1)*n,(s-1)*n+n)}var c=t[(s+1)*n-1];var f=(i-h)/(c-h);a=[];for(var p=0;p<n-1;++p){a.push(Object(T["e"])(t[(s-1)*n+p],t[s*n+p],f))}a.push(i);return a}function wO(t,e,r,n,i,o,a){if(a){return xO(t,e,r[r.length-1],n,i,o)}var s;if(i<t[n-1]){if(o){s=t.slice(0,n);s[n-1]=i;return s}else{return null}}if(t[t.length-1]<i){if(o){s=t.slice(t.length-n);s[n-1]=i;return s}else{return null}}for(var u=0,l=r.length;u<l;++u){var h=r[u];if(e==h){continue}if(i<t[e+n-1]){return null}else if(i<=t[h-1]){return xO(t,e,h,n,i,false)}e=h}return null}var MO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var SO=function(t){MO(e,t);function e(e,r){var n=t.call(this)||this;n.flatMidpoint_=null;n.flatMidpointRevision_=-1;n.maxDelta_=-1;n.maxDeltaRevision_=-1;if(r!==undefined&&!Array.isArray(e[0])){n.setFlatCoordinates(r,e)}else{n.setCoordinates(e,r)}return n}e.prototype.appendCoordinate=function(t){if(!this.flatCoordinates){this.flatCoordinates=t.slice()}else{Object(fn["c"])(this.flatCoordinates,t)}this.changed()};e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,false,t,e,r,n)};e.prototype.forEachSegment=function(t){return Si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)};e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=Cn.XYM&&this.layout!=Cn.XYZM){return null}var r=e!==undefined?e:false;return xO(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r)};e.prototype.getCoordinates=function(){return ui(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getCoordinateAt=function(t,e){return bO(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)};e.prototype.getLength=function(){return Xu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getFlatMidpoint=function(){if(this.flatMidpointRevision_!=this.getRevision()){this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_);this.flatMidpointRevision_=this.getRevision()}return this.flatMidpoint_};e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];r.length=ti(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0);return new e(r,Cn.XY)};e.prototype.getType=function(){return Ue.LINE_STRING};e.prototype.intersectsExtent=function(t){return Ci(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Hn(this.flatCoordinates,0,t,this.stride);this.changed()};return e}(Bn);var CO=SO;var RO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var TO=function(t){RO(e,t);function e(e,r,n){var i=t.call(this)||this;i.ends_=[];i.maxDelta_=-1;i.maxDeltaRevision_=-1;if(Array.isArray(e[0])){i.setCoordinates(e,r)}else if(r!==undefined&&n){i.setFlatCoordinates(r,e);i.ends_=n}else{var o=i.getLayout();var a=e;var s=[];var u=[];for(var l=0,h=a.length;l<h;++l){var c=a[l];if(l===0){o=c.getLayout()}Object(fn["c"])(s,c.getFlatCoordinates());u.push(s.length)}i.setFlatCoordinates(o,s);i.ends_=u}return i}e.prototype.appendLineString=function(t){if(!this.flatCoordinates){this.flatCoordinates=t.getFlatCoordinates().slice()}else{Object(fn["c"])(this.flatCoordinates,t.getFlatCoordinates().slice())}this.ends_.push(this.flatCoordinates.length);this.changed()};e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Wn(this.flatCoordinates,0,this.ends_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return qn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,false,t,e,r,n)};e.prototype.getCoordinateAtM=function(t,e,r){if(this.layout!=Cn.XYM&&this.layout!=Cn.XYZM||this.flatCoordinates.length===0){return null}var n=e!==undefined?e:false;var i=r!==undefined?r:false;return wO(this.flatCoordinates,0,this.ends_,this.stride,t,n,i)};e.prototype.getCoordinates=function(){return li(this.flatCoordinates,0,this.ends_,this.stride)};e.prototype.getEnds=function(){return this.ends_};e.prototype.getLineString=function(t){if(t<0||this.ends_.length<=t){return null}return new CO(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)};e.prototype.getLineStrings=function(){var t=this.flatCoordinates;var e=this.ends_;var r=this.layout;var n=[];var i=0;for(var o=0,a=e.length;o<a;++o){var s=e[o];var u=new CO(t.slice(i,s),r);n.push(u);i=s}return n};e.prototype.getFlatMidpoints=function(){var t=[];var e=this.flatCoordinates;var r=0;var n=this.ends_;var i=this.stride;for(var o=0,a=n.length;o<a;++o){var s=n[o];var u=bO(e,r,s,i,.5);Object(fn["c"])(t,u);r=s}return t};e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];var n=[];r.length=ei(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,n);return new e(r,Cn.XY,n)};e.prototype.getType=function(){return Ue.MULTI_LINE_STRING};e.prototype.intersectsExtent=function(t){return Ri(this.flatCoordinates,0,this.ends_,this.stride,t)};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2);if(!this.flatCoordinates){this.flatCoordinates=[]}var r=Jn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1];this.changed()};return e}(Bn);var IO=TO;var PO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var LO=function(t){PO(e,t);function e(e,r){var n=t.call(this)||this;if(r&&!Array.isArray(e[0])){n.setFlatCoordinates(r,e)}else{n.setCoordinates(e,r)}return n}e.prototype.appendPoint=function(t){if(!this.flatCoordinates){this.flatCoordinates=t.getFlatCoordinates().slice()}else{Object(fn["c"])(this.flatCoordinates,t.getFlatCoordinates())}this.changed()};e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}var i=this.flatCoordinates;var o=this.stride;for(var a=0,s=i.length;a<s;a+=o){var u=Object(T["j"])(t,e,i[a],i[a+1]);if(u<n){n=u;for(var l=0;l<o;++l){r[l]=i[a+l]}r.length=o}}return n};e.prototype.getCoordinates=function(){return ui(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};e.prototype.getPoint=function(t){var e=!this.flatCoordinates?0:this.flatCoordinates.length/this.stride;if(t<0||e<=t){return null}return new mi(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)};e.prototype.getPoints=function(){var t=this.flatCoordinates;var e=this.layout;var r=this.stride;var n=[];for(var i=0,o=t.length;i<o;i+=r){var a=new mi(t.slice(i,i+r),e);n.push(a)}return n};e.prototype.getType=function(){return Ue.MULTI_POINT};e.prototype.intersectsExtent=function(t){var e=this.flatCoordinates;var r=this.stride;for(var n=0,i=e.length;n<i;n+=r){var o=e[n];var a=e[n+1];if(Object(R["h"])(t,o,a)){return true}}return false};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1);if(!this.flatCoordinates){this.flatCoordinates=[]}this.flatCoordinates.length=Hn(this.flatCoordinates,0,t,this.stride);this.changed()};return e}(Bn);var AO=LO;function jO(t,e,r,n){var i=[];var o=Object(R["j"])();for(var a=0,s=r.length;a<s;++a){var u=r[a];o=Object(R["n"])(t,e,u[0],n);i.push((o[0]+o[2])/2,(o[1]+o[3])/2);e=u[u.length-1]}return i}var NO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var FO=function(t){NO(e,t);function e(e,r,n){var i=t.call(this)||this;i.endss_=[];i.flatInteriorPointsRevision_=-1;i.flatInteriorPoints_=null;i.maxDelta_=-1;i.maxDeltaRevision_=-1;i.orientedRevision_=-1;i.orientedFlatCoordinates_=null;if(!n&&!Array.isArray(e[0])){var o=i.getLayout();var a=e;var s=[];var u=[];for(var l=0,h=a.length;l<h;++l){var c=a[l];if(l===0){o=c.getLayout()}var f=s.length;var p=c.getEnds();for(var d=0,v=p.length;d<v;++d){p[d]+=f}Object(fn["c"])(s,c.getFlatCoordinates());u.push(p)}r=o;e=s;n=u}if(r!==undefined&&n){i.setFlatCoordinates(r,e);i.endss_=n}else{i.setCoordinates(e,r)}return i}e.prototype.appendPolygon=function(t){var e;if(!this.flatCoordinates){this.flatCoordinates=t.getFlatCoordinates().slice();e=t.getEnds().slice();this.endss_.push()}else{var r=this.flatCoordinates.length;Object(fn["c"])(this.flatCoordinates,t.getFlatCoordinates());e=t.getEnds().slice();for(var n=0,i=e.length;n<i;++n){e[n]+=r}}this.endss_.push(e);this.changed()};e.prototype.clone=function(){var t=this.endss_.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=this.endss_[n].slice()}var i=new e(this.flatCoordinates.slice(),this.layout,r);i.applyProperties(this);return i};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}if(this.maxDeltaRevision_!=this.getRevision()){this.maxDelta_=Math.sqrt(Vn(this.flatCoordinates,0,this.endss_,this.stride,0));this.maxDeltaRevision_=this.getRevision()}return Zn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,true,t,e,r,n)};e.prototype.containsXY=function(t,e){return xi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)};e.prototype.getArea=function(){return pi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)};e.prototype.getCoordinates=function(t){var e;if(t!==undefined){e=this.getOrientedFlatCoordinates().slice();Di(e,0,this.endss_,this.stride,t)}else{e=this.flatCoordinates}return hi(e,0,this.endss_,this.stride)};e.prototype.getEndss=function(){return this.endss_};e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=jO(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Mi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t);this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_};e.prototype.getInteriorPoints=function(){return new AO(this.getFlatInteriorPoints().slice(),Cn.XYM)};e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;if(Ni(t,0,this.endss_,this.stride)){this.orientedFlatCoordinates_=t}else{this.orientedFlatCoordinates_=t.slice();this.orientedFlatCoordinates_.length=Di(this.orientedFlatCoordinates_,0,this.endss_,this.stride)}this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];var n=[];r.length=si(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),r,0,n);return new e(r,Cn.XY,n)};e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t){return null}var e;if(t===0){e=0}else{var r=this.endss_[t-1];e=r[r.length-1]}var n=this.endss_[t].slice();var i=n[n.length-1];if(e!==0){for(var o=0,a=n.length;o<a;++o){n[o]-=e}}return new Ui(this.flatCoordinates.slice(e,i),this.layout,n)};e.prototype.getPolygons=function(){var t=this.layout;var e=this.flatCoordinates;var r=this.endss_;var n=[];var i=0;for(var o=0,a=r.length;o<a;++o){var s=r[o].slice();var u=s[s.length-1];if(i!==0){for(var l=0,h=s.length;l<h;++l){s[l]-=i}}var c=new Ui(e.slice(i,u),t,s);n.push(c);i=u}return n};e.prototype.getType=function(){return Ue.MULTI_POLYGON};e.prototype.intersectsExtent=function(t){return Pi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)};e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3);if(!this.flatCoordinates){this.flatCoordinates=[]}var r=Qn(this.flatCoordinates,0,t,this.stride,this.endss_);if(r.length===0){this.flatCoordinates.length=0}else{var n=r[r.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()};return e}(Bn);var DO=FO;var GO=function(){function t(){this.dataProjection=undefined;this.defaultFeatureProjection=undefined;this.supportedMediaTypes=null}t.prototype.getReadOptions=function(t,e){var r;if(e){var n=e.dataProjection?jr(e.dataProjection):this.readProjection(t);if(e.extent&&n&&n.getUnits()===Ve.TILE_PIXELS){n=jr(n);n.setWorldExtent(e.extent)}r={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(r)};t.prototype.adaptOptions=function(t){return Object(K["a"])({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)};t.prototype.getType=function(){return Object(s["b"])()};t.prototype.readFeature=function(t,e){return Object(s["b"])()};t.prototype.readFeatures=function(t,e){return Object(s["b"])()};t.prototype.readGeometry=function(t,e){return Object(s["b"])()};t.prototype.readProjection=function(t){return Object(s["b"])()};t.prototype.writeFeature=function(t,e){return Object(s["b"])()};t.prototype.writeFeatures=function(t,e){return Object(s["b"])()};t.prototype.writeGeometry=function(t,e){return Object(s["b"])()};return t}();var kO=GO;function UO(t,e,r){var n=r?jr(r.featureProjection):null;var i=r?jr(r.dataProjection):null;var o;if(n&&i&&!Wr(n,i)){o=(e?t.clone():t).transform(e?n:i,e?i:n)}else{o=t}if(e&&r&&r.decimals!==undefined){var a=Math.pow(10,r.decimals);var s=function(t){for(var e=0,r=t.length;e<r;++e){t[e]=Math.round(t[e]*a)/a}return t};if(o===t){o=t.clone()}o.applyTransform(s)}return o}function BO(t,e){var r=e?jr(e.featureProjection):null;var n=e?jr(e.dataProjection):null;if(r&&n&&!Wr(r,n)){return Zr(t,n,r)}else{return t}}var zO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var YO=function(t){zO(e,t);function e(){var e=t.call(this)||this;e.xmlSerializer_=Cg();return e}e.prototype.getType=function(){return Zs.XML};e.prototype.readFeature=function(t,e){if(!t){return null}else if(typeof t==="string"){var r=lg(t);return this.readFeatureFromDocument(r,e)}else if(sg(t)){return this.readFeatureFromDocument(t,e)}else{return this.readFeatureFromNode(t,e)}};e.prototype.readFeatureFromDocument=function(t,e){var r=this.readFeaturesFromDocument(t,e);if(r.length>0){return r[0]}else{return null}};e.prototype.readFeatureFromNode=function(t,e){return null};e.prototype.readFeatures=function(t,e){if(!t){return[]}else if(typeof t==="string"){var r=lg(t);return this.readFeaturesFromDocument(r,e)}else if(sg(t)){return this.readFeaturesFromDocument(t,e)}else{return this.readFeaturesFromNode(t,e)}};e.prototype.readFeaturesFromDocument=function(t,e){var r=[];for(var n=t.firstChild;n;n=n.nextSibling){if(n.nodeType==Node.ELEMENT_NODE){Object(fn["c"])(r,this.readFeaturesFromNode(n,e))}}return r};e.prototype.readFeaturesFromNode=function(t,e){return Object(s["b"])()};e.prototype.readGeometry=function(t,e){if(!t){return null}else if(typeof t==="string"){var r=lg(t);return this.readGeometryFromDocument(r,e)}else if(sg(t)){return this.readGeometryFromDocument(t,e)}else{return this.readGeometryFromNode(t,e)}};e.prototype.readGeometryFromDocument=function(t,e){return null};e.prototype.readGeometryFromNode=function(t,e){return null};e.prototype.readProjection=function(t){if(!t){return null}else if(typeof t==="string"){var e=lg(t);return this.readProjectionFromDocument(e)}else if(sg(t)){return this.readProjectionFromDocument(t)}else{return this.readProjectionFromNode(t)}};e.prototype.readProjectionFromDocument=function(t){return this.dataProjection};e.prototype.readProjectionFromNode=function(t){return this.dataProjection};e.prototype.writeFeature=function(t,e){var r=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(r)};e.prototype.writeFeatureNode=function(t,e){return null};e.prototype.writeFeatures=function(t,e){var r=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(r)};e.prototype.writeFeaturesNode=function(t,e){return null};e.prototype.writeGeometry=function(t,e){var r=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(r)};e.prototype.writeGeometryNode=function(t,e){return null};return e}(kO);var WO=YO;var VO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var XO="http://www.opengis.net/gml";var qO=/^[\s\xa0]*$/;var ZO=function(t){VO(e,t);function e(e){var r=t.call(this)||this;var n=e?e:{};r.featureType=n.featureType;r.featureNS=n.featureNS;r.srsName=n.srsName;r.schemaLocation="";r.FEATURE_COLLECTION_PARSERS={};r.FEATURE_COLLECTION_PARSERS[r.namespace]={featureMember:cg(r.readFeaturesInternal),featureMembers:fg(r.readFeaturesInternal)};r.supportedMediaTypes=["application/gml+xml"];return r}e.prototype.readFeaturesInternal=function(t,e){var r=t.localName;var n=null;if(r=="FeatureCollection"){n=bg([],this.FEATURE_COLLECTION_PARSERS,t,e,this)}else if(r=="featureMembers"||r=="featureMember"||r=="member"){var i=e[0];var o=i["featureType"];var a=i["featureNS"];var s="p";var u="p0";if(!o&&t.childNodes){o=[],a={};for(var l=0,h=t.childNodes.length;l<h;++l){var c=t.childNodes[l];if(c.nodeType===1){var f=c.nodeName.split(":").pop();if(o.indexOf(f)===-1){var p="";var d=0;var v=c.namespaceURI;for(var _ in a){if(a[_]===v){p=_;break}++d}if(!p){p=s+d;a[p]=v}o.push(p+":"+f)}}}if(r!="featureMember"){i["featureType"]=o;i["featureNS"]=a}}if(typeof a==="string"){var g=a;a={};a[u]=g}var y={};var m=Array.isArray(o)?o:[o];for(var E in a){var O={};for(var l=0,h=m.length;l<h;++l){var b=m[l].indexOf(":")===-1?u:m[l].split(":")[0];if(b===E){O[m[l].split(":").pop()]=r=="featureMembers"?cg(this.readFeatureElement,this):fg(this.readFeatureElement,this)}}y[a[E]]=O}if(r=="featureMember"||r=="member"){n=bg(undefined,y,t,e)}else{n=bg([],y,t,e)}}if(n===null){n=[]}return n};e.prototype.readGeometryElement=function(t,e){var r=e[0];r["srsName"]=t.firstElementChild.getAttribute("srsName");r["srsDimension"]=t.firstElementChild.getAttribute("srsDimension");var n=bg(null,this.GEOMETRY_PARSERS,t,e,this);if(n){if(Array.isArray(n)){return BO(n,r)}else{return UO(n,false,r)}}else{return undefined}};e.prototype.readFeatureElementInternal=function(t,e,r){var n;var i={};for(var o=t.firstElementChild;o;o=o.nextElementSibling){var a=void 0;var s=o.localName;if(o.childNodes.length===0||o.childNodes.length===1&&(o.firstChild.nodeType===3||o.firstChild.nodeType===4)){a=og(o,false);if(qO.test(a)){a=undefined}}else{if(r){a=this.readGeometryElement(o,e)}if(!a){a=this.readFeatureElementInternal(o,e,false)}else if(s!=="boundedBy"){n=s}}if(i[s]){if(!(i[s]instanceof Array)){i[s]=[i[s]]}i[s].push(a)}else{i[s]=a}var u=o.attributes.length;if(u>0){i[s]={_content_:i[s]};for(var l=0;l<u;l++){var h=o.attributes[l].name;i[s][h]=o.attributes[l].value}}}if(!r){return i}else{var c=new Xa(i);if(n){c.setGeometryName(n)}var f=t.getAttribute("fid")||ug(t,this.namespace,"id");if(f){c.setId(f)}return c}};e.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,true)};e.prototype.readPoint=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);if(r){return new mi(r,Cn.XYZ)}};e.prototype.readMultiPoint=function(t,e){var r=bg([],this.MULTIPOINT_PARSERS,t,e,this);if(r){return new AO(r)}else{return undefined}};e.prototype.readMultiLineString=function(t,e){var r=bg([],this.MULTILINESTRING_PARSERS,t,e,this);if(r){return new IO(r)}};e.prototype.readMultiPolygon=function(t,e){var r=bg([],this.MULTIPOLYGON_PARSERS,t,e,this);if(r){return new DO(r)}};e.prototype.pointMemberParser=function(t,e){Og(this.POINTMEMBER_PARSERS,t,e,this)};e.prototype.lineStringMemberParser=function(t,e){Og(this.LINESTRINGMEMBER_PARSERS,t,e,this)};e.prototype.polygonMemberParser=function(t,e){Og(this.POLYGONMEMBER_PARSERS,t,e,this)};e.prototype.readLineString=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);if(r){var n=new CO(r,Cn.XYZ);return n}else{return undefined}};e.prototype.readFlatLinearRing=function(t,e){var r=bg(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);if(r){return r}else{return undefined}};e.prototype.readLinearRing=function(t,e){var r=this.readFlatCoordinatesFromNode(t,e);if(r){return new _i(r,Cn.XYZ)}};e.prototype.readPolygon=function(t,e){var r=bg([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(r&&r[0]){var n=r[0];var i=[n.length];var o=void 0,a=void 0;for(o=1,a=r.length;o<a;++o){Object(fn["c"])(n,r[o]);i.push(n.length)}return new Ui(n,Cn.XYZ,i)}else{return undefined}};e.prototype.readFlatCoordinatesFromNode=function(t,e){return bg(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)};e.prototype.readGeometryFromNode=function(t,e){var r=this.readGeometryElement(t,[this.getReadOptions(t,e?e:{})]);return r?r:null};e.prototype.readFeaturesFromNode=function(t,e){var r={featureType:this.featureType,featureNS:this.featureNS};if(e){Object(K["a"])(r,this.getReadOptions(t,e))}var n=this.readFeaturesInternal(t,[r]);return n||[]};e.prototype.readProjectionFromNode=function(t){return jr(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))};return e}(WO);ZO.prototype.namespace=XO;ZO.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};ZO.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};ZO.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};ZO.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:cg(ZO.prototype.pointMemberParser),pointMembers:cg(ZO.prototype.pointMemberParser)}};ZO.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:cg(ZO.prototype.lineStringMemberParser),lineStringMembers:cg(ZO.prototype.lineStringMemberParser)}};ZO.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:cg(ZO.prototype.polygonMemberParser),polygonMembers:cg(ZO.prototype.polygonMemberParser)}};ZO.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:cg(ZO.prototype.readFlatCoordinatesFromNode)}};ZO.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:cg(ZO.prototype.readLineString)}};ZO.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:cg(ZO.prototype.readPolygon)}};ZO.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:fg(ZO.prototype.readFlatLinearRing)}};var KO=ZO;var HO=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var JO=XO+" http://schemas.opengis.net/gml/2.1.2/feature.xsd";var QO={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};var $O=function(t){HO(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;r.FEATURE_COLLECTION_PARSERS[XO]["featureMember"]=cg(r.readFeaturesInternal);r.schemaLocation=n.schemaLocation?n.schemaLocation:JO;return r}e.prototype.readFlatCoordinates=function(t,e){var r=og(t,false).replace(/^\s*|\s*$/g,"");var n=e[0];var i=n["srsName"];var o="enu";if(i){var a=jr(i);if(a){o=a.getAxisOrientation()}}var s=r.trim().split(/\s+/);var u=[];for(var l=0,h=s.length;l<h;l++){var c=s[l].split(/,+/);var f=parseFloat(c[0]);var p=parseFloat(c[1]);var d=c.length===3?parseFloat(c[2]):0;if(o.substr(0,2)==="en"){u.push(f,p,d)}else{u.push(p,f,d)}}return u};e.prototype.readBox=function(t,e){var r=bg([null],this.BOX_PARSERS_,t,e,this);return Object(R["k"])(r[1][0],r[1][1],r[1][3],r[1][4])};e.prototype.innerBoundaryIsParser=function(t,e){var r=bg(undefined,this.RING_PARSERS,t,e,this);if(r){var n=e[e.length-1];n.push(r)}};e.prototype.outerBoundaryIsParser=function(t,e){var r=bg(undefined,this.RING_PARSERS,t,e,this);if(r){var n=e[e.length-1];n[0]=r}};e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1];var i=n["multiSurface"];var o=n["surface"];var a=n["multiCurve"];var s;if(!Array.isArray(t)){s=t.getType();if(s==="MultiPolygon"&&i===true){s="MultiSurface"}else if(s==="Polygon"&&o===true){s="Surface"}else if(s==="MultiLineString"&&a===true){s="MultiCurve"}}else{s="Envelope"}return ig("http://www.opengis.net/gml",s)};e.prototype.writeFeatureElement=function(t,e,r){var n=e.getId();if(n){t.setAttribute("fid",n)}var i=r[r.length-1];var o=i["featureNS"];var a=e.getGeometryName();if(!i.serializers){i.serializers={};i.serializers[o]={}}var s=[];var u=[];if(e.hasProperties()){var l=e.getProperties();for(var h in l){var c=l[h];if(c!==null){s.push(h);u.push(c);if(h==a||typeof c.getSimplifiedGeometry==="function"){if(!(h in i.serializers[o])){i.serializers[o][h]=vg(this.writeGeometryElement,this)}}else{if(!(h in i.serializers[o])){i.serializers[o][h]=vg(Zg)}}}}}var f=Object(K["a"])({},i);f.node=t;wg(f,i.serializers,gg(undefined,o),u,r,s)};e.prototype.writeCurveOrLineString=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(t.nodeName!=="LineStringSegment"&&i){t.setAttribute("srsName",i)}if(t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){var o=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(o);this.writeCoordinates_(o,e,r)}else if(t.nodeName==="Curve"){var a=ig(t.namespaceURI,"segments");t.appendChild(a);this.writeCurveSegments_(a,e,r)}};e.prototype.writeLineStringOrCurveMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);if(n){t.appendChild(n);this.writeCurveOrLineString(n,e,r)}};e.prototype.writeMultiCurveOrLineString=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];var a=n["curve"];if(o){t.setAttribute("srsName",o)}var s=e.getLineStrings();wg({node:t,hasZ:i,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,undefined,this)};e.prototype.writeGeometryElement=function(t,e,r){var n=r[r.length-1];var i=Object(K["a"])({},n);i["node"]=t;var o;if(Array.isArray(e)){o=BO(e,n)}else{o=UO(e,true,n)}wg(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],r,undefined,this)};e.prototype.createCoordinatesNode_=function(t){var e=ig(t,"coordinates");e.setAttribute("decimal",".");e.setAttribute("cs",",");e.setAttribute("ts"," ");return e};e.prototype.writeCoordinates_=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];var a=e.getCoordinates();var s=a.length;var u=new Array(s);for(var l=0;l<s;++l){var h=a[l];u[l]=this.getCoords_(h,o,i)}Zg(t,u.join(" "))};e.prototype.writeCurveSegments_=function(t,e,r){var n=ig(t.namespaceURI,"LineStringSegment");t.appendChild(n);this.writeCurveOrLineString(n,e,r)};e.prototype.writeSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];if(t.nodeName!=="PolygonPatch"&&o){t.setAttribute("srsName",o)}if(t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){var a=e.getLinearRings();wg({node:t,hasZ:i,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,undefined,this)}else if(t.nodeName==="Surface"){var s=ig(t.namespaceURI,"patches");t.appendChild(s);this.writeSurfacePatches_(s,e,r)}};e.prototype.RING_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1];var i=n.node;var o=n["exteriorWritten"];if(o===undefined){n["exteriorWritten"]=true}return ig(i.namespaceURI,o!==undefined?"innerBoundaryIs":"outerBoundaryIs")};e.prototype.writeSurfacePatches_=function(t,e,r){var n=ig(t.namespaceURI,"PolygonPatch");t.appendChild(n);this.writeSurfaceOrPolygon(n,e,r)};e.prototype.writeRing=function(t,e,r){var n=ig(t.namespaceURI,"LinearRing");t.appendChild(n);this.writeLinearRing(n,e,r)};e.prototype.getCoords_=function(t,e,r){var n="enu";if(e){n=jr(e).getAxisOrientation()}var i=n.substr(0,2)==="en"?t[0]+","+t[1]:t[1]+","+t[0];if(r){var o=t[2]||0;i+=","+o}return i};e.prototype.writePoint=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];if(o){t.setAttribute("srsName",o)}var a=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(a);var s=e.getCoordinates();var u=this.getCoords_(s,o,i);Zg(a,u)};e.prototype.writeMultiPoint=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];if(o){t.setAttribute("srsName",o)}var a=e.getPoints();wg({node:t,hasZ:i,srsName:o},this.POINTMEMBER_SERIALIZERS,gg("pointMember"),a,r,undefined,this)};e.prototype.writePointMember=function(t,e,r){var n=ig(t.namespaceURI,"Point");t.appendChild(n);this.writePoint(n,e,r)};e.prototype.writeLinearRing=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(i){t.setAttribute("srsName",i)}var o=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(o);this.writeCoordinates_(o,e,r)};e.prototype.writeMultiSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];var a=n["surface"];if(o){t.setAttribute("srsName",o)}var s=e.getPolygons();wg({node:t,hasZ:i,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,undefined,this)};e.prototype.writeSurfaceOrPolygonMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);if(n){t.appendChild(n);this.writeSurfaceOrPolygon(n,e,r)}};e.prototype.writeEnvelope=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(i){t.setAttribute("srsName",i)}var o=["lowerCorner","upperCorner"];var a=[e[0]+" "+e[1],e[2]+" "+e[3]];wg({node:t},this.ENVELOPE_SERIALIZERS,yg,a,r,o,this)};e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1].node;return ig("http://www.opengis.net/gml",QO[n.nodeName])};return e}(KO);$O.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:fg($O.prototype.readFlatCoordinates)}};$O.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:$O.prototype.innerBoundaryIsParser,outerBoundaryIs:$O.prototype.outerBoundaryIsParser}};$O.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:cg($O.prototype.readFlatCoordinates)}};$O.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:fg(KO.prototype.readPoint),MultiPoint:fg(KO.prototype.readMultiPoint),LineString:fg(KO.prototype.readLineString),MultiLineString:fg(KO.prototype.readMultiLineString),LinearRing:fg(KO.prototype.readLinearRing),Polygon:fg(KO.prototype.readPolygon),MultiPolygon:fg(KO.prototype.readMultiPolygon),Box:fg($O.prototype.readBox)}};$O.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:vg($O.prototype.writeCurveOrLineString),MultiCurve:vg($O.prototype.writeMultiCurveOrLineString),Point:vg($O.prototype.writePoint),MultiPoint:vg($O.prototype.writeMultiPoint),LineString:vg($O.prototype.writeCurveOrLineString),MultiLineString:vg($O.prototype.writeMultiCurveOrLineString),LinearRing:vg($O.prototype.writeLinearRing),Polygon:vg($O.prototype.writeSurfaceOrPolygon),MultiPolygon:vg($O.prototype.writeMultiSurfaceOrPolygon),Surface:vg($O.prototype.writeSurfaceOrPolygon),MultiSurface:vg($O.prototype.writeMultiSurfaceOrPolygon),Envelope:vg($O.prototype.writeEnvelope)}};$O.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:vg($O.prototype.writeLineStringOrCurveMember),curveMember:vg($O.prototype.writeLineStringOrCurveMember)}};$O.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:vg($O.prototype.writeRing),innerBoundaryIs:vg($O.prototype.writeRing)}};$O.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:vg($O.prototype.writePointMember)}};$O.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:vg($O.prototype.writeSurfaceOrPolygonMember),polygonMember:vg($O.prototype.writeSurfaceOrPolygonMember)}};$O.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:vg(Zg),upperCorner:vg(Zg)}};var tb=$O;var eb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var rb=XO+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/"+"1.0.0/gmlsf.xsd";var nb={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};var ib=function(t){eb(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;r.surface_=n.surface!==undefined?n.surface:false;r.curve_=n.curve!==undefined?n.curve:false;r.multiCurve_=n.multiCurve!==undefined?n.multiCurve:true;r.multiSurface_=n.multiSurface!==undefined?n.multiSurface:true;r.schemaLocation=n.schemaLocation?n.schemaLocation:rb;r.hasZ=n.hasZ!==undefined?n.hasZ:false;return r}e.prototype.readMultiCurve=function(t,e){var r=bg([],this.MULTICURVE_PARSERS,t,e,this);if(r){var n=new IO(r);return n}else{return undefined}};e.prototype.readMultiSurface=function(t,e){var r=bg([],this.MULTISURFACE_PARSERS,t,e,this);if(r){return new DO(r)}};e.prototype.curveMemberParser=function(t,e){Og(this.CURVEMEMBER_PARSERS,t,e,this)};e.prototype.surfaceMemberParser=function(t,e){Og(this.SURFACEMEMBER_PARSERS,t,e,this)};e.prototype.readPatch=function(t,e){return bg([null],this.PATCHES_PARSERS,t,e,this)};e.prototype.readSegment=function(t,e){return bg([null],this.SEGMENTS_PARSERS,t,e,this)};e.prototype.readPolygonPatch=function(t,e){return bg([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)};e.prototype.readLineStringSegment=function(t,e){return bg([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)};e.prototype.interiorParser=function(t,e){var r=bg(undefined,this.RING_PARSERS,t,e,this);if(r){var n=e[e.length-1];n.push(r)}};e.prototype.exteriorParser=function(t,e){var r=bg(undefined,this.RING_PARSERS,t,e,this);if(r){var n=e[e.length-1];n[0]=r}};e.prototype.readSurface=function(t,e){var r=bg([null],this.SURFACE_PARSERS,t,e,this);if(r&&r[0]){var n=r[0];var i=[n.length];var o=void 0,a=void 0;for(o=1,a=r.length;o<a;++o){Object(fn["c"])(n,r[o]);i.push(n.length)}return new Ui(n,Cn.XYZ,i)}else{return undefined}};e.prototype.readCurve=function(t,e){var r=bg([null],this.CURVE_PARSERS,t,e,this);if(r){var n=new CO(r,Cn.XYZ);return n}else{return undefined}};e.prototype.readEnvelope=function(t,e){var r=bg([null],this.ENVELOPE_PARSERS,t,e,this);return Object(R["k"])(r[1][0],r[1][1],r[2][0],r[2][1])};e.prototype.readFlatPos=function(t,e){var r=og(t,false);var n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/;var i=[];var o;while(o=n.exec(r)){i.push(parseFloat(o[1]));r=r.substr(o[0].length)}if(r!==""){return undefined}var a=e[0];var s=a["srsName"];var u="enu";if(s){var l=jr(s);u=l.getAxisOrientation()}if(u==="neu"){var h=void 0,c=void 0;for(h=0,c=i.length;h<c;h+=3){var f=i[h];var p=i[h+1];i[h]=p;i[h+1]=f}}var d=i.length;if(d==2){i.push(0)}if(d===0){return undefined}return i};e.prototype.readFlatPosList=function(t,e){var r=og(t,false).replace(/^\s*|\s*$/g,"");var n=e[0];var i=n["srsName"];var o=n["srsDimension"];var a="enu";if(i){var s=jr(i);a=s.getAxisOrientation()}var u=r.split(/\s+/);var l=2;if(t.getAttribute("srsDimension")){l=Bg(t.getAttribute("srsDimension"))}else if(t.getAttribute("dimension")){l=Bg(t.getAttribute("dimension"))}else if(t.parentNode.getAttribute("srsDimension")){l=Bg(t.parentNode.getAttribute("srsDimension"))}else if(o){l=Bg(o)}var h,c,f;var p=[];for(var d=0,v=u.length;d<v;d+=l){h=parseFloat(u[d]);c=parseFloat(u[d+1]);f=l===3?parseFloat(u[d+2]):0;if(a.substr(0,2)==="en"){p.push(h,c,f)}else{p.push(c,h,f)}}return p};e.prototype.writePos_=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=i?"3":"2";t.setAttribute("srsDimension",o);var a=n["srsName"];var s="enu";if(a){s=jr(a).getAxisOrientation()}var u=e.getCoordinates();var l;if(s.substr(0,2)==="en"){l=u[0]+" "+u[1]}else{l=u[1]+" "+u[0]}if(i){var h=u[2]||0;l+=" "+h}Zg(t,l)};e.prototype.getCoords_=function(t,e,r){var n="enu";if(e){n=jr(e).getAxisOrientation()}var i=n.substr(0,2)==="en"?t[0]+" "+t[1]:t[1]+" "+t[0];if(r){var o=t[2]||0;i+=" "+o}return i};e.prototype.writePosList_=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=i?"3":"2";t.setAttribute("srsDimension",o);var a=n["srsName"];var s=e.getCoordinates();var u=s.length;var l=new Array(u);var h;for(var c=0;c<u;++c){h=s[c];l[c]=this.getCoords_(h,a,i)}Zg(t,l.join(" "))};e.prototype.writePoint=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(i){t.setAttribute("srsName",i)}var o=ig(t.namespaceURI,"pos");t.appendChild(o);this.writePos_(o,e,r)};e.prototype.writeEnvelope=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(i){t.setAttribute("srsName",i)}var o=["lowerCorner","upperCorner"];var a=[e[0]+" "+e[1],e[2]+" "+e[3]];wg({node:t},this.ENVELOPE_SERIALIZERS,yg,a,r,o,this)};e.prototype.writeLinearRing=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(i){t.setAttribute("srsName",i)}var o=ig(t.namespaceURI,"posList");t.appendChild(o);this.writePosList_(o,e,r)};e.prototype.RING_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1];var i=n.node;var o=n["exteriorWritten"];if(o===undefined){n["exteriorWritten"]=true}return ig(i.namespaceURI,o!==undefined?"interior":"exterior")};e.prototype.writeSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];if(t.nodeName!=="PolygonPatch"&&o){t.setAttribute("srsName",o)}if(t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){var a=e.getLinearRings();wg({node:t,hasZ:i,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,undefined,this)}else if(t.nodeName==="Surface"){var s=ig(t.namespaceURI,"patches");t.appendChild(s);this.writeSurfacePatches_(s,e,r)}};e.prototype.writeCurveOrLineString=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];if(t.nodeName!=="LineStringSegment"&&i){t.setAttribute("srsName",i)}if(t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){var o=ig(t.namespaceURI,"posList");t.appendChild(o);this.writePosList_(o,e,r)}else if(t.nodeName==="Curve"){var a=ig(t.namespaceURI,"segments");t.appendChild(a);this.writeCurveSegments_(a,e,r)}};e.prototype.writeMultiSurfaceOrPolygon=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];var a=n["surface"];if(o){t.setAttribute("srsName",o)}var s=e.getPolygons();wg({node:t,hasZ:i,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,undefined,this)};e.prototype.writeMultiPoint=function(t,e,r){var n=r[r.length-1];var i=n["srsName"];var o=n["hasZ"];if(i){t.setAttribute("srsName",i)}var a=e.getPoints();wg({node:t,hasZ:o,srsName:i},this.POINTMEMBER_SERIALIZERS,gg("pointMember"),a,r,undefined,this)};e.prototype.writeMultiCurveOrLineString=function(t,e,r){var n=r[r.length-1];var i=n["hasZ"];var o=n["srsName"];var a=n["curve"];if(o){t.setAttribute("srsName",o)}var s=e.getLineStrings();wg({node:t,hasZ:i,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,s,r,undefined,this)};e.prototype.writeRing=function(t,e,r){var n=ig(t.namespaceURI,"LinearRing");t.appendChild(n);this.writeLinearRing(n,e,r)};e.prototype.writeSurfaceOrPolygonMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);if(n){t.appendChild(n);this.writeSurfaceOrPolygon(n,e,r)}};e.prototype.writePointMember=function(t,e,r){var n=ig(t.namespaceURI,"Point");t.appendChild(n);this.writePoint(n,e,r)};e.prototype.writeLineStringOrCurveMember=function(t,e,r){var n=this.GEOMETRY_NODE_FACTORY_(e,r);if(n){t.appendChild(n);this.writeCurveOrLineString(n,e,r)}};e.prototype.writeSurfacePatches_=function(t,e,r){var n=ig(t.namespaceURI,"PolygonPatch");t.appendChild(n);this.writeSurfaceOrPolygon(n,e,r)};e.prototype.writeCurveSegments_=function(t,e,r){var n=ig(t.namespaceURI,"LineStringSegment");t.appendChild(n);this.writeCurveOrLineString(n,e,r)};e.prototype.writeGeometryElement=function(t,e,r){var n=r[r.length-1];var i=Object(K["a"])({},n);i["node"]=t;var o;if(Array.isArray(e)){o=BO(e,n)}else{o=UO(e,true,n)}wg(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],r,undefined,this)};e.prototype.writeFeatureElement=function(t,e,r){var n=e.getId();if(n){t.setAttribute("fid",n)}var i=r[r.length-1];var o=i["featureNS"];var a=e.getGeometryName();if(!i.serializers){i.serializers={};i.serializers[o]={}}var s=[];var u=[];if(e.hasProperties()){var l=e.getProperties();for(var h in l){var c=l[h];if(c!==null){s.push(h);u.push(c);if(h==a||typeof c.getSimplifiedGeometry==="function"){if(!(h in i.serializers[o])){i.serializers[o][h]=vg(this.writeGeometryElement,this)}}else{if(!(h in i.serializers[o])){i.serializers[o][h]=vg(Zg)}}}}}var f=Object(K["a"])({},i);f.node=t;wg(f,i.serializers,gg(undefined,o),u,r,s)};e.prototype.writeFeatureMembers_=function(t,e,r){var n=r[r.length-1];var i=n["featureType"];var o=n["featureNS"];var a={};a[o]={};a[o][i]=vg(this.writeFeatureElement,this);var s=Object(K["a"])({},n);s.node=t;wg(s,a,gg(i,o),e,r)};e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1].node;return ig(this.namespace,nb[n.nodeName])};e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,r){var n=e[e.length-1];var i=n["multiSurface"];var o=n["surface"];var a=n["curve"];var s=n["multiCurve"];var u;if(!Array.isArray(t)){u=t.getType();if(u==="MultiPolygon"&&i===true){u="MultiSurface"}else if(u==="Polygon"&&o===true){u="Surface"}else if(u==="LineString"&&a===true){u="Curve"}else if(u==="MultiLineString"&&s===true){u="MultiCurve"}}else{u="Envelope"}return ig(this.namespace,u)};e.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var r=ig(this.namespace,"geom");var n={node:r,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};if(e){Object(K["a"])(n,e)}this.writeGeometryElement(r,t,[n]);return r};e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var r=ig(this.namespace,"featureMembers");r.setAttributeNS(ng,"xsi:schemaLocation",this.schemaLocation);var n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};if(e){Object(K["a"])(n,e)}this.writeFeatureMembers_(r,t,[n]);return r};return e}(KO);ib.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:fg(ib.prototype.readFlatPos),posList:fg(ib.prototype.readFlatPosList),coordinates:fg(tb.prototype.readFlatCoordinates)}};ib.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:ib.prototype.interiorParser,exterior:ib.prototype.exteriorParser}};ib.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:fg(KO.prototype.readPoint),MultiPoint:fg(KO.prototype.readMultiPoint),LineString:fg(KO.prototype.readLineString),MultiLineString:fg(KO.prototype.readMultiLineString),LinearRing:fg(KO.prototype.readLinearRing),Polygon:fg(KO.prototype.readPolygon),MultiPolygon:fg(KO.prototype.readMultiPolygon),Surface:fg(ib.prototype.readSurface),MultiSurface:fg(ib.prototype.readMultiSurface),Curve:fg(ib.prototype.readCurve),MultiCurve:fg(ib.prototype.readMultiCurve),Envelope:fg(ib.prototype.readEnvelope)}};ib.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:cg(ib.prototype.curveMemberParser),curveMembers:cg(ib.prototype.curveMemberParser)}};ib.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:cg(ib.prototype.surfaceMemberParser),surfaceMembers:cg(ib.prototype.surfaceMemberParser)}};ib.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:cg(KO.prototype.readLineString),Curve:cg(ib.prototype.readCurve)}};ib.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:cg(KO.prototype.readPolygon),Surface:cg(ib.prototype.readSurface)}};ib.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:fg(ib.prototype.readPatch)}};ib.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:fg(ib.prototype.readSegment)}};ib.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:cg(ib.prototype.readFlatPosList),upperCorner:cg(ib.prototype.readFlatPosList)}};ib.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:fg(ib.prototype.readPolygonPatch)}};ib.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:fg(ib.prototype.readLineStringSegment)}};ib.prototype.writeFeatures;ib.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:vg(ib.prototype.writeRing),interior:vg(ib.prototype.writeRing)}};ib.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:vg(Zg),upperCorner:vg(Zg)}};ib.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:vg(ib.prototype.writeSurfaceOrPolygonMember),polygonMember:vg(ib.prototype.writeSurfaceOrPolygonMember)}};ib.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:vg(ib.prototype.writePointMember)}};ib.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:vg(ib.prototype.writeLineStringOrCurveMember),curveMember:vg(ib.prototype.writeLineStringOrCurveMember)}};ib.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:vg(ib.prototype.writeCurveOrLineString),MultiCurve:vg(ib.prototype.writeMultiCurveOrLineString),Point:vg(ib.prototype.writePoint),MultiPoint:vg(ib.prototype.writeMultiPoint),LineString:vg(ib.prototype.writeCurveOrLineString),MultiLineString:vg(ib.prototype.writeMultiCurveOrLineString),LinearRing:vg(ib.prototype.writeLinearRing),Polygon:vg(ib.prototype.writeSurfaceOrPolygon),MultiPolygon:vg(ib.prototype.writeMultiSurfaceOrPolygon),Surface:vg(ib.prototype.writeSurfaceOrPolygon),MultiSurface:vg(ib.prototype.writeMultiSurfaceOrPolygon),Envelope:vg(ib.prototype.writeEnvelope)}};var ob=ib;var ab=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var sb=function(t){ab(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this,n)||this;r.schemaLocation=n.schemaLocation?n.schemaLocation:r.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd";return r}return e}(ob);sb.prototype.namespace="http://www.opengis.net/gml/3.2";sb.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:fg(ob.prototype.readFlatPos),posList:fg(ob.prototype.readFlatPosList),coordinates:fg(tb.prototype.readFlatCoordinates)}};sb.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:ob.prototype.interiorParser,exterior:ob.prototype.exteriorParser}};sb.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:fg(KO.prototype.readPoint),MultiPoint:fg(KO.prototype.readMultiPoint),LineString:fg(KO.prototype.readLineString),MultiLineString:fg(KO.prototype.readMultiLineString),LinearRing:fg(KO.prototype.readLinearRing),Polygon:fg(KO.prototype.readPolygon),MultiPolygon:fg(KO.prototype.readMultiPolygon),Surface:fg(sb.prototype.readSurface),MultiSurface:fg(ob.prototype.readMultiSurface),Curve:fg(sb.prototype.readCurve),MultiCurve:fg(ob.prototype.readMultiCurve),Envelope:fg(sb.prototype.readEnvelope)}};sb.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:cg(ob.prototype.curveMemberParser),curveMembers:cg(ob.prototype.curveMemberParser)}};sb.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:cg(ob.prototype.surfaceMemberParser),surfaceMembers:cg(ob.prototype.surfaceMemberParser)}};sb.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:cg(KO.prototype.readLineString),Curve:cg(ob.prototype.readCurve)}};sb.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:cg(KO.prototype.readPolygon),Surface:cg(ob.prototype.readSurface)}};sb.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:fg(ob.prototype.readPatch)}};sb.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:fg(ob.prototype.readSegment)}};sb.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:cg(ob.prototype.readFlatPosList),upperCorner:cg(ob.prototype.readFlatPosList)}};sb.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:fg(ob.prototype.readPolygonPatch)}};sb.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:fg(ob.prototype.readLineStringSegment)}};sb.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:cg(KO.prototype.pointMemberParser),pointMembers:cg(KO.prototype.pointMemberParser)}};sb.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:cg(KO.prototype.lineStringMemberParser),lineStringMembers:cg(KO.prototype.lineStringMemberParser)}};sb.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:cg(KO.prototype.polygonMemberParser),polygonMembers:cg(KO.prototype.polygonMemberParser)}};sb.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:cg(KO.prototype.readFlatCoordinatesFromNode)}};sb.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:cg(KO.prototype.readLineString)}};sb.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:cg(KO.prototype.readPolygon)}};sb.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:fg(KO.prototype.readFlatLinearRing)}};sb.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:vg(ob.prototype.writeRing),interior:vg(ob.prototype.writeRing)}};sb.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:vg(Zg),upperCorner:vg(Zg)}};sb.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:vg(ob.prototype.writeSurfaceOrPolygonMember),polygonMember:vg(ob.prototype.writeSurfaceOrPolygonMember)}};sb.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:vg(ob.prototype.writePointMember)}};sb.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:vg(ob.prototype.writeLineStringOrCurveMember),curveMember:vg(ob.prototype.writeLineStringOrCurveMember)}};sb.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:vg(ob.prototype.writeCurveOrLineString),MultiCurve:vg(ob.prototype.writeMultiCurveOrLineString),Point:vg(sb.prototype.writePoint),MultiPoint:vg(ob.prototype.writeMultiPoint),LineString:vg(ob.prototype.writeCurveOrLineString),MultiLineString:vg(ob.prototype.writeMultiCurveOrLineString),LinearRing:vg(ob.prototype.writeLinearRing),Polygon:vg(ob.prototype.writeSurfaceOrPolygon),MultiPolygon:vg(ob.prototype.writeMultiSurfaceOrPolygon),Surface:vg(ob.prototype.writeSurfaceOrPolygon),MultiSurface:vg(ob.prototype.writeMultiSurfaceOrPolygon),Envelope:vg(ob.prototype.writeEnvelope)}};var ub=sb;var lb=function(){function t(t){this.tagName_=t}t.prototype.getTagName=function(){return this.tagName_};return t}();var hb=lb;var cb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var fb=function(t){cb(e,t);function e(e,r){var n=t.call(this,e)||this;n.conditions=r;Object(l["a"])(n.conditions.length>=2,57);return n}return e}(hb);var pb=fb;var db=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var vb=function(t){db(e,t);function e(e){return t.call(this,"And",Array.prototype.slice.call(arguments))||this}return e}(pb);var _b=vb;var gb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var yb=function(t){gb(e,t);function e(e,r,n){var i=t.call(this,"BBOX")||this;i.geometryName=e;i.extent=r;if(r.length!==4){throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])")}i.srsName=n;return i}return e}(hb);var mb=yb;var Eb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ob=function(t){Eb(e,t);function e(e,r,n,i){var o=t.call(this,e)||this;o.geometryName=r||"the_geom";o.geometry=n;o.srsName=i;return o}return e}(hb);var bb=Ob;var xb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var wb=function(t){xb(e,t);function e(e,r,n){return t.call(this,"Contains",e,r,n)||this}return e}(bb);var Mb=wb;var Sb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Cb=function(t){Sb(e,t);function e(e,r,n,i,o){var a=t.call(this,"DWithin",e,r,o)||this;a.distance=n;a.unit=i;return a}return e}(bb);var Rb=Cb;var Tb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ib=function(t){Tb(e,t);function e(e,r,n){return t.call(this,"Disjoint",e,r,n)||this}return e}(bb);var Pb=Ib;var Lb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ab=function(t){Lb(e,t);function e(e,r){var n=t.call(this,e)||this;n.propertyName=r;return n}return e}(hb);var jb=Ab;var Nb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Fb=function(t){Nb(e,t);function e(e,r,n){var i=t.call(this,"During",e)||this;i.begin=r;i.end=n;return i}return e}(jb);var Db=Fb;var Gb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var kb=function(t){Gb(e,t);function e(e,r,n,i){var o=t.call(this,e,r)||this;o.expression=n;o.matchCase=i;return o}return e}(jb);var Ub=kb;var Bb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var zb=function(t){Bb(e,t);function e(e,r,n){return t.call(this,"PropertyIsEqualTo",e,r,n)||this}return e}(Ub);var Yb=zb;var Wb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Vb=function(t){Wb(e,t);function e(e,r){return t.call(this,"PropertyIsGreaterThan",e,r)||this}return e}(Ub);var Xb=Vb;var qb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Zb=function(t){qb(e,t);function e(e,r){return t.call(this,"PropertyIsGreaterThanOrEqualTo",e,r)||this}return e}(Ub);var Kb=Zb;var Hb=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Jb=function(t){Hb(e,t);function e(e,r,n){return t.call(this,"Intersects",e,r,n)||this}return e}(bb);var Qb=Jb;var $b=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var tx=function(t){$b(e,t);function e(e,r,n){var i=t.call(this,"PropertyIsBetween",e)||this;i.lowerBoundary=r;i.upperBoundary=n;return i}return e}(jb);var ex=tx;var rx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var nx=function(t){rx(e,t);function e(e,r,n,i,o,a){var s=t.call(this,"PropertyIsLike",e)||this;s.pattern=r;s.wildCard=n!==undefined?n:"*";s.singleChar=i!==undefined?i:".";s.escapeChar=o!==undefined?o:"!";s.matchCase=a;return s}return e}(jb);var ix=nx;var ox=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var ax=function(t){ox(e,t);function e(e){return t.call(this,"PropertyIsNull",e)||this}return e}(jb);var sx=ax;var ux=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var lx=function(t){ux(e,t);function e(e,r){return t.call(this,"PropertyIsLessThan",e,r)||this}return e}(Ub);var hx=lx;var cx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var fx=function(t){cx(e,t);function e(e,r){return t.call(this,"PropertyIsLessThanOrEqualTo",e,r)||this}return e}(Ub);var px=fx;var dx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var vx=function(t){dx(e,t);function e(e){var r=t.call(this,"Not")||this;r.condition=e;return r}return e}(hb);var _x=vx;var gx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var yx=function(t){gx(e,t);function e(e,r,n){return t.call(this,"PropertyIsNotEqualTo",e,r,n)||this}return e}(Ub);var mx=yx;var Ex=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Ox=function(t){Ex(e,t);function e(e){return t.call(this,"Or",Array.prototype.slice.call(arguments))||this}return e}(pb);var bx=Ox;var xx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var wx=function(t){xx(e,t);function e(e){var r=t.call(this,"ResourceId")||this;r.rid=e;return r}return e}(hb);var Mx=wx;var Sx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Cx=function(t){Sx(e,t);function e(e,r,n){return t.call(this,"Within",e,r,n)||this}return e}(bb);var Rx=Cx;function Tx(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(_b,e))}function Ix(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(bx,e))}function Px(t){return new _x(t)}function Lx(t,e,r){return new mb(t,e,r)}function Ax(t,e,r){return new Mb(t,e,r)}function jx(t,e,r){return new Qb(t,e,r)}function Nx(t,e,r){return new Pb(t,e,r)}function Fx(t,e,r){return new Rx(t,e,r)}function Dx(t,e,r,n,i){return new Rb(t,e,r,n,i)}function Gx(t,e,r){return new Yb(t,e,r)}function kx(t,e,r){return new mx(t,e,r)}function Ux(t,e){return new hx(t,e)}function Bx(t,e){return new px(t,e)}function zx(t,e){return new Xb(t,e)}function Yx(t,e){return new Kb(t,e)}function Wx(t){return new sx(t)}function Vx(t,e,r){return new ex(t,e,r)}function Xx(t,e,r,n,i,o){return new ix(t,e,r,n,i,o)}function qx(t,e,r){return new Db(t,e,r)}function Zx(t){return new Mx(t)}var Kx=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Hx={"http://www.opengis.net/gml":{boundedBy:dg(KO.prototype.readGeometryElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:cg(KO.prototype.readFeaturesInternal)}};var Jx={"http://www.opengis.net/wfs":{totalInserted:dg(Ug),totalUpdated:dg(Ug),totalDeleted:dg(Ug)},"http://www.opengis.net/wfs/2.0":{totalInserted:dg(Ug),totalUpdated:dg(Ug),totalDeleted:dg(Ug)}};var Qx={"http://www.opengis.net/wfs":{TransactionSummary:dg(fw,"transactionSummary"),InsertResults:dg(_w,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:dg(fw,"transactionSummary"),InsertResults:dg(_w,"insertIds")}};var $x={"http://www.opengis.net/wfs":{PropertyName:vg(Zg)},"http://www.opengis.net/wfs/2.0":{PropertyName:vg(Zg)}};var tw={"http://www.opengis.net/wfs":{Insert:vg(gw),Update:vg(Ow),Delete:vg(Ew),Property:vg(bw),Native:vg(xw)},"http://www.opengis.net/wfs/2.0":{Insert:vg(gw),Update:vg(Ow),Delete:vg(Ew),Property:vg(bw),Native:vg(xw)}};var ew="feature";var rw="http://www.w3.org/2000/xmlns/";var nw={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"};var iw={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"};var ow={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"};var aw={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"};var sw={"2.0.0":ub,"1.1.0":ob,"1.0.0":tb};var uw="1.1.0";var lw=function(t){Kx(e,t);function e(e){var r=t.call(this)||this;var n=e?e:{};r.version_=n.version?n.version:uw;r.featureType_=n.featureType;r.featureNS_=n.featureNS;r.gmlFormat_=n.gmlFormat?n.gmlFormat:new sw[r.version_];r.schemaLocation_=n.schemaLocation?n.schemaLocation:aw[r.version_];return r}e.prototype.getFeatureType=function(){return this.featureType_};e.prototype.setFeatureType=function(t){this.featureType_=t};e.prototype.readFeaturesFromNode=function(t,e){var r={node:t};Object(K["a"])(r,{featureType:this.featureType_,featureNS:this.featureNS_});Object(K["a"])(r,this.getReadOptions(t,e?e:{}));var n=[r];var i;if(this.version_==="2.0.0"){i=Hx}else{i=this.gmlFormat_.FEATURE_COLLECTION_PARSERS}var o=bg([],i,t,n,this.gmlFormat_);if(!o){o=[]}return o};e.prototype.readTransactionResponse=function(t){if(!t){return undefined}else if(typeof t==="string"){var e=lg(t);return this.readTransactionResponseFromDocument(e)}else if(sg(t)){return this.readTransactionResponseFromDocument(t)}else{return this.readTransactionResponseFromNode(t)}};e.prototype.readFeatureCollectionMetadata=function(t){if(!t){return undefined}else if(typeof t==="string"){var e=lg(t);return this.readFeatureCollectionMetadataFromDocument(e)}else if(sg(t)){return this.readFeatureCollectionMetadataFromDocument(t)}else{return this.readFeatureCollectionMetadataFromNode(t)}};e.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling){if(e.nodeType==Node.ELEMENT_NODE){return this.readFeatureCollectionMetadataFromNode(e)}}return undefined};e.prototype.readFeatureCollectionMetadataFromNode=function(t){var e={};var r=Bg(t.getAttribute("numberOfFeatures"));e["numberOfFeatures"]=r;return bg(e,Hx,t,[],this.gmlFormat_)};e.prototype.readTransactionResponseFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling){if(e.nodeType==Node.ELEMENT_NODE){return this.readTransactionResponseFromNode(e)}}return undefined};e.prototype.readTransactionResponseFromNode=function(t){return bg({},Qx,t,[])};e.prototype.writeGetFeature=function(t){var e=this;var r=ig(iw[this.version_],"GetFeature");r.setAttribute("service","WFS");r.setAttribute("version",this.version_);if(t.handle){r.setAttribute("handle",t.handle)}if(t.outputFormat){r.setAttribute("outputFormat",t.outputFormat)}if(t.maxFeatures!==undefined){r.setAttribute("maxFeatures",String(t.maxFeatures))}if(t.resultType){r.setAttribute("resultType",t.resultType)}if(t.startIndex!==undefined){r.setAttribute("startIndex",String(t.startIndex))}if(t.count!==undefined){r.setAttribute("count",String(t.count))}if(t.viewParams!==undefined){r.setAttribute("viewParams",t.viewParams)}r.setAttributeNS(ng,"xsi:schemaLocation",this.schemaLocation_);var n={node:r};Object(K["a"])(n,{version:this.version_,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]});Object(l["a"])(Array.isArray(t.featureTypes),11);if(typeof t.featureTypes[0]==="string"){var i=t.filter;if(t.bbox){Object(l["a"])(t.geometryName,12);i=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,i)}Object(K["a"])(n,{geometryName:t.geometryName,filter:i});Yw(r,t.featureTypes,[n])}else{t.featureTypes.forEach((function(i){var o=e.combineBboxAndFilter(i.geometryName,i.bbox,t.srsName,t.filter);Object(K["a"])(n,{geometryName:i.geometryName,filter:o});Yw(r,[i.name],[n])}))}return r};e.prototype.combineBboxAndFilter=function(t,e,r,n){var i=Lx(t,e,r);if(n){return Tx(n,i)}return i};e.prototype.writeTransaction=function(t,e,r,n){var i=[];var o=n.version?n.version:this.version_;var a=ig(iw[o],"Transaction");a.setAttribute("service","WFS");a.setAttribute("version",o);var s;if(n){s=n.gmlOptions?n.gmlOptions:{};if(n.handle){a.setAttribute("handle",n.handle)}}a.setAttributeNS(ng,"xsi:schemaLocation",aw[o]);var u=hw(a,s,o,n);if(t){cw("Insert",t,i,u)}if(e){cw("Update",e,i,u)}if(r){cw("Delete",r,i,u)}if(n.nativeElements){cw("Native",n.nativeElements,i,u)}return a};e.prototype.readProjectionFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling){if(e.nodeType==Node.ELEMENT_NODE){return this.readProjectionFromNode(e)}}return null};e.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild){t=t.firstElementChild.firstElementChild;for(var e=t.firstElementChild;e;e=e.nextElementSibling){if(!(e.childNodes.length===0||e.childNodes.length===1&&e.firstChild.nodeType===3)){var r=[{}];this.gmlFormat_.readGeometryElement(e,r);return jr(r.pop().srsName)}}}return null};return e}(WO);function hw(t,e,r,n){var i=n.featurePrefix?n.featurePrefix:ew;var o;if(r==="1.0.0"){o=2}else if(r==="1.1.0"){o=3}else if(r==="2.0.0"){o=3.2}var a=Object(K["a"])({node:t},{version:r,featureNS:n.featureNS,featureType:n.featureType,featurePrefix:i,gmlVersion:o,hasZ:n.hasZ,srsName:n.srsName},e);return a}function cw(t,e,r,n){wg(n,tw,gg(t),e,r)}function fw(t,e){return bg({},Jx,t,e)}var pw={"http://www.opengis.net/ogc":{FeatureId:cg((function(t,e){return t.getAttribute("fid")}))},"http://www.opengis.net/ogc/1.1":{FeatureId:cg((function(t,e){return t.getAttribute("fid")}))}};function dw(t,e){Og(pw,t,e)}var vw={"http://www.opengis.net/wfs":{Feature:dw},"http://www.opengis.net/wfs/2.0":{Feature:dw}};function _w(t,e){return bg([],vw,t,e)}function gw(t,e,r){var n=r[r.length-1];var i=n["featureType"];var o=n["featureNS"];var a=n["gmlVersion"];var s=ig(o,i);t.appendChild(s);if(a===2){tb.prototype.writeFeatureElement(s,e,r)}else if(a===3){ob.prototype.writeFeatureElement(s,e,r)}else{ub.prototype.writeFeatureElement(s,e,r)}}function yw(t,e,r){var n=r[r.length-1];var i=n["version"];var o=nw[i];var a=ig(o,"Filter");var s=ig(o,"FeatureId");a.appendChild(s);s.setAttribute("fid",e);t.appendChild(a)}function mw(t,e){t=t?t:ew;var r=t+":";if(e.indexOf(r)===0){return e}else{return r+e}}function Ew(t,e,r){var n=r[r.length-1];Object(l["a"])(e.getId()!==undefined,26);var i=n["featureType"];var o=n["featurePrefix"];var a=n["featureNS"];var s=mw(o,i);t.setAttribute("typeName",s);t.setAttributeNS(rw,"xmlns:"+o,a);var u=e.getId();if(u!==undefined){yw(t,u,r)}}function Ow(t,e,r){var n=r[r.length-1];Object(l["a"])(e.getId()!==undefined,27);var i=n["version"];var o=n["featureType"];var a=n["featurePrefix"];var s=n["featureNS"];var u=mw(a,o);var h=e.getGeometryName();t.setAttribute("typeName",u);t.setAttributeNS(rw,"xmlns:"+a,s);var c=e.getId();if(c!==undefined){var f=e.getKeys();var p=[];for(var d=0,v=f.length;d<v;d++){var _=e.get(f[d]);if(_!==undefined){var g=f[d];if(_&&typeof _.getSimplifiedGeometry==="function"){g=h}p.push({name:g,value:_})}}wg({version:i,gmlVersion:n["gmlVersion"],node:t,hasZ:n["hasZ"],srsName:n["srsName"]},tw,gg("Property"),p,r);yw(t,c,r)}}function bw(t,e,r){var n=r[r.length-1];var i=n["version"];var o=iw[i];var a=ig(o,"Name");var s=n["gmlVersion"];t.appendChild(a);Zg(a,e.name);if(e.value!==undefined&&e.value!==null){var u=ig(o,"Value");t.appendChild(u);if(e.value&&typeof e.value.getSimplifiedGeometry==="function"){if(s===2){tb.prototype.writeGeometryElement(u,e.value,r)}else if(s===3){ob.prototype.writeGeometryElement(u,e.value,r)}else{ub.prototype.writeGeometryElement(u,e.value,r)}}else{Zg(u,e.value)}}}function xw(t,e,r){if(e.vendorId){t.setAttribute("vendorId",e.vendorId)}if(e.safeToIgnore!==undefined){t.setAttribute("safeToIgnore",String(e.safeToIgnore))}if(e.value!==undefined){Zg(t,e.value)}}var ww={"http://www.opengis.net/wfs":{Query:vg(Mw)},"http://www.opengis.net/wfs/2.0":{Query:vg(Mw)},"http://www.opengis.net/ogc":{During:vg(Pw),And:vg(Lw),Or:vg(Lw),Not:vg(Aw),BBOX:vg(Cw),Contains:vg(Tw),Intersects:vg(Tw),Within:vg(Tw),DWithin:vg(Iw),PropertyIsEqualTo:vg(jw),PropertyIsNotEqualTo:vg(jw),PropertyIsLessThan:vg(jw),PropertyIsLessThanOrEqualTo:vg(jw),PropertyIsGreaterThan:vg(jw),PropertyIsGreaterThanOrEqualTo:vg(jw),PropertyIsNull:vg(Nw),PropertyIsBetween:vg(Fw),PropertyIsLike:vg(Dw)},"http://www.opengis.net/fes/2.0":{During:vg(Pw),And:vg(Lw),Or:vg(Lw),Not:vg(Aw),BBOX:vg(Cw),Contains:vg(Tw),Disjoint:vg(Tw),Intersects:vg(Tw),ResourceId:vg(Rw),Within:vg(Tw),DWithin:vg(Iw),PropertyIsEqualTo:vg(jw),PropertyIsNotEqualTo:vg(jw),PropertyIsLessThan:vg(jw),PropertyIsLessThanOrEqualTo:vg(jw),PropertyIsGreaterThan:vg(jw),PropertyIsGreaterThanOrEqualTo:vg(jw),PropertyIsNull:vg(Nw),PropertyIsBetween:vg(Fw),PropertyIsLike:vg(Dw)}};function Mw(t,e,r){var n=r[r.length-1];var i=n["version"];var o=n["featurePrefix"];var a=n["featureNS"];var s=n["propertyNames"];var u=n["srsName"];var l;if(o){l=mw(o,e)}else{l=e}var h;if(i==="2.0.0"){h="typeNames"}else{h="typeName"}t.setAttribute(h,l);if(u){t.setAttribute("srsName",u)}if(a){t.setAttributeNS(rw,"xmlns:"+o,a)}var c=Object(K["a"])({},n);c.node=t;wg(c,$x,gg("PropertyName"),s,r);var f=n["filter"];if(f){var p=ig(Ww(i),"Filter");t.appendChild(p);Sw(p,f,r)}}function Sw(t,e,r){var n=r[r.length-1];var i={node:t};Object(K["a"])(i,{context:n});wg(i,ww,gg(e.getTagName()),[e],r)}function Cw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];n["srsName"]=e.srsName;var a=sw[o];Uw(o,t,e.geometryName);a.prototype.writeGeometryElement(t,e.extent,r)}function Rw(t,e,r){t.setAttribute("rid",e.rid)}function Tw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];n["srsName"]=e.srsName;var a=sw[o];Uw(o,t,e.geometryName);a.prototype.writeGeometryElement(t,e.geometry,r)}function Iw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];Tw(t,e,r);var a=ig(Ww(o),"Distance");Zg(a,e.distance.toString());if(o==="2.0.0"){a.setAttribute("uom",e.unit)}else{a.setAttribute("units",e.unit)}t.appendChild(a)}function Pw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];Gw(ow[o],"ValueReference",t,e.propertyName);var a=ig(XO,"TimePeriod");t.appendChild(a);var s=ig(XO,"begin");a.appendChild(s);Bw(s,e.begin);var u=ig(XO,"end");a.appendChild(u);Bw(u,e.end)}function Lw(t,e,r){var n=r[r.length-1];var i=n["context"];var o={node:t};Object(K["a"])(o,{context:i});var a=e.conditions;for(var s=0,u=a.length;s<u;++s){var l=a[s];wg(o,ww,gg(l.getTagName()),[l],r)}}function Aw(t,e,r){var n=r[r.length-1];var i=n["context"];var o={node:t};Object(K["a"])(o,{context:i});var a=e.condition;wg(o,ww,gg(a.getTagName()),[a],r)}function jw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];if(e.matchCase!==undefined){t.setAttribute("matchCase",e.matchCase.toString())}Uw(o,t,e.propertyName);kw(o,t,""+e.expression)}function Nw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];Uw(o,t,e.propertyName)}function Fw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];var a=Ww(o);Uw(o,t,e.propertyName);var s=ig(a,"LowerBoundary");t.appendChild(s);kw(o,s,""+e.lowerBoundary);var u=ig(a,"UpperBoundary");t.appendChild(u);kw(o,u,""+e.upperBoundary)}function Dw(t,e,r){var n=r[r.length-1];var i=n["context"];var o=i["version"];t.setAttribute("wildCard",e.wildCard);t.setAttribute("singleChar",e.singleChar);t.setAttribute("escapeChar",e.escapeChar);if(e.matchCase!==undefined){t.setAttribute("matchCase",e.matchCase.toString())}Uw(o,t,e.propertyName);kw(o,t,""+e.pattern)}function Gw(t,e,r,n){var i=ig(t,e);Zg(i,n);r.appendChild(i)}function kw(t,e,r){Gw(Ww(t),"Literal",e,r)}function Uw(t,e,r){if(t==="2.0.0"){Gw(ow[t],"ValueReference",e,r)}else{Gw(nw[t],"PropertyName",e,r)}}function Bw(t,e){var r=ig(XO,"TimeInstant");t.appendChild(r);var n=ig(XO,"timePosition");r.appendChild(n);Zg(n,e)}function zw(t,e){var r=e||"1.1.0";var n=ig(Ww(r),"Filter");var i={node:n};Object(K["a"])(i,{version:r,filter:t});Sw(n,t,[i]);return n}function Yw(t,e,r){var n=r[r.length-1];var i=Object(K["a"])({},n);i.node=t;wg(i,ww,gg("Query"),e,r)}function Ww(t){var e;if(t==="2.0.0"){e=ow[t]}else{e=nw[t]}return e}var Vw=lw;const Xw=10;function qw(t){return t.layer.type==="WMS"&&!!t.ogcServer.wfsSupport&&!!t.ogcServer.urlWfs}function Zw(t,e){return new Promise(((r,n)=>{vO().then((i=>{let o=[];const a=i.get(t);if(!a){n(`Layer "${t}" was not found in themes.`);return}if(!qw(a)){n(`Layer "${t}" does not support WFS.`);return}const s=a.layer;const u=[];let l=[];for(const t of s.childLayers){u.push(t.name);l=l.concat(e.map((e=>`${t.name}.${e}`)))}const h={FEATUREID:l.join(","),MAXFEATURES:l.length,REQUEST:"GetFeature",SERVICE:"WFS",TYPENAME:u.join(","),VERSION:"1.0.0"};const c=Rm(a.ogcServer.urlWfs,h);fetch(c).then((t=>t.text().then((t=>{const e=new Vw({featureNS:a.ogcServer.namespace,gmlFormat:new tb});o=e.readFeatures(t)})))).catch((t=>{console.error(`WFS GetFeature request failed, response: ${t}`)})).then((()=>{r(o)}))}))}))}function Kw(t,e,r){return new Promise(((n,i)=>{vO().then((o=>{const a=o.get(t);if(!a){i(`Layer "${t}" was not found in themes.`);return}if(!qw(a)){i(`Layer "${t}" does not support WFS.`);return}const s=Object(R["c"])(Object(R["m"])(e),Xw*r);const u={BBOX:s.join(","),MAXFEATURES:1,REQUEST:"GetFeature",SERVICE:"WFS",TYPENAME:t,VERSION:"1.0.0"};const l=Rm(a.ogcServer.urlWfs,u);let h;fetch(l).then((t=>t.text().then((t=>{const e=new Vw({featureNS:a.ogcServer.namespace,gmlFormat:new tb});h=e.readFeature(t)})))).catch((t=>{console.error(`WFS GetFeature request failed, response: ${t}`)})).then((()=>{if(!h){throw new Error("Missing feature")}n(h)}))}))}))}var Hw=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Jw=function(t){Hw(e,t);function e(e){var r=t.call(this)||this;r.geometries_=e?e:null;r.changeEventsKeys_=[];r.listenGeometriesChange_();return r}e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(H["c"]);this.changeEventsKeys_.length=0};e.prototype.listenGeometriesChange_=function(){if(!this.geometries_){return}for(var t=0,e=this.geometries_.length;t<e;++t){this.changeEventsKeys_.push(Object(H["a"])(this.geometries_[t],V["a"].CHANGE,this.changed,this))}};e.prototype.clone=function(){var t=new e(null);t.setGeometries(this.geometries_);t.applyProperties(this);return t};e.prototype.closestPointXY=function(t,e,r,n){if(n<Object(R["e"])(this.getExtent(),t,e)){return n}var i=this.geometries_;for(var o=0,a=i.length;o<a;++o){n=i[o].closestPointXY(t,e,r,n)}return n};e.prototype.containsXY=function(t,e){var r=this.geometries_;for(var n=0,i=r.length;n<i;++n){if(r[n].containsXY(t,e)){return true}}return false};e.prototype.computeExtent=function(t){Object(R["l"])(t);var e=this.geometries_;for(var r=0,n=e.length;r<n;++r){Object(R["p"])(t,e[r].getExtent())}return t};e.prototype.getGeometries=function(){return Qw(this.geometries_)};e.prototype.getGeometriesArray=function(){return this.geometries_};e.prototype.getGeometriesArrayRecursive=function(){var t=[];var e=this.geometries_;for(var r=0,n=e.length;r<n;++r){if(e[r].getType()===this.getType()){t=t.concat(e[r].getGeometriesArrayRecursive())}else{t.push(e[r])}}return t};e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()){this.simplifiedGeometryMaxMinSquaredTolerance=0;this.simplifiedGeometryRevision=this.getRevision()}if(t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance){return this}var r=[];var n=this.geometries_;var i=false;for(var o=0,a=n.length;o<a;++o){var s=n[o];var u=s.getSimplifiedGeometry(t);r.push(u);if(u!==s){i=true}}if(i){var l=new e(null);l.setGeometriesArray(r);return l}else{this.simplifiedGeometryMaxMinSquaredTolerance=t;return this}};e.prototype.getType=function(){return Ue.GEOMETRY_COLLECTION};e.prototype.intersectsExtent=function(t){var e=this.geometries_;for(var r=0,n=e.length;r<n;++r){if(e[r].intersectsExtent(t)){return true}}return false};e.prototype.isEmpty=function(){return this.geometries_.length===0};e.prototype.rotate=function(t,e){var r=this.geometries_;for(var n=0,i=r.length;n<i;++n){r[n].rotate(t,e)}this.changed()};e.prototype.scale=function(t,e,r){var n=r;if(!n){n=Object(R["w"])(this.getExtent())}var i=this.geometries_;for(var o=0,a=i.length;o<a;++o){i[o].scale(t,e,n)}this.changed()};e.prototype.setGeometries=function(t){this.setGeometriesArray(Qw(t))};e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_();this.geometries_=t;this.listenGeometriesChange_();this.changed()};e.prototype.applyTransform=function(t){var e=this.geometries_;for(var r=0,n=e.length;r<n;++r){e[r].applyTransform(t)}this.changed()};e.prototype.translate=function(t,e){var r=this.geometries_;for(var n=0,i=r.length;n<i;++n){r[n].translate(t,e)}this.changed()};e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_();t.prototype.disposeInternal.call(this)};return e}(Nn);function Qw(t){var e=[];for(var r=0,n=t.length;r<n;++r){e.push(t[r].clone())}return e}var $w=Jw;var tM=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var eM=function(t){tM(e,t);function e(){return t.call(this)||this}e.prototype.getType=function(){return Zs.JSON};e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(rM(t),this.getReadOptions(t,e))};e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(rM(t),this.getReadOptions(t,e))};e.prototype.readFeatureFromObject=function(t,e){return Object(s["b"])()};e.prototype.readFeaturesFromObject=function(t,e){return Object(s["b"])()};e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(rM(t),this.getReadOptions(t,e))};e.prototype.readGeometryFromObject=function(t,e){return Object(s["b"])()};e.prototype.readProjection=function(t){return this.readProjectionFromObject(rM(t))};e.prototype.readProjectionFromObject=function(t){return Object(s["b"])()};e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))};e.prototype.writeFeatureObject=function(t,e){return Object(s["b"])()};e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))};e.prototype.writeFeaturesObject=function(t,e){return Object(s["b"])()};e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))};e.prototype.writeGeometryObject=function(t,e){return Object(s["b"])()};return e}(kO);function rM(t){if(typeof t==="string"){var e=JSON.parse(t);return e?e:null}else if(t!==null){return t}else{return null}}var nM=eM;var iM=undefined&&undefined.__extends||function(){var t=function(e,r){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]};return t(e,r)};return function(e,r){if(typeof r!=="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var oM=function(t){iM(e,t);function e(e){var r=this;var n=e?e:{};r=t.call(this)||this;r.dataProjection=jr(n.dataProjection?n.dataProjection:"EPSG:4326");if(n.featureProjection){r.defaultFeatureProjection=jr(n.featureProjection)}r.geometryName_=n.geometryName;r.extractGeometryName_=n.extractGeometryName;r.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"];return r}e.prototype.readFeatureFromObject=function(t,e){var r=null;if(t["type"]==="Feature"){r=t}else{r={type:"Feature",geometry:t,properties:null}}var n=aM(r["geometry"],e);var i=new Xa;if(this.geometryName_){i.setGeometryName(this.geometryName_)}else if(this.extractGeometryName_&&"geometry_name"in r!==undefined){i.setGeometryName(r["geometry_name"])}i.setGeometry(n);if("id"in r){i.setId(r["id"])}if(r["properties"]){i.setProperties(r["properties"],true)}return i};e.prototype.readFeaturesFromObject=function(t,e){var r=t;var n=null;if(r["type"]==="FeatureCollection"){var i=t;n=[];var o=i["features"];for(var a=0,s=o.length;a<s;++a){n.push(this.readFeatureFromObject(o[a],e))}}else{n=[this.readFeatureFromObject(t,e)]}return n};e.prototype.readGeometryFromObject=function(t,e){return aM(t,e)};e.prototype.readProjectionFromObject=function(t){var e=t["crs"];var r;if(e){if(e["type"]=="name"){r=jr(e["properties"]["name"])}else if(e["type"]==="EPSG"){r=jr("EPSG:"+e["properties"]["code"])}else{Object(l["a"])(false,36)}}else{r=this.dataProjection}return r};e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var r={type:"Feature",geometry:null,properties:null};var n=t.getId();if(n!==undefined){r.id=n}if(!t.hasProperties()){return r}var i=t.getProperties();var o=t.getGeometry();if(o){r.geometry=dM(o,e);delete i[t.getGeometryName()]}if(!Object(K["d"])(i)){r.properties=i}return r};e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);var r=[];for(var n=0,i=t.length;n<i;++n){r.push(this.writeFeatureObject(t[n],e))}return{type:"FeatureCollection",features:r}};e.prototype.writeGeometryObject=function(t,e){return dM(t,this.adaptOptions(e))};return e}(nM);function aM(t,e){if(!t){return null}var r;switch(t["type"]){case Ue.POINT:{r=uM(t);break}case Ue.LINE_STRING:{r=lM(t);break}case Ue.POLYGON:{r=pM(t);break}case Ue.MULTI_POINT:{r=cM(t);break}case Ue.MULTI_LINE_STRING:{r=hM(t);break}case Ue.MULTI_POLYGON:{r=fM(t);break}case Ue.GEOMETRY_COLLECTION:{r=sM(t);break}default:{throw new Error("Unsupported GeoJSON type: "+t.type)}}return UO(r,false,e)}function sM(t,e){var r=t["geometries"].map((function(t){return aM(t,e)}));return new $w(r)}function uM(t){return new mi(t["coordinates"])}function lM(t){return new CO(t["coordinates"])}function hM(t){return new IO(t["coordinates"])}function cM(t){return new AO(t["coordinates"])}function fM(t){return new DO(t["coordinates"])}function pM(t){return new Ui(t["coordinates"])}function dM(t,e){t=UO(t,true,e);var r=t.getType();var n;switch(r){case Ue.POINT:{n=EM(t,e);break}case Ue.LINE_STRING:{n=_M(t,e);break}case Ue.POLYGON:{n=OM(t,e);break}case Ue.MULTI_POINT:{n=yM(t,e);break}case Ue.MULTI_LINE_STRING:{n=gM(t,e);break}case Ue.MULTI_POLYGON:{n=mM(t,e);break}case Ue.GEOMETRY_COLLECTION:{n=vM(t,e);break}case Ue.CIRCLE:{n={type:"GeometryCollection",geometries:[]};break}default:{throw new Error("Unsupported geometry type: "+r)}}return n}function vM(t,e){var r=t.getGeometriesArray().map((function(t){var r=Object(K["a"])({},e);delete r.featureProjection;return dM(t,r)}));return{type:"GeometryCollection",geometries:r}}function _M(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function gM(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function yM(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function mM(t,e){var r;if(e){r=e.rightHanded}return{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}function EM(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function OM(t,e){var r;if(e){r=e.rightHanded}return{type:"Polygon",coordinates:t.getCoordinates(r)}}var bM=oM;function xM(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function wM(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}function MM(t,e,r){if(e)wM(t.prototype,e);if(r)wM(t,r);return t}function SM(t,e,r){if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}var CM=function t(e,r){return e.matches?e.matches(r):e.msMatchesSelector?e.msMatchesSelector(r):e.webkitMatchesSelector?e.webkitMatchesSelector(r):null};var RM=function t(e,r){var n=e;while(n&&n.nodeType===1){if(CM(n,r)){return n}n=n.parentNode}return null};var TM=function t(e,r){return e.closest?e.closest(r):RM(e,r)};var IM=function t(e){return Boolean(e&&typeof e.then==="function")};var PM=function t(){var e=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=r.search,i=r.autoSelect,o=i===void 0?false:i,a=r.setValue,s=a===void 0?function(){}:a,u=r.setAttribute,l=u===void 0?function(){}:u,h=r.onUpdate,c=h===void 0?function(){}:h,f=r.onSubmit,p=f===void 0?function(){}:f,d=r.onShow,v=d===void 0?function(){}:d,_=r.onHide,g=_===void 0?function(){}:_,y=r.onLoading,m=y===void 0?function(){}:y,E=r.onLoaded,O=E===void 0?function(){}:E;xM(this,t);SM(this,"value","");SM(this,"searchCounter",0);SM(this,"results",[]);SM(this,"selectedIndex",-1);SM(this,"handleInput",(function(t){var r=t.target.value;e.updateResults(r);e.value=r}));SM(this,"handleKeyDown",(function(t){var r=t.key;switch(r){case"Up":case"Down":case"ArrowUp":case"ArrowDown":{var n=r==="ArrowUp"||r==="Up"?e.selectedIndex-1:e.selectedIndex+1;t.preventDefault();e.handleArrows(n);break}case"Tab":{e.selectResult();break}case"Enter":{var i=e.results[e.selectedIndex];e.selectResult();e.onSubmit(i);break}case"Esc":case"Escape":{e.hideResults();e.setValue();break}default:return}}));SM(this,"handleFocus",(function(t){var r=t.target.value;e.updateResults(r);e.value=r}));SM(this,"handleBlur",(function(){e.hideResults()}));SM(this,"handleResultMouseDown",(function(t){t.preventDefault()}));SM(this,"handleResultClick",(function(t){var r=t.target;var n=TM(r,"[data-result-index]");if(n){e.selectedIndex=parseInt(n.dataset.resultIndex,10);var i=e.results[e.selectedIndex];e.selectResult();e.onSubmit(i)}}));SM(this,"handleArrows",(function(t){var r=e.results.length;e.selectedIndex=(t%r+r)%r;e.onUpdate(e.results,e.selectedIndex)}));SM(this,"selectResult",(function(){var t=e.results[e.selectedIndex];if(t){e.setValue(t)}e.hideResults()}));SM(this,"updateResults",(function(t){var r=++e.searchCounter;e.onLoading();e.search(t).then((function(t){if(r!==e.searchCounter){return}e.results=t;e.onLoaded();if(e.results.length===0){e.hideResults();return}e.selectedIndex=e.autoSelect?0:-1;e.onUpdate(e.results,e.selectedIndex);e.showResults()}))}));SM(this,"showResults",(function(){e.setAttribute("aria-expanded",true);e.onShow()}));SM(this,"hideResults",(function(){e.selectedIndex=-1;e.results=[];e.setAttribute("aria-expanded",false);e.setAttribute("aria-activedescendant","");e.onUpdate(e.results,e.selectedIndex);e.onHide()}));SM(this,"checkSelectedResultVisible",(function(t){var r=t.querySelector('[data-result-index="'.concat(e.selectedIndex,'"]'));if(!r){return}var n=t.getBoundingClientRect();var i=r.getBoundingClientRect();if(i.top<n.top){t.scrollTop-=n.top-i.top}else if(i.bottom>n.bottom){t.scrollTop+=i.bottom-n.bottom}}));this.search=IM(n)?n:function(t){return Promise.resolve(n(t))};this.autoSelect=o;this.setValue=s;this.setAttribute=l;this.onUpdate=c;this.onSubmit=p;this.onShow=v;this.onHide=g;this.onLoading=m;this.onLoaded=O};var LM=0;var AM=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return"".concat(e).concat(++LM)};var jM=function t(e,r){var n=e.getBoundingClientRect();var i=r.getBoundingClientRect();var o=n.bottom+i.height>window.innerHeight&&window.innerHeight-n.bottom<n.top&&window.pageYOffset+n.top-i.height>0;return o?"above":"below"};var NM=function t(e,r,n){var i;return function t(){var o=this;var a=arguments;var s=function t(){i=null;if(!n)e.apply(o,a)};var u=n&&!i;clearTimeout(i);i=setTimeout(s,r);if(u)e.apply(o,a)}};var FM=function(){function t(e,r,n){xM(this,t);this.id="".concat(n,"-result-").concat(e);this["class"]="".concat(n,"-result");this["data-result-index"]=e;this.role="option";if(e===r){this["aria-selected"]="true"}}MM(t,[{key:"toString",value:function t(){var e=this;return Object.keys(this).reduce((function(t,r){return"".concat(t," ").concat(r,'="').concat(e[r],'"')}),"")}}]);return t}();var DM=function t(e){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=n.search,o=n.onSubmit,a=o===void 0?function(){}:o,s=n.onUpdate,u=s===void 0?function(){}:s,l=n.baseClass,h=l===void 0?"autocomplete":l,c=n.autoSelect,f=n.getResultValue,p=f===void 0?function(t){return t}:f,d=n.renderResult,v=n.debounceTime,_=v===void 0?0:v;xM(this,t);SM(this,"expanded",false);SM(this,"loading",false);SM(this,"position",{});SM(this,"resetPosition",true);SM(this,"initialize",(function(){r.root.style.position="relative";r.input.setAttribute("role","combobox");r.input.setAttribute("autocomplete","off");r.input.setAttribute("autocapitalize","off");r.input.setAttribute("autocorrect","off");r.input.setAttribute("spellcheck","false");r.input.setAttribute("aria-autocomplete","list");r.input.setAttribute("aria-haspopup","listbox");r.input.setAttribute("aria-expanded","false");r.resultList.setAttribute("role","listbox");r.resultList.style.position="absolute";r.resultList.style.zIndex="1";r.resultList.style.width="100%";r.resultList.style.boxSizing="border-box";if(!r.resultList.id){r.resultList.id=AM("".concat(r.baseClass,"-result-list-"))}r.input.setAttribute("aria-owns",r.resultList.id);document.body.addEventListener("click",r.handleDocumentClick);r.input.addEventListener("input",r.core.handleInput);r.input.addEventListener("keydown",r.core.handleKeyDown);r.input.addEventListener("focus",r.core.handleFocus);r.input.addEventListener("blur",r.core.handleBlur);r.resultList.addEventListener("mousedown",r.core.handleResultMouseDown);r.resultList.addEventListener("click",r.core.handleResultClick);r.updateStyle()}));SM(this,"setAttribute",(function(t,e){r.input.setAttribute(t,e)}));SM(this,"setValue",(function(t){r.input.value=t?r.getResultValue(t):""}));SM(this,"renderResult",(function(t,e){return"<li ".concat(e,">").concat(r.getResultValue(t),"</li>")}));SM(this,"handleUpdate",(function(t,e){r.resultList.innerHTML="";t.forEach((function(t,n){var i=new FM(n,e,r.baseClass);var o=r.renderResult(t,i);if(typeof o==="string"){r.resultList.insertAdjacentHTML("beforeend",o)}else{r.resultList.insertAdjacentElement("beforeend",o)}}));r.input.setAttribute("aria-activedescendant",e>-1?"".concat(r.baseClass,"-result-").concat(e):"");if(r.resetPosition){r.resetPosition=false;r.position=jM(r.input,r.resultList);r.updateStyle()}r.core.checkSelectedResultVisible(r.resultList);r.onUpdate(t,e)}));SM(this,"handleShow",(function(){r.expanded=true;r.updateStyle()}));SM(this,"handleHide",(function(){r.expanded=false;r.resetPosition=true;r.updateStyle()}));SM(this,"handleLoading",(function(){r.loading=true;r.updateStyle()}));SM(this,"handleLoaded",(function(){r.loading=false;r.updateStyle()}));SM(this,"handleDocumentClick",(function(t){if(r.root.contains(t.target)){return}r.core.hideResults()}));SM(this,"updateStyle",(function(){r.root.dataset.expanded=r.expanded;r.root.dataset.loading=r.loading;r.root.dataset.position=r.position;r.resultList.style.visibility=r.expanded?"visible":"hidden";r.resultList.style.pointerEvents=r.expanded?"auto":"none";if(r.position==="below"){r.resultList.style.bottom=null;r.resultList.style.top="100%"}else{r.resultList.style.top=null;r.resultList.style.bottom="100%"}}));this.root=typeof e==="string"?document.querySelector(e):e;this.input=this.root.querySelector("input");this.resultList=this.root.querySelector("ul");this.baseClass=h;this.getResultValue=p;this.onUpdate=u;if(typeof d==="function"){this.renderResult=d}var g=new PM({search:i,autoSelect:c,setValue:this.setValue,setAttribute:this.setAttribute,onUpdate:this.handleUpdate,onSubmit:a,onShow:this.handleShow,onHide:this.handleHide,onLoading:this.handleLoading,onLoaded:this.handleLoaded});if(_>0){g.handleInput=NM(g.handleInput,_)}this.core=g;this.initialize()};var GM=DM;class kM{constructor(t){this.format_=new bM;this.url_=new URL(t.url);this.source_=t.source;this.view_=t.view;const e=document.createElement("input");e.className="api-search-input";const r=document.createElement("ul");r.className="api-search-results";t.container.append(e,r);this.autocomplete_=new GM(t.container,{search:this.search_.bind(this),getResultValue:this.getResultValue_.bind(this),onSubmit:this.onSubmit_.bind(this)})}search_(t){return new Promise((e=>{if(t.length>=1){this.url_.searchParams.set("query",t);fetch(this.url_.href).then((t=>t.json())).then((t=>t.features)).then((t=>e(t.filter(this.hasGeometry_))))}else{e([])}}))}hasGeometry_(t){return t.geometry!==null}getResultValue_(t){return t.properties.label}onSubmit_(t){this.source_.clear();const e=this.format_.readFeature(t);this.source_.addFeature(e);this.view_.fit(this.source_.getExtent())}}const UM=["boundedBy"];class BM{constructor(t){const e=new XMLHttpRequest;e.open("GET",n.dynamicUrl,false);e.send(null);if(e.status!==200){throw new Error("Error on getting the dynamic configuration")}Object.assign(i,JSON.parse(e.responseText)["constants"]);for(const t in i.projections){tg(t,i.projections[t].definition.join(" "),i.projections[t].extent)}const r={projection:jr(i.projection),resolutions:i.resolutions,zoom:t.zoom!==undefined?t.zoom:10};if(i.extent){r.extent=i.extent}this.view_=new to(r);if(t.center!==undefined){this.view_.setCenter(t.center)}else if(i.extent){this.view_.setCenter(Object(R["w"])(i.extent))}this.map_=new za({target:t.div,view:this.view_});this.overlay_=new Ja({autoPan:true,autoPanAnimation:{duration:80},element:this.createOverlayDomTree_()});this.map_.addOverlay(this.overlay_);this.map_.addControl(new eh({dpi:96}));if(t.showCoords){this.map_.addControl(new Zl({coordinateFormat:at(0)}))}if(t.addMiniMap){const e=this.view_.getResolutions();if(!e){throw new Error("Missing resolutions")}pO().then((r=>{const n=t.backgroundLayers||[i.backgroundLayer];for(const i of r){if(n.includes(i.get("config.name"))){this.map_.addControl(new sh({collapsed:!t.miniMapExpanded,layers:[i],view:new to({projection:this.view_.getProjection(),resolutions:e})}))}}}))}if(t.addLayerSwitcher){this.map_.addControl(new rg.a)}pO().then((e=>{const r=t.backgroundLayers||[i.backgroundLayer];for(const t of e){if(r.includes(t.get("config.name"))){t.set("title",undefined);this.map_.addLayer(t)}}const n=t.layers;if(n&&n.length){gO(n).then((t=>{for(const e of t){if(e!==null){this.map_.addLayer(e)}}}))}}));this.vectorSource_=new ru;this.vectorLayer_=new Fl({zIndex:1,style:[],source:this.vectorSource_});this.map_.addLayer(this.vectorLayer_);this.selectInteraction_=new Yl({filter:t=>{const e=t.getId()!==undefined;const r=t.get("title")!==undefined;const n=t.get("description")!==undefined;return e&&r&&n},style:()=>[]});this.map_.addInteraction(this.selectInteraction_);this.selectInteraction_.on("select",(t=>{const e=t.selected[0];if(e){this.selectObject(e.getId())}}));this.map_.on("singleclick",(t=>{const e=this.map_.getView().getResolution();if(e===undefined){throw new Error("Missing resolution")}const r=this.map_.getLayers().getArray().filter((t=>t.getVisible()));const n=r.map((t=>t.get("config.name")));this.clearSelection();for(const r of i.queryableLayers){if(n.includes(r)){Kw(r,t.coordinate,e).then((e=>{if(e){this.vectorSource_.addFeature(e);this.selectObject(e.getId(),t.coordinate,true)}}))}}}));if(t.searchDiv){const e=document.querySelector(`#${t.searchDiv}`);if(e){const t=new Fl({zIndex:1,source:new ru});this.map_.addLayer(t);new kM({container:e,url:i.searchUrl,source:t.getSource(),view:this.map_.getView()})}else{throw new Error("Invalid searchDiv option")}}}createOverlayDomTree_(){const t=document.createElement("div");t.className="ol-popup";const e=document.createElement("div");e.className="ol-popup-closer";e.addEventListener("click",(()=>{this.clearSelection();return false}));const r=document.createElement("div");r.className="ol-popup-content";t.appendChild(e);t.appendChild(r);return t}getMap(){return this.map_}recenter(t,e){this.view_.setCenter(t);this.view_.setZoom(e)}addMarker(t){if(t===void 0){t={}}const e=t.position?t.position:this.view_.getCenter();if(!e){throw new Error("Missing positon")}const r=new Xa({geometry:new mi(e)});if(t.icon){const e=new gs({src:t.icon});r.setStyle(new Ns({image:e}))}else{r.setStyle(Ls)}this.vectorSource_.addFeature(r)}recenterOnObjects(t,e,r){if(r===void 0){r=false}Zw(t,e).then((t=>{if(!t.length){console.error("Could not recenter: no objects were found.");return}const e=Object(R["j"])();for(const n of t){if(r){n.setStyle(Ls)}const t=n.getGeometry();if(t){Object(R["p"])(e,t.getExtent())}}if(!Object(R["G"])(e)){this.view_.fit(e)}if(r){this.vectorSource_.addFeatures(t)}})).catch((t=>{console.error(t)}))}addCustomLayer(t,e,r,n){if(n===void 0){n={}}fetch(r).then((t=>t.text())).then((t=>{const e=n.attr||["title","description"];const r=t.split(/\r\n|\r|\n/);const i=r.shift();if(!i){throw new Error("Missing shiftedLines")}const o=i.split("\t");for(const t of r){if(t){const r=zM(o,t.split("\t"));const n=new Xa({geometry:new mi(r.point.split(",").reverse().map(parseFloat))});n.setProperties(YM(r,e));n.setId(r.id);let i;if(r.iconOffset){i=r.iconOffset.split(",").map(parseFloat).map((t=>t*Math.sign(t)))}const a=new gs({src:r.icon,anchorXUnits:"pixels",anchorYUnits:"pixels",anchor:i});n.setStyle(new Ns({image:a}));this.vectorSource_.addFeature(n)}}this.view_.fit(this.vectorSource_.getExtent())})).then((()=>{if(n.success){n.success()}})).catch((()=>{if(n.error){n.error()}}))}selectObject(t,e,r){if(e===void 0){e=null}if(r===void 0){r=false}const n=this.vectorSource_.getFeatureById(t);if(!n){console.error(`No feature with id ${t}`)}if(!e){const t=n.getGeometry();if(!(t instanceof mi)){throw new Error("Wrong geometry type")}e=t.getCoordinates()}const i=n.getGeometryName();const o=n.getProperties();cO().then((t=>{let n="";if(r){n+="<table><tbody>";for(const e in o){if(!UM.includes(e)&&e!==i&&o[e]!==undefined){n+="<tr>";n+=`<th>${t[e]||e}</th>`;n+=`<td>${o[e]}</td>`;n+="</tr>"}}n+="</tbody></table>"}else{n+=`<div><b>${o.title}</b></div>`;n+=`<p>${o.description}</p>`}const a=this.overlay_.getElement();if(!a){throw new Error("Missing element")}const s=a.querySelector(".ol-popup-content");if(!s){throw new Error("Missing content")}s.innerHTML=n;this.overlay_.setPosition(e)}))}clearSelection(){this.selectInteraction_.getFeatures().clear();this.overlay_.setPosition(undefined)}}function zM(t,e){const r={};t.forEach(((t,n)=>{r[t]=e[n]}));return r}function YM(t,e){const r={};e.forEach((e=>{r[e]=t[e]}));return r}var WM=BM;n.dynamicUrl="https://geomapfish-demo-2-7.camptocamp.com/dynamic.json?interface=api";const VM={Map:WM};var XM=e["default"]=VM}])["default"];
//# sourceMappingURL=api.js.map